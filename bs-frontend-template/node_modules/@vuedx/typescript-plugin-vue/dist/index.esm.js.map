{"version":3,"file":"index.esm.js","sources":["../src/helpers/logger.ts","../src/helpers/patcher.ts","../src/context.ts","../src/constants.ts","../src/helpers/utils.ts","../src/features/completions/SFCCompletionProvider.ts","../src/transforms/registerLocalComponent.ts","../src/servers/noop.ts","../src/servers/virtual.ts","../src/features/refactors/abstract.ts","../src/features/refactors/add-to-setup-context.ts","../src/features/refactors/extract-component.ts","../src/helpers/detectRefsAndProps.ts","../src/helpers/genSetupFnParams.ts","../src/helpers/getContextIdentifiers.ts","../src/features/refactors/extract-computed.ts","../src/features/refactors/extract-method.ts","../src/features/refactors/index.ts","../src/features/renames/component-tag.ts","../src/features/completions/abstract.ts","../src/features/completions/TemplateContextCompletionProvider.ts","../src/features/completions/TemplateExpressionCompletionProvider.ts","../src/features/completions/data/directives.ts","../src/features/completions/data/html.ts","../src/features/completions/TemplateCompletionProvider.ts","../src/features/completions/index.ts","../src/features/diagnostics/abstract.ts","../src/features/diagnostics/messages.ts","../src/features/diagnostics/InferredComponentDiagnosticsProvider.ts","../src/features/diagnostics/TemplateCompilerDiagnosticsProvider.ts","../src/features/diagnostics/TSProxyDiagnosticsProvider.ts","../src/features/diagnostics/index.ts","../src/features/goto/goto-external-component-prop.ts","../src/features/goto/goto-script-definitions.ts","../src/features/goto/index.ts","../src/features/renames/expression.ts","../src/features/renames/element-tag.ts","../src/features/renames/index.ts","../src/servers/template.ts","../src/servers/vue.ts","../src/servers/routing.ts","../src/index.ts"],"sourcesContent":["import { collectError, trace } from '@vuedx/shared'\nimport { performance } from 'perf_hooks'\nimport util from 'util'\n\nconst DEBUGGING = false\nfunction isPlainObj(o: any): boolean {\n  return typeof o === 'object' && o.constructor === Object\n}\nexport function wrapObject<T>(context: string, target: T): T {\n  if (__DEV__ && DEBUGGING) {\n    const write = (\n      method: string,\n      start: number,\n      args: unknown,\n      result: unknown,\n    ): void => {\n      if (!['getProgram'].includes(method)) {\n        console.log(\n          `[TRACE] ${context} ${method}(${JSON.stringify(args)}) ${\n            performance.now() - start\n          } ${JSON.stringify(\n            result,\n            (_, value) => {\n              if (\n                value != null &&\n                typeof value === 'object' &&\n                !Array.isArray(value)\n              ) {\n                if (isPlainObj(value)) return value\n                return `[Object ${String(value.constructor.name)}]`\n              }\n\n              return value\n            },\n            2,\n          )}`,\n        )\n      }\n    }\n\n    const clone = {} as any\n\n    for (const method in target) {\n      const fn = target[method]\n      if (typeof fn === 'function') {\n        clone[method] = function (this: unknown, ...args: unknown[]) {\n          const start = performance.now()\n          try {\n            const result = fn.apply(this, args)\n\n            if (result instanceof Promise) {\n              return result.finally(() => write(method, start, args, result))\n            } else {\n              write(method, start, args, result)\n\n              return result\n            }\n          } catch (error) {\n            write(method, start, args, { error })\n            throw error\n          }\n        } as any\n      } else {\n        clone[method] = fn\n      }\n    }\n\n    return clone\n  }\n\n  return target\n}\n\nexport function wrapFn<T extends (...args: any[]) => any>(\n  context: string,\n  target: T,\n): T {\n  if (__DEV__ && DEBUGGING) {\n    const write = (start: number, args: unknown, result: unknown): void => {\n      console.log(\n        `[TRACE] fn ${context} (${JSON.stringify(args)}) ${\n          performance.now() - start\n        } ${util.inspect(result, false, 6, false)}`,\n      )\n    }\n\n    return function (...args: any[]) {\n      const start = performance.now()\n      try {\n        const result = target.apply(null, args)\n\n        if (result instanceof Promise) {\n          return result.finally(() => write(start, args, result))\n        } else {\n          write(start, args, result)\n\n          return result\n        }\n      } catch (error) {\n        write(start, args, { error })\n        throw error\n      }\n    } as any\n  }\n\n  return target\n}\n\nexport function traceFn<T extends (...args: any[]) => any>(\n  event: string,\n  target: T,\n): T {\n  return function (this: any, ...args) {\n    const done = trace(event)\n    try {\n      return target.call(this, ...args)\n    } catch (error) {\n      collectError(error)\n      throw error\n    } finally {\n      done()\n    }\n  } as T\n}\n\nexport function traceObject<T>(context: string, target: T): T {\n  const clone = Object.create(Object.getPrototypeOf(target))\n\n  for (const propertyName in target) {\n    if (typeof target[propertyName] === 'function') {\n      clone[propertyName] = traceFn(\n        `${context}.${propertyName}`,\n        target[propertyName] as any,\n      )\n    } else {\n      clone[propertyName] = target[propertyName]\n    }\n  }\n\n  return clone\n}\n","const PATCHED_METHODS = Symbol('Vue Patched Methods');\n\nexport function tryPatchMethod<T extends object, K extends keyof T>(\n  target: T,\n  methodName: K,\n  createOverride: (fn: T[K]) => T[K] extends undefined ? never : T[K]\n) {\n  const patched: K[] = (target as any)[PATCHED_METHODS] || ([] as K[]);\n  if (patched.includes(methodName)) return;\n  let fn = target[methodName];\n  if (typeof fn === 'function') {\n    try {\n      fn = fn.bind(target);\n    } catch {\n      // - ignore\n    }\n  }\n  target[methodName] = createOverride(fn);\n  patched.push(methodName);\n  (target as any)[PATCHED_METHODS] = patched;\n}\n","import {\n  ConfiguredVueProject,\n  InferredVueProject,\n  VueProject,\n} from '@vuedx/analyze'\nimport { collect, collectError, first, Telemetry } from '@vuedx/shared'\nimport {\n  asFsPath,\n  asFsUri,\n  asUri,\n  DocumentStore,\n  getContainingFile,\n  INTERNAL_MODULE_SELECTOR,\n  isVirtualFile,\n  isVueFile,\n  MODULE_SELECTOR,\n  parseVirtualFileName,\n  VIRTUAL_FILENAME_SEPARATOR,\n  VueTextDocument,\n} from '@vuedx/vue-virtual-textdocument'\nimport JSON5 from 'json5'\nimport Path from 'path'\nimport { traceFn, wrapFn } from './helpers/logger'\nimport { tryPatchMethod } from './helpers/patcher'\nimport { PluginConfig, TS } from './interfaces'\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\ndeclare var __non_webpack_require__: any\n\nconst requireModule = (typeof __non_webpack_require__ !== 'undefined'\n  ? __non_webpack_require__\n  : require) as NodeJS.Require\n\nfunction getLastNumberFromVersion(version: string): number {\n  const parts = version.split(/[^0-9]+/)\n  const ver = parts.pop()\n\n  return Number(ver)\n}\n\nclass ProxyDocumentStore extends DocumentStore<VueTextDocument> {\n  get(fileNameOrUri: string): VueTextDocument | null {\n    return super.get(asUri(fileNameOrUri))\n  }\n\n  has(fileNameOrUri: string): boolean {\n    return super.has(asUri(fileNameOrUri))\n  }\n\n  set(fileNameOrUri: string, document: VueTextDocument): void {\n    return super.set(asUri(fileNameOrUri), document)\n  }\n\n  delete(fileNameOrUri: string): boolean {\n    return super.delete(asUri(fileNameOrUri))\n  }\n}\n\nfunction getConfig(config: Partial<PluginConfig> = {}): PluginConfig {\n  return {\n    telemetry: true,\n    ...config,\n    features: {\n      diagnostics: true,\n      organizeImports: true,\n      quickInfo: true,\n      rename: true,\n      refactor: true,\n      goto: true,\n      tagCompletions: true,\n      ...config.features,\n    },\n  }\n}\n\nexport class PluginContext {\n  public readonly store: DocumentStore<VueTextDocument>\n  private _config: PluginConfig = getConfig()\n  private _projectService!: TS.server.ProjectService\n  private _serverHost!: TS.server.ServerHost\n  public readonly _externalFiles = new WeakMap<TS.server.Project, string[]>()\n  public readonly _vueProjects: Array<{\n    project: VueProject\n    lastUsedAt: number\n    dispose(): void\n  }> = []\n\n  public constructor(public readonly typescript: typeof TS) {\n    this.store = new ProxyDocumentStore((uri) => {\n      const fileName = asFsPath(uri)\n      const content = this.typescript.sys.readFile(fileName) ?? ''\n      return this.createVueDocument(fileName, content)\n    })\n  }\n\n  public get config(): Readonly<PluginConfig> {\n    return this._config\n  }\n\n  public get serviceHost(): TS.server.ServerHost {\n    return this._serverHost\n  }\n\n  public get projectService(): TS.server.ProjectService {\n    return this._projectService\n  }\n\n  public log(message: string): void {\n    if (this.projectService != null) {\n      this.projectService.logger.info(`Vue.js:: ${message}`)\n    }\n  }\n\n  public debug(string: string): void\n  public debug(string: TemplateStringsArray, ...args: any[]): void\n  public debug(messages: string | TemplateStringsArray, ...args: any[]): void {\n    if (__DEV__) {\n      if (this.projectService != null) {\n        let message: string = ''\n        if (typeof messages === 'string') {\n          message += messages\n        } else {\n          for (let i = 0; i < messages.length; ++i) {\n            message += messages[i]\n            if (i < args.length) {\n              message += JSON.stringify(args[i], null, 2)\n            }\n          }\n        }\n\n        this.projectService.logger.info(`@@debug Vue.js:: ${message}`)\n      }\n    }\n  }\n\n  public getVueVersion(fileName: string): string {\n    return this.getVueProjectForFile(fileName, false)?.version ?? '3.0.0'\n  }\n\n  public getExternalFiles(project: TS.server.Project): string[] {\n    return this._externalFiles.get(project) ?? []\n  }\n\n  private forEachTSProject(fn: (project: TS.server.Project) => void): void {\n    this.projectService.configuredProjects.forEach(fn)\n    this.projectService.inferredProjects.forEach(fn)\n    this.projectService.externalProjects.forEach(fn)\n  }\n\n  public getTSProjectForFile(fileName: string, ensure: true): TS.server.Project\n  public getTSProjectForFile(\n    fileName: string,\n    ensure?: false,\n  ): TS.server.Project | null\n  public getTSProjectForFile(\n    fileName: string,\n    ensure?: boolean,\n  ): TS.server.Project | null {\n    return (\n      this.projectService.getDefaultProjectForFile(\n        this.typescript.server.toNormalizedPath(fileName),\n        ensure ?? false,\n      ) ?? null\n    )\n  }\n\n  public getVueProjectForFile(fileName: string, ensure: true): VueProject\n  public getVueProjectForFile(\n    fileName: string,\n    ensure?: false,\n  ): VueProject | null\n  public getVueProjectForFile(\n    fileName: string,\n    ensure?: boolean,\n  ): VueProject | null {\n    const ref = this._vueProjects.find(({ project }) =>\n      fileName.startsWith(project.rootDir + '/'),\n    )\n    if (ref != null) ref.lastUsedAt = Date.now()\n    let project = ref?.project ?? null\n\n    if (project === null && ensure === true) {\n      project = traceFn('PluginContext.createVueProjectForFile', () => {\n        const packageFile = this.typescript.findConfigFile(\n          fileName,\n          this.typescript.sys.fileExists,\n          'package.json',\n        )\n\n        const configFile = this.typescript.findConfigFile(\n          fileName,\n          this.typescript.sys.fileExists,\n          'vueconfig.json',\n        )\n\n        const rootDir = Path.posix.dirname(\n          packageFile ?? configFile ?? fileName,\n        )\n        const fileNames = this.serviceHost.readDirectory(\n          rootDir,\n          ['.tsx', '.jsx', '.ts', '.js'],\n          ['node_modules'],\n        )\n\n        const tryRequire = (fileName: string): any => {\n          try {\n            if (Path.posix.basename(fileName) === 'vueconfig.json') {\n              const contents = this.serviceHost.readFile(fileName) ?? ''\n              try {\n                return JSON5.parse(contents)\n              } catch (error) {\n                collectError(error)\n                return {}\n              }\n            }\n            // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n            delete requireModule.cache[fileName]\n\n            return requireModule(fileName)\n          } catch (error) {\n            collectError(error)\n\n            return {}\n          }\n        }\n\n        const newProject =\n          configFile != null\n            ? new ConfiguredVueProject(\n                rootDir,\n                packageFile,\n                packageFile != null ? tryRequire(packageFile) : {},\n                configFile,\n                tryRequire(configFile),\n                requireModule,\n              )\n            : new InferredVueProject(\n                rootDir,\n                packageFile,\n                packageFile != null ? tryRequire(packageFile) : {},\n                requireModule,\n              )\n\n        newProject.setFileNames(fileNames)\n\n        const disposables: Array<() => void> = [\n          () => {\n            this._vueProjects.splice(\n              this._vueProjects.findIndex(\n                (item) => item.project === newProject,\n              ),\n              1,\n            )\n          },\n        ]\n\n        const dispose = (): void => disposables.forEach((fn) => fn())\n        const projectDirWatcher = this.serviceHost.watchDirectory(\n          rootDir,\n          (fileName: string) => {\n            if (fileName.endsWith('/vueconfig.json')) {\n              if (newProject.kind === 'inferred') {\n                dispose()\n                reload()\n                return\n              }\n            }\n\n            if (!/\\.(vue|ts|tsx|js|jsx)$/.test(fileName)) return\n            if (this.serviceHost.fileExists(fileName)) {\n              if (!newProject.fileNames.includes(fileName)) {\n                newProject.setFileNames([...newProject.fileNames, fileName])\n              }\n            } else {\n              if (newProject.fileNames.includes(fileName)) {\n                newProject.setFileNames(\n                  newProject.fileNames.filter((f) => f !== fileName),\n                )\n              }\n            }\n          },\n        )\n\n        disposables.push(() => projectDirWatcher.close())\n\n        const reload = (): void => {\n          this.forEachTSProject((tsProject) => {\n            const dir = tsProject.getCurrentDirectory()\n            if (\n              dir.startsWith(newProject.rootDir) ||\n              newProject.rootDir.startsWith(dir)\n            ) {\n              this.getExternalFiles(tsProject).forEach((fileName) => {\n                const document = this.store.get(fileName)\n                if (document != null) {\n                  document.markDirty()\n                  document.all().forEach((doc) => {\n                    if (\n                      [\n                        'javascript',\n                        'typescript',\n                        'javascriptreact',\n                        'typescriptreact',\n                      ].includes(doc.languageId)\n                    ) {\n                      triggerFileUpdate(this, doc.fsPath)\n                    }\n                  })\n                }\n              })\n              tsProject.markAsDirty()\n              tsProject.refreshDiagnostics()\n            }\n          })\n        }\n\n        if (configFile != null) {\n          if (__DEV__)\n            this.debug(`Setting VueProject FileWatcher:  ${configFile}`)\n          const configFileWatcher = this.serviceHost.watchFile(\n            configFile,\n            (_, event) => {\n              if (event === this.typescript.FileWatcherEventKind.Deleted) {\n                dispose()\n              } else {\n                ;(newProject as ConfiguredVueProject).setConfig(\n                  tryRequire(configFile),\n                )\n                newProject.markDirty()\n              }\n              reload()\n            },\n          )\n          disposables.push(() => {\n            if (__DEV__)\n              this.debug(`Stopping VueProject FileWatcher: ${configFile}`)\n            configFileWatcher.close()\n          })\n        }\n\n        if (packageFile != null) {\n          const packageFileWatcher = this.serviceHost.watchFile(\n            packageFile,\n            (_, event) => {\n              if (event === this.typescript.FileWatcherEventKind.Deleted) {\n                dispose()\n              } else {\n                newProject.packageJSON = {\n                  dependencies: {},\n                  devDependencies: {},\n                  ...tryRequire(packageFile),\n                }\n                newProject.markDirty()\n              }\n            },\n          )\n          disposables.push(() => packageFileWatcher.close())\n        }\n\n        this._vueProjects.push({\n          project: newProject,\n          dispose,\n          lastUsedAt: Date.now(),\n        })\n\n        Telemetry.extend({\n          vueVersion: newProject.version,\n        })\n\n        collect('vue project', {\n          kind: newProject.kind,\n          vue: newProject.version,\n          dependencies: newProject.packageJSON.dependencies,\n          devDependencies: newProject.packageJSON.devDependencies,\n        })\n\n        return newProject\n      })()\n    }\n\n    return project\n  }\n\n  public disposeUnusedProjects(force: boolean = false): void {\n    if (force) {\n      this._vueProjects.forEach(({ dispose }) => {\n        dispose()\n      })\n    }\n  }\n\n  public hasAnyVueReference(fileName: string): boolean {\n    // TODO: check if there is an import from .vue file or not.\n    // This could be used in routing service to skip some work when .vue\n    // is not in the play.\n    return true\n  }\n\n  public createVueDocument(fileName: string, content: string): VueTextDocument {\n    const uri = asFsUri(fileName).toString()\n    const document = VueTextDocument.create(uri, 'vue', 0, content, {\n      vueVersion: this.getVueProjectForFile(fileName, true).version,\n      getGlobalComponents: wrapFn('getGlobalComponents', () => {\n        const project = this.getVueProjectForFile(fileName, true)\n\n        return project.kind === 'inferred'\n          ? project.components\n          : project.globalComponents\n      }),\n    })\n\n    this.store.set(uri, document)\n\n    return document\n  }\n\n  public error(error: Error): void {\n    collectError(error)\n\n    if (this.projectService != null) {\n      this.projectService.logger.msg(\n        `@@error Vue.js:: ${error.message} ${error.stack ?? ''}`,\n        this.typescript.server.Msg.Err,\n      )\n    }\n  }\n\n  public tryCreateScriptInfo(fileName: string): void {\n    try {\n      if (isVirtualFile(fileName)) {\n        const vueFileName = getContainingFile(fileName)\n        this.store.get(vueFileName)\n        const scriptInfo = this.projectService.getOrCreateScriptInfoForNormalizedPath(\n          this.typescript.server.toNormalizedPath(vueFileName),\n          false,\n        )\n        if (scriptInfo != null) {\n          patchScriptInfo(this, scriptInfo)\n        }\n      }\n    } catch {}\n  }\n\n  public load(info: TS.server.PluginCreateInfo): void {\n    this.log(`Loading Vue plugin: ${info.project.getProjectName()}`)\n\n    this._serverHost = info.serverHost\n    this._projectService = info.project.projectService\n    this.setConfig(info.config)\n\n    patchProject(this, info.project)\n    patchProjectService(this)\n    patchServiceHost(this)\n    patchLanguageServiceHost(this, info.languageServiceHost)\n  }\n\n  public setConfig(config: Partial<PluginConfig>): void {\n    this._config = getConfig(config)\n  }\n}\n\nfunction patchProject(\n  context: PluginContext,\n  project: TS.server.Project,\n): void {\n  const vue2supportFile = context.typescript.server.toNormalizedPath(\n    Path.join(Path.dirname(__dirname), 'runtime/vue-2.d.ts'),\n  )\n  tryPatchMethod(\n    project,\n    'getFileNames',\n    (getFileNames) => (\n      excludeFilesFromExternalLibraries,\n      excludeConfigFiles,\n    ) => {\n      const fileNames = new Set(\n        getFileNames(\n          excludeFilesFromExternalLibraries,\n          excludeConfigFiles,\n        ).map((fileName) =>\n          isVirtualFile(fileName) ? getContainingFile(fileName) : fileName,\n        ),\n      )\n      fileNames.delete(vue2supportFile)\n      fileNames.forEach((fileName) => {\n        if (isVueFile(fileName)) {\n          const scriptInfo =\n            context.projectService.getScriptInfo(fileName) ??\n            context.projectService.getOrCreateScriptInfoForNormalizedPath(\n              context.typescript.server.toNormalizedPath(fileName),\n              false,\n            )\n\n          try {\n            scriptInfo?.getDefaultProject()\n          } catch {\n            scriptInfo?.attachToProject(project)\n          }\n        }\n      })\n\n      return Array.from(fileNames) as TS.server.NormalizedPath[]\n    },\n  )\n\n  tryPatchMethod(\n    project,\n    'containsScriptInfo',\n    (containsScriptInfo) => (info) => {\n      if (isVueFile(info.path)) {\n        const moduleFileName = context.store\n          .get(info.path)\n          ?.getDocumentFileName(MODULE_SELECTOR)\n\n        if (moduleFileName != null) {\n          const info = context.projectService.getScriptInfo(moduleFileName)\n          if (info != null) return containsScriptInfo(info)\n        }\n      }\n\n      return containsScriptInfo(info)\n    },\n  )\n}\n\nfunction patchProjectService(context: PluginContext): void {\n  patchExtraFileExtensions(context)\n}\n\nfunction patchExtraFileExtensions(context: PluginContext): void {\n  const extraFileExtensions: TS.server.HostConfiguration['extraFileExtensions'] = [\n    {\n      extension: 'vue',\n      isMixedContent: false,\n      scriptKind: context.typescript.ScriptKind.Deferred,\n    },\n  ]\n\n  tryPatchMethod(\n    context.projectService,\n    'setHostConfiguration',\n    (setHostConfiguration) => {\n      context.log(`[patch] Add support for vue extension. (ProjectService)`)\n      return wrapFn(\n        'setHostConfiguration',\n        (args: TS.server.protocol.ConfigureRequestArguments): void => {\n          const current = ((context.projectService as any)\n            .hostConfiguration as TS.server.HostConfiguration)\n            .extraFileExtensions\n\n          if (args.extraFileExtensions != null) {\n            args.extraFileExtensions.push(...extraFileExtensions)\n            if (__DEV__)\n              context.debug(\n                `extraFileExtensions: ${JSON.stringify(\n                  args.extraFileExtensions,\n                )}`,\n              )\n          } else if (\n            current == null ||\n            !current.some((ext) => ext.extension === 'vue')\n          ) {\n            args.extraFileExtensions = [...extraFileExtensions]\n          }\n\n          return setHostConfiguration(args)\n        },\n      )\n    },\n  )\n\n  if (\n    ((context.projectService as any)\n      .hostConfiguration as TS.server.HostConfiguration).extraFileExtensions?.some(\n      (ext) => ext.extension === 'vue',\n    ) === true\n  ) {\n    return\n  }\n\n  // Enable .vue after enhancing the language server.\n  context.projectService.setHostConfiguration({ extraFileExtensions: [] })\n}\n\nfunction patchLanguageServiceHost(\n  context: PluginContext,\n  languageServiceHost: TS.LanguageServiceHost,\n): void {\n  patchGetScriptFileNames(context, languageServiceHost)\n  patchModuleResolution(context, languageServiceHost)\n  tryPatchMethod(\n    languageServiceHost,\n    'getCompilationSettings',\n    (getCompilationSettings) => () => {\n      const settings = getCompilationSettings()\n\n      settings.jsx = context.typescript.JsxEmit.Preserve\n      if (settings.allowJs !== false) {\n        settings.allowJs = true\n      }\n\n      if (settings.checkJs !== false) {\n        settings.checkJs = true\n      }\n\n      settings.noEmit = true\n\n      return settings\n    },\n  )\n}\n\nfunction patchGetScriptFileNames(\n  context: PluginContext,\n  languageServiceHost: TS.LanguageServiceHost,\n): void {\n  context.log(`[patch] Add support for GeterrForProject. (Project)`)\n\n  const vue2supportFile = context.typescript.server.toNormalizedPath(\n    Path.join(Path.dirname(__dirname), 'runtime/vue-2.d.ts'),\n  )\n\n  tryPatchMethod(\n    languageServiceHost,\n    'getScriptFileNames',\n    (getScriptFileNames) => {\n      context.log(\n        `[patch] Override getScriptFileNames to expand .vue files to virtual files. (LanguageServerHost)`,\n      )\n\n      return wrapFn('getScriptFileNames', (): string[] => {\n        const fileNames = new Set<string>()\n\n        const vueFiles = new Set<string>()\n\n        getScriptFileNames()\n          .map((fileName) =>\n            isVirtualFile(fileName) ? getContainingFile(fileName) : fileName,\n          )\n          .forEach((fileName) => {\n            if (isVueFile(fileName)) {\n              const document = context.store.get(fileName)\n              if (document != null) {\n                vueFiles.add(fileName)\n                fileNames.add(document.getDocumentFileName(MODULE_SELECTOR))\n              }\n            } else {\n              fileNames.add(fileName)\n            }\n          })\n\n        if (vueFiles.size > 0) {\n          const files = Array.from(vueFiles)\n          const project = context.getVueProjectForFile(first(files), true)\n\n          if (project.version.startsWith('2.')) {\n            fileNames.add(vue2supportFile)\n          }\n\n          const projects = new Set(\n            files\n              .map((fileName) =>\n                context.projectService.getDefaultProjectForFile(\n                  context.typescript.server.toNormalizedPath(fileName),\n                  false,\n                ),\n              )\n              .filter(Boolean) as TS.server.Project[],\n          )\n\n          projects.forEach((project) => {\n            context._externalFiles.set(project, files)\n            if (\n              project instanceof context.typescript.server.ConfiguredProject\n            ) {\n              const vueProject = context.getVueProjectForFile(\n                project.getCurrentDirectory() + '/placeholder.vue',\n                true,\n              )\n\n              vueProject.setFileNames(files)\n            }\n          })\n        }\n\n        return Array.from(fileNames)\n      })\n    },\n  )\n}\n\nfunction patchFileExists(context: PluginContext): void {\n  tryPatchMethod(\n    context.serviceHost,\n    'fileExists',\n    (fileExists = context.typescript.sys.fileExists) => {\n      context.log(\n        `[patch] Override fileExists to check containing file for virtual files. (ServiceHost)`,\n      )\n\n      return wrapFn('fileExists', (fileName: string): boolean => {\n        if (isVirtualFile(fileName)) {\n          const document = context.store.get(getContainingFile(fileName))\n          const result = parseVirtualFileName(fileName)\n\n          if (__DEV__ && result != null)\n            context.debug(\n              `As per .vue file: \"${\n                document?.getDocumentFileName(result.selector) ?? ''\n              }\"`,\n            )\n\n          return (\n            document != null &&\n            result != null &&\n            fileName === document.getDocumentFileName(result.selector)\n          )\n        }\n\n        return fileExists(fileName)\n      })\n    },\n  )\n}\n\nfunction patchReadFile(context: PluginContext): void {\n  tryPatchMethod(context.serviceHost, 'readFile', (readFile) => {\n    context.log(\n      `[patch] Override readFile to check containing file for virtual files. (ServiceHost)`,\n    )\n\n    return wrapFn('readFile', (fileName: string, encoding?: string):\n      | string\n      | undefined => {\n      if (isVirtualFile(fileName)) {\n        const vueFile = getContainingFile(fileName)\n        const scriptInfo = context.projectService.getScriptInfo(vueFile)\n        const document = context.store.get(vueFile)\n\n        if (scriptInfo != null && document != null) {\n          if (!scriptInfo.isScriptOpen()) {\n            const version = getLastNumberFromVersion(\n              scriptInfo.getLatestVersion(),\n            )\n\n            if (version > document.version) {\n              const snapshot = scriptInfo.getSnapshot()\n              VueTextDocument.update(\n                document,\n                [{ text: snapshot.getText(0, snapshot.getLength()) }],\n                version,\n              )\n            }\n          }\n        }\n\n        return document?.getDocument(fileName)?.getText()\n      }\n\n      return readFile != null\n        ? readFile(fileName, encoding)\n        : context.typescript.sys.readFile(fileName, encoding)\n    })\n  })\n}\n\nfunction patchReadDirectory(context: PluginContext): void {\n  tryPatchMethod(context.serviceHost, 'readDirectory', (readDirectory) => {\n    context.log(\n      `[patch] Override readDirectory to include .vue files. (ServiceHost)`,\n    )\n\n    return wrapFn(\n      'readDirectory',\n      (path, extensions, exclude, include, depth) => {\n        if (extensions != null) {\n          extensions = [...extensions, '.vue']\n        }\n\n        return readDirectory(path, extensions, exclude, include, depth)\n      },\n    )\n  })\n}\n\nfunction patchModuleResolution(\n  context: PluginContext,\n  languageServiceHost: TS.LanguageServiceHost,\n): void {\n  const vue2supportFile = context.typescript.server.toNormalizedPath(\n    Path.join(Path.dirname(__dirname), 'runtime/vue-2.d.ts'),\n  )\n\n  tryPatchMethod(\n    languageServiceHost,\n    'resolveModuleNames',\n    (resolveModuleNames) => {\n      context.log(\n        `[patch] Override resolveModuleNames to resolve imports from .vue files. (LanguageServerHost)`,\n      )\n\n      return wrapFn(\n        'resolveModuleNames',\n        (\n          moduleNames: string[],\n          containingFile: string,\n          reusedNames: string[] | undefined,\n          redirectedReferences: TS.ResolvedProjectReference | undefined,\n          options: TS.CompilerOptions,\n        ): Array<TS.ResolvedModule | undefined> => {\n          if (isVueFile(containingFile))\n            throw new Error('A .vue file should not be part of TS program.')\n\n          const newModuleNames = moduleNames.map((moduleName) =>\n            isVueFile(moduleName)\n              ? moduleName + VIRTUAL_FILENAME_SEPARATOR + MODULE_SELECTOR\n              : moduleName.endsWith('.vue?internal')\n              ? moduleName.replace(/\\?internal$/, '') +\n                VIRTUAL_FILENAME_SEPARATOR +\n                INTERNAL_MODULE_SELECTOR\n              : moduleName,\n          )\n\n          // TODO: Support paths mapped to .vue files, if needed.\n          const result =\n            resolveModuleNames != null\n              ? resolveModuleNames(\n                  newModuleNames,\n                  containingFile,\n                  reusedNames,\n                  redirectedReferences,\n                  options,\n                )\n              : []\n\n          const index = moduleNames.indexOf('@@vuedx/vue-2-support')\n          if (index >= 0 && result[index] == null) {\n            // Vue 2\n            result[index] = {\n              resolvedFileName: vue2supportFile,\n              isExternalLibraryImport: true,\n            }\n          }\n\n          result.forEach((resolved) => {\n            if (resolved != null && isVirtualFile(resolved.resolvedFileName)) {\n              context.tryCreateScriptInfo(resolved.resolvedFileName) // Trigger .vue script info creation.\n            }\n          })\n\n          if (__DEV__) {\n            if (!containingFile.includes('node_modules')) {\n              if (__DEV__)\n                context.debug(\n                  `Module resolution in ${containingFile} :: ` +\n                    JSON.stringify(\n                      moduleNames.map(\n                        (name, index) =>\n                          `${name} => ${newModuleNames[index]} => ${\n                            result[index]?.resolvedFileName ?? '?'\n                          }`,\n                      ),\n                      null,\n                      2,\n                    ),\n                )\n            }\n          }\n\n          return result\n        },\n      )\n    },\n  )\n}\n\nfunction patchServiceHost(context: PluginContext): void {\n  patchWatchFile(context)\n  patchWatchDirectory(context)\n  patchFileExists(context)\n  patchReadFile(context)\n  patchReadDirectory(context)\n}\n\nfunction patchWatchFile(context: PluginContext): void {\n  tryPatchMethod(context.serviceHost, 'watchFile', (watchFile) => {\n    context.log(\n      `[patch] Override watchFile to watch virtual files. (ServiceHost)`,\n    )\n\n    return wrapFn(\n      'watchFile',\n      (\n        fileName: string,\n        callback: TS.FileWatcherCallback,\n        pollingInterval?: number,\n        options?: TS.WatchOptions,\n      ): TS.FileWatcher => {\n        if (isVirtualFile(fileName)) {\n          return watchFile(\n            getContainingFile(fileName),\n            (_, event) => {\n              callback(fileName, event)\n            },\n            pollingInterval,\n            options,\n          )\n        }\n\n        return watchFile(fileName, callback, pollingInterval, options)\n      },\n    )\n  })\n}\n\nfunction patchWatchDirectory(context: PluginContext): void {\n  tryPatchMethod(context.serviceHost, 'watchDirectory', (watchDirectory) => {\n    context.log(\n      `[patch] Override watchDirectory to watch virtual files. (ServiceHost)`,\n    )\n\n    return wrapFn(\n      'watchDirectory',\n      (\n        fileName: string,\n        callback: TS.DirectoryWatcherCallback,\n        recursive?: boolean,\n        options?: TS.WatchOptions,\n      ): TS.FileWatcher => {\n        return watchDirectory(\n          fileName,\n          (fileName) => {\n            if (isVueFile(fileName)) {\n              // TODO: Ensure this does mess with fileName case-sensitivity\n              const document = context.store.get(fileName)\n              if (document != null) {\n                callback(document.getDocumentFileName('_module'))\n              }\n            } else {\n              callback(fileName)\n            }\n          },\n          recursive,\n          options,\n        )\n      },\n    )\n  })\n}\n\nfunction isSupportedFile(fileName: string): boolean {\n  return /\\.(ts|js)x?$/.test(fileName)\n}\nfunction triggerFileUpdate(context: PluginContext, fileName: string): void {\n  if (!isSupportedFile(fileName)) return\n  if (__DEV__) context.debug(`Taint/MarkChanged ${fileName}`)\n  const scriptInfo = context.projectService.getScriptInfo(fileName)\n\n  if (scriptInfo != null) {\n    // @ts-expect-error - internal method but it's better for performance compared to it's public counter part `reloadFromFile()`.\n    scriptInfo.delayReloadNonMixedContentFile()\n  } else if (__DEV__) context.debug(`Cannot find scriptInfo for ${fileName}`)\n}\n\nfunction triggerFileCreate(context: PluginContext, fileName: string): void {\n  if (!isSupportedFile(fileName)) return\n  if (__DEV__) context.debug(`Create ${fileName}`)\n  context.projectService.getScriptInfo(fileName)\n}\n\nfunction triggerFileDelete(context: PluginContext, fileName: string): void {\n  if (!isSupportedFile(fileName)) return\n  if (__DEV__) context.debug(`Delete ${fileName}`)\n  const scriptInfo = context.projectService.getScriptInfo(fileName)\n  if (scriptInfo != null) {\n    scriptInfo.detachAllProjects()\n  }\n}\n\nfunction patchScriptInfo(\n  context: PluginContext,\n  scriptInfo: TS.server.ScriptInfo,\n): void {\n  if (scriptInfo == null) throw new Error('ScriptInfo is required.')\n\n  tryPatchMethod(scriptInfo, 'editContent', (editContent) => {\n    context.log(\n      `[patch] Override editContent() of \"${scriptInfo.fileName}\" to sync virtual files. (ScriptInfo)`,\n    )\n\n    return wrapFn(\n      'editContent',\n      (start: number, end: number, newText: string): void => {\n        const document = context.store.get(scriptInfo.fileName)\n        if (document == null)\n          throw new Error('VueTextDocument should exist for every ScriptInfo.')\n\n        const prevFileNames = new Set(\n          document.all().map((document) => document.fsPath),\n        )\n        const range = {\n          start: document.positionAt(start),\n          end: document.positionAt(end),\n        }\n        editContent(start, end, newText)\n\n        const newDocument = VueTextDocument.update(\n          document,\n          [{ range, text: newText }],\n          getLastNumberFromVersion(scriptInfo.getLatestVersion()),\n        )\n\n        newDocument.all().forEach((document) => {\n          if (prevFileNames.has(document.fsPath)) {\n            // update\n            prevFileNames.delete(document.fsPath)\n            triggerFileUpdate(context, document.fsPath)\n          } else {\n            triggerFileCreate(context, document.fsPath)\n          }\n        })\n\n        prevFileNames.forEach((fileName) =>\n          triggerFileDelete(context, fileName),\n        )\n      },\n    )\n  })\n}\n","export const ORIGINAL_LANGUAGE_SERVER = Symbol('TS_Language_Server')\n","import { ComponentInfo, createFullAnalyzer, SourceRange } from '@vuedx/analyze'\nimport type { SFCBlock } from '@vuedx/compiler-sfc'\nimport { collectError, isNotNull } from '@vuedx/shared'\nimport {\n  findTemplateChildrenInRange,\n  findTemplateNodeAt,\n  findTemplateNodeInRange,\n  Node,\n  TraversalAncestors,\n} from '@vuedx/template-ast-types'\nimport {\n  getContainingFile,\n  INTERNAL_MODULE_SELECTOR,\n  isVirtualFile,\n  isVirtualFileOfType,\n  isVueFile,\n  MODULE_SELECTOR,\n  parseVirtualFileName,\n  RenderFunctionTextDocument,\n  RENDER_SELECTOR,\n  SCRIPT_BLOCK_SELECTOR,\n  SCRIPT_SETUP_BLOCK_SELECTOR,\n  VirtualTextDocument,\n  VueTextDocument,\n} from '@vuedx/vue-virtual-textdocument'\nimport Path from 'path'\nimport QuickLRU from 'quick-lru'\nimport { ORIGINAL_LANGUAGE_SERVER } from '../constants'\nimport { PluginContext } from '../context'\nimport { PluginConfig, TS } from '../interfaces'\n\nfunction createCachedAnalyzer(): (document: VueTextDocument) => ComponentInfo {\n  const cache = new QuickLRU<string, ComponentInfo>({ maxSize: 1000 })\n  const analyzer = createFullAnalyzer([], {\n    babel: { plugins: ['typescript', 'jsx'] },\n  })\n\n  return (document: VueTextDocument) => {\n    const key = `${document.version}::${document.fsPath}`\n    const info =\n      cache.get(key) ?? analyzer.analyze(document.getText(), document.fsPath)\n    cache.set(key, info)\n\n    return info\n  }\n}\n\ntype GetElementType<T> = T extends Array<infer U> ? U : T\n\n// TODO: Use memoize one, in most common scenario helper functions are called again in same request context (which means same arguments).\n// eslint-disable-next-line @typescript-eslint/explicit-function-return-type\nexport function createServerHelper(\n  context: PluginContext,\n  languageService: TS.LanguageService,\n) {\n  const getComponentInfo = createCachedAnalyzer()\n\n  function isFeatureEnabled<K extends keyof PluginConfig['features']>(\n    featureName: K,\n    checkFor: boolean | GetElementType<PluginConfig['features'][K]> = true,\n  ): boolean {\n    const feature = context.config.features[featureName]\n\n    return Array.isArray(feature)\n      ? feature.includes(checkFor)\n      : feature === true || feature === checkFor\n  }\n\n  /**\n   * Find node in template containing given position.\n   * @param fileName Vue or Virtual Block filename\n   * @param position Position or range\n   */\n  function findTemplateNodeAtPosition(\n    fileName: string,\n    position: number | TS.TextRange,\n  ):\n    | {\n        node: Node\n        ancestors: TraversalAncestors\n        document: RenderFunctionTextDocument\n      }\n    | {\n        node: null\n        ancestors: TraversalAncestors\n        document: RenderFunctionTextDocument | null\n      } {\n    const document = getRenderDoc(fileName)\n\n    if (document?.ast != null) {\n      if (typeof position === 'number') {\n        return {\n          ...findTemplateNodeAt(document.ast, position),\n          document,\n        }\n      } else {\n        return {\n          ...findTemplateNodeInRange(document.ast, position.pos, position.end),\n          document,\n        }\n      }\n    }\n\n    return { node: null, ancestors: [], document: null }\n  }\n\n  function findTemplateChildren(\n    fileName: string,\n    position: number | TS.TextRange,\n  ): Node[] {\n    const document = getRenderDoc(fileName)\n\n    return document?.ast != null\n      ? typeof position === 'number'\n        ? findTemplateChildrenInRange(document.ast, position, position)\n        : findTemplateChildrenInRange(document.ast, position.pos, position.end)\n      : []\n  }\n\n  function getDocument(\n    fileName: string,\n  ): VueTextDocument | VirtualTextDocument | null {\n    return isVirtualFile(fileName)\n      ? context.store.get(getContainingFile(fileName))?.getDocument(fileName) ??\n          null\n      : context.store.get(fileName)\n  }\n\n  function getVueDocument(fileName: string): VueTextDocument | null {\n    return isVueFile(fileName)\n      ? context.store.get(fileName)\n      : isVirtualFile(fileName)\n      ? context.store.get(getContainingFile(fileName))\n      : null\n  }\n\n  function getBlockAt(\n    fileName: string,\n    position: number | TS.TextRange,\n  ): SFCBlock | null {\n    const document = getVueDocument(fileName)\n\n    if (document != null) {\n      if (typeof position === 'number') {\n        return document.blockAt(position) ?? null\n      } else {\n        const a = document.blockAt(position.pos)\n        const b = document.blockAt(position.end)\n\n        if (a === b) return a ?? null\n      }\n    }\n\n    return null\n  }\n\n  function getDocumentForBlock(\n    fileName: string,\n    block: SFCBlock,\n  ): VirtualTextDocument | null {\n    const document = getVueDocument(fileName)\n    if (document != null) {\n      if (block.type === 'template') {\n        return document.getDocument(RENDER_SELECTOR)\n      }\n\n      const selector = document.getBlockSelector(block)\n      if (selector != null) {\n        return document.getDocument(selector)\n      }\n    }\n    return null\n  }\n\n  function getDocumentAt(\n    fileName: string,\n    position: number | TS.TextRange,\n  ): VirtualTextDocument | null {\n    const block = getBlockAt(fileName, position)\n    if (block != null) {\n      return getDocumentForBlock(fileName, block)\n    }\n\n    return null\n  }\n  function getAllDocuments(fileName: string): VirtualTextDocument[] {\n    const document = getVueDocument(fileName)\n    const documents: Array<VirtualTextDocument | null | undefined> = []\n    if (document != null) {\n      if (isVirtualFile(fileName)) {\n        documents.push(document.getDocument(fileName))\n      } else {\n        documents.push(\n          document.getDocument(RENDER_SELECTOR),\n          document.getDocument(INTERNAL_MODULE_SELECTOR),\n          document.getDocument(MODULE_SELECTOR),\n          document.getDocument(SCRIPT_BLOCK_SELECTOR),\n          document.getDocument(SCRIPT_SETUP_BLOCK_SELECTOR),\n        )\n      }\n    }\n\n    return documents.filter(isNotNull)\n  }\n\n  function isRenderFunctionDocument(\n    document: unknown,\n  ): document is RenderFunctionTextDocument {\n    return (document as VirtualTextDocument)?.selector.type === RENDER_SELECTOR\n  }\n\n  function isRenderFunctionFileName(fileName: string): boolean {\n    return (\n      isVirtualFile(fileName) &&\n      parseVirtualFileName(fileName)?.selector.type === RENDER_SELECTOR\n    )\n  }\n\n  function isVueModuleFileName(fileName: string): boolean {\n    return isVirtualFileOfType(fileName, MODULE_SELECTOR)\n  }\n\n  function getRenderDoc(\n    fileName: string,\n  ): RenderFunctionTextDocument | undefined {\n    return getVueDocument(fileName)?.getDocument('_render')\n  }\n\n  function getTextSpan(\n    document: VirtualTextDocument,\n    span: TS.TextSpan,\n    node?: Node | null,\n  ): TS.TextSpan {\n    if (isRenderFunctionDocument(document)) {\n      const result = document.getOriginalOffsetAt(span.start)\n      if (result != null)\n        return {\n          start: result.offset,\n          length: Math.min(result.length, span.length),\n        }\n    }\n\n    return span\n  }\n\n  function getResolvedModule(\n    fileName: string,\n    importSource: string,\n  ): TS.ResolvedModuleFull | undefined {\n    const program = languageService.getProgram()\n    const sourceFile = program?.getSourceFile(fileName) as any\n    const resolvedModules: Map<string, TS.ResolvedModuleFull> | undefined =\n      sourceFile?.resolvedModules\n\n    return resolvedModules?.get(importSource)\n  }\n\n  function findTypeScriptNodeAtPosition(\n    fileName: string,\n    position: number | TS.TextRange,\n  ): TS.Node | undefined {\n    const findNodeAt = (\n      start: number,\n      end: number,\n      container: TS.Node,\n    ): TS.Node | undefined => {\n      const node = container\n        .getChildren()\n        .find((node) => node.pos <= start && end <= node.end)\n\n      if (node != null) {\n        if (node.pos === start && node.pos === end) return node\n        else return findNodeAt(start, end, node) ?? node\n      } else {\n        return container\n      }\n    }\n\n    const scriptFile = languageService.getProgram()?.getSourceFile(fileName)\n\n    if (scriptFile != null) {\n      const result =\n        typeof position === 'number'\n          ? findNodeAt(position, position, scriptFile)\n          : findNodeAt(position.pos, position.end, scriptFile)\n\n      if (result !== scriptFile) return result\n    }\n  }\n\n  function getLanguageServiceFor(\n    fileName: string,\n    fallback?: TS.LanguageService,\n  ): TS.LanguageService {\n    if (fallback != null) {\n      try {\n        const program = fallback.getProgram()\n        if (program != null) {\n          program.getSourceFile(fileName)\n          return fallback\n        }\n      } catch {\n        // fileName is not part of program. find correct program using project\n      }\n    }\n\n    try {\n      const project = context.projectService.getDefaultProjectForFile(\n        context.typescript.server.toNormalizedPath(fileName),\n        true,\n      )\n\n      if (project == null) return fallback ?? languageService\n      const service = project.getLanguageService()\n      if (__DEV__)\n        context.debug(\n          `Project for \"${fileName}\" is ${project.getProjectName()}`,\n        )\n      if (ORIGINAL_LANGUAGE_SERVER in service) {\n        return (service as any)[ORIGINAL_LANGUAGE_SERVER]\n      } else {\n        return service\n      }\n    } catch {\n      return fallback ?? languageService\n    }\n  }\n\n  function getSourceFile(\n    fileName: string,\n    service?: TS.LanguageService,\n  ): TS.SourceFile | undefined {\n    try {\n      return getLanguageServiceFor(fileName, service)\n        .getProgram()\n        ?.getSourceFile(fileName)\n    } catch (error) {\n      collectError(error)\n    }\n  }\n\n  return {\n    isFeatureEnabled,\n    getLanguageServiceFor,\n    getSourceFile,\n    findTemplateChildren,\n    findTemplateNodeAtPosition,\n    findTypeScriptNodeAtPosition,\n    getComponentInfo,\n    getDocument,\n    getDocumentAt,\n    getAllDocuments,\n    getRenderDoc,\n    getTextSpan,\n    getVueDocument,\n    isRenderFunctionDocument,\n    isRenderFunctionFileName,\n    isVueModuleFileName,\n    getResolvedModule,\n  }\n}\n\nexport function computeIdentifierReplacement(\n  source: string,\n  identifer: string,\n): { prefixText: string; suffixText: string } {\n  const RE = new RegExp(`\\\\b${identifer}\\\\b`)\n  const match = RE.exec(source)\n\n  if (match == null) return { prefixText: source, suffixText: '' }\n\n  return {\n    prefixText: source.substr(0, match.index),\n    suffixText: source.substr(match.index + match[0].length),\n  }\n}\n\nexport function getPaddingLength(source: string, offset: number = 0): number {\n  source = source.substr(offset)\n  const match = /^[\\s\\r\\n]+/m.exec(source)\n\n  return match != null ? match[0].length : 0\n}\n\nexport function getFilenameForNewComponent(\n  context: PluginContext,\n  directory: string,\n  usedNames = new Set<string>(),\n): string {\n  let name = 'Component0'\n  let fileName = Path.posix.join(directory, 'Component0.vue')\n  let index = 0\n\n  if (context.serviceHost.directoryExists(directory)) {\n    const files = new Set(\n      context.serviceHost.readDirectory(directory, ['.vue'], [], [], 1),\n    )\n\n    while (files.has(fileName) || usedNames.has(name)) {\n      name = `Component${++index}`\n      fileName = Path.posix.join(directory, `${name}.vue`)\n    }\n  }\n\n  return fileName\n}\n\nexport function indent(\n  code: string,\n  size: number = 2,\n  prefix: boolean = true,\n): string {\n  const text = ' '.repeat(size)\n\n  return (prefix ? text : '') + code.split('\\n').join('\\n' + text)\n}\n\nexport function getCode(...lines: Array<string | string[]>): string {\n  return lines.flat().join('\\n')\n}\n\nexport function isSpanInSourceRange(\n  span: TS.TextSpan,\n  range?: SourceRange,\n): boolean {\n  if (range == null) return false\n\n  return (\n    range.start.offset <= span.start &&\n    span.start + span.length <= range.end.offset\n  )\n}\n\nexport function isTextRangeInSourceRange(\n  textRange: number | TS.TextRange,\n  range?: SourceRange,\n): boolean {\n  if (range == null) return false\n  const span: TS.TextSpan =\n    typeof textRange === 'number'\n      ? { start: textRange, length: 0 }\n      : { start: textRange.pos, length: textRange.end - textRange.pos }\n\n  return isSpanInSourceRange(span, range)\n}\n\nexport function getScriptFileName(document: VueTextDocument): string {\n  if (document.descriptor.scriptSetup != null) {\n    return document.getDocumentFileName(SCRIPT_SETUP_BLOCK_SELECTOR)\n  } else {\n    return document.getDocumentFileName(SCRIPT_BLOCK_SELECTOR)\n  }\n}\n","import { TypeInfo } from '@vuedx/analyze'\nimport { ProjectPreferences } from '@vuedx/projectconfig'\nimport { isNotNull } from '@vuedx/shared'\nimport { TS } from '../../interfaces'\nimport { LanguageServiceOptions } from '../../types'\n\ninterface BlockCompletionInfo {\n  name: string\n  description: string\n  attributes: Array<{\n    name: string\n    description: string\n    value: TypeInfo\n    required?: boolean\n    default?: string\n  }>\n}\n\nconst customBlocks: BlockCompletionInfo[] = [\n  {\n    name: 'preview',\n    description: `Component story/preview using [VueDX Preview](https://github.com/znck/preview).`,\n    attributes: [\n      {\n        name: 'device',\n        description: 'Mock device',\n        value: {\n          kind: 'enum',\n          values: ['phone', 'tablet', 'desktop', 'freeform'],\n        },\n      },\n    ],\n  },\n]\n\nexport class SFCCompletionService {\n  constructor(private readonly $: LanguageServiceOptions) {}\n\n  public getCompletionsAtPosition(\n    fileName: string,\n    position: number,\n    options: TS.GetCompletionsAtPositionOptions | undefined,\n  ): TS.WithMetadata<TS.CompletionInfo> | undefined {\n    const completions: TS.WithMetadata<TS.CompletionInfo> = {\n      isGlobalCompletion: false,\n      isMemberCompletion: false,\n      isNewIdentifierLocation: false,\n      entries: this.getCompletionEntries(fileName, position),\n    }\n\n    // TODO: Handle attribute completion for blocks.\n\n    return completions\n  }\n\n  private getCompletionEntries(\n    fileName: string,\n    position: number,\n  ): Array<TS.CompletionEntry & { block?: BlockCompletionInfo }> {\n    const document = this.$.helpers.getVueDocument(fileName)\n    const entries: Array<\n      TS.CompletionEntry & { block?: BlockCompletionInfo }\n    > = []\n    if (document != null) {\n      let replacementSpan: TS.TextSpan | undefined\n      const startPosition = document.getText().lastIndexOf('<', position)\n      if (startPosition >= 0) {\n        replacementSpan = {\n          start: startPosition,\n          length: position - startPosition,\n        }\n      }\n      const project = this.$.context.getVueProjectForFile(fileName, true)\n      const isEmpty = !document.getText().includes('>')\n\n      if (isEmpty) {\n        entries.push({\n          name: '<script>, <template>',\n          kind: this.$.context.typescript.ScriptElementKind.unknown,\n          kindModifiers: '',\n          sortText: '0',\n          insertText: [\n            getScriptBlockWithContent(\n              project.version,\n              project.config.preferences.script,\n            ),\n            getTemplateBlock(),\n          ].join('\\n'),\n          hasAction: true,\n          replacementSpan,\n          isRecommended: true,\n        })\n        entries.push({\n          name: '<template>, <script>',\n          kind: this.$.context.typescript.ScriptElementKind.unknown,\n          kindModifiers: '',\n          sortText: '0',\n          insertText: [\n            getScriptBlockWithContent(\n              project.version,\n              project.config.preferences.script,\n            ),\n            getTemplateBlock(),\n          ].join('\\n'),\n          hasAction: true,\n          replacementSpan,\n        })\n      }\n      if (document.descriptor.template == null) {\n        entries.push({\n          name: '<template>',\n          kind: this.$.context.typescript.ScriptElementKind.unknown,\n          kindModifiers: '',\n          sortText: '0',\n          insertText: getTemplateBlock(),\n          hasAction: true,\n          replacementSpan,\n          isRecommended: entries.length === 0 ? true : undefined,\n        })\n      }\n      if (document.descriptor.scriptSetup == null) {\n        entries.push({\n          name: '<script setup>',\n          kind: this.$.context.typescript.ScriptElementKind.unknown,\n          kindModifiers: '',\n          sortText: '0',\n          insertText: getScriptBlock('', {\n            ...project.config.preferences.script,\n            mode: 'setup',\n          }),\n          hasAction: true,\n          replacementSpan,\n          isRecommended: entries.length === 0 ? true : undefined,\n        })\n      }\n      if (document.descriptor.script == null) {\n        entries.push({\n          name: '<script>',\n          kind: this.$.context.typescript.ScriptElementKind.unknown,\n          kindModifiers: '',\n          sortText: '0',\n          insertText:\n            document.descriptor.scriptSetup != null\n              ? getScriptBlock('', {\n                  ...project.config.preferences.script,\n                  mode: 'normal',\n                })\n              : getScriptBlockWithContent(project.version, {\n                  ...project.config.preferences.script,\n                  mode: 'normal',\n                }),\n          hasAction: true,\n          replacementSpan,\n          isRecommended: entries.length === 0 ? true : undefined,\n        })\n      }\n      entries.push({\n        name: '<style>',\n        kind: this.$.context.typescript.ScriptElementKind.unknown,\n        kindModifiers: '',\n        sortText: '0',\n        insertText: getStyleBlock('', project.config.preferences.style),\n        hasAction: true,\n        replacementSpan,\n        isRecommended: entries.length === 0 ? true : undefined,\n      })\n      entries.push({\n        name: '<style scoped>',\n        kind: this.$.context.typescript.ScriptElementKind.unknown,\n        kindModifiers: '',\n        sortText: '0',\n        insertText: getStyleBlock('', {\n          ...project.config.preferences.style,\n          scoped: true,\n        }),\n        hasAction: true,\n        replacementSpan,\n      })\n      entries.push({\n        name: '<style module>',\n        kind: this.$.context.typescript.ScriptElementKind.unknown,\n        kindModifiers: '',\n        sortText: '0',\n        insertText: getStyleBlock('', {\n          ...project.config.preferences.style,\n          module: true,\n        }),\n        hasAction: true,\n        replacementSpan,\n      })\n      customBlocks.forEach((block) => {\n        entries.push({\n          name: `<${block.name}>`,\n          kind: this.$.context.typescript.ScriptElementKind.unknown,\n          kindModifiers: '',\n          sortText: '0',\n          insertText: getBlock(\n            block.name,\n            block.attributes.map((attribute) =>\n              attribute.required === true\n                ? [attribute.name, attribute.default ?? true]\n                : undefined,\n            ),\n            '',\n          ),\n          hasAction: true,\n          replacementSpan,\n          block,\n        })\n      })\n    }\n    return entries\n  }\n\n  public getCompletionEntryDetails(\n    fileName: string,\n    position: number,\n    entryName: string,\n    formatOptions: TS.FormatCodeOptions | TS.FormatCodeSettings | undefined,\n    source: string | undefined,\n    preferences: TS.UserPreferences | undefined,\n  ): TS.CompletionEntryDetails | undefined {\n    const entry = this.getCompletionEntries(fileName, position).find(\n      (entry) => entry.name === entryName,\n    )\n\n    if (entry != null) {\n      return {\n        name: entry.name,\n        kind: entry.kind,\n        kindModifiers: entry.kindModifiers ?? '',\n        displayParts: [],\n        documentation:\n          entry.block != null\n            ? [\n                { kind: 'markdown', text: entry.block.description },\n                {\n                  kind: 'markdown',\n                  text: ['```vue', entry.insertText ?? '', '```'].join('\\n'),\n                },\n              ]\n            : [\n                {\n                  kind: 'markdown',\n                  text: ['```vue', entry.insertText ?? '', '```'].join('\\n'),\n                },\n              ],\n      }\n    }\n\n    return undefined\n  }\n\n  public getCompletionEntrySymbol(\n    _fileName: string,\n    _position: number,\n    _name: string,\n    _source: string | undefined,\n  ): TS.Symbol | undefined {\n    return undefined\n  }\n}\n\nfunction getTemplateBlock(content: string = '  <div></div>'): string {\n  return getBlock('template', [], content)\n}\n\nfunction getStyleBlock(\n  content: string,\n  options: ProjectPreferences['style'] & {\n    scoped?: boolean\n    module?: boolean | string\n  },\n): string {\n  return getBlock(\n    'style',\n    [\n      options.language !== 'css' ? ['lang', options.language] : undefined,\n      options.scoped === true ? ['scoped', true] : undefined,\n      options.module === '$style' || options.module === true\n        ? ['module', true]\n        : typeof options.module === 'string'\n        ? ['module', options.module]\n        : undefined,\n    ],\n    content,\n  )\n}\n\nexport function getScriptBlockWithContent(\n  version: string,\n  options: ProjectPreferences['script'],\n  optionsContent: string = '',\n  prefixContent: string = '',\n): string {\n  return getScriptBlock(\n    options.mode === 'normal'\n      ? version.startsWith('2.')\n        ? [prefixContent, `export default ${optionsContent}`].join('\\n').trim()\n        : [\n            prefixContent,\n            `import { defineComponent } from 'vue'`,\n            ``,\n            `export default defineComponent(${optionsContent})`,\n          ]\n            .join('\\n')\n            .trim()\n      : '',\n    options,\n  )\n}\n\nexport function getScriptBlock(\n  content: string,\n  options: ProjectPreferences['script'],\n): string {\n  return getBlock(\n    'script',\n    [\n      options.language !== 'js' ? ['lang', options.language] : undefined,\n      options.mode !== 'normal' ? ['setup', true] : undefined,\n    ],\n    content,\n  )\n}\n\nexport function getBlock(\n  tag: string,\n  attributes: Array<[string, string | true] | undefined>,\n  content: string,\n): string {\n  return [\n    `<${tag}${attributes\n      .filter(isNotNull)\n      .map(([key, value]) =>\n        value === true ? ` ${key}` : ` ${key}=${JSON.stringify(value)}`,\n      )\n      .join('')}>`,\n    content,\n    `</${tag}>`,\n    ``,\n  ].join('\\n')\n}\n","import { ComponentInfo, ImportSource } from '@vuedx/analyze'\nimport type { SFCScriptBlock } from '@vuedx/compiler-sfc'\nimport {\n  ProjectConfigNormalized,\n  ProjectPreferences,\n} from '@vuedx/projectconfig'\nimport { isSimpleIdentifier } from '@vuedx/template-ast-types'\nimport { VueTextDocument } from '@vuedx/vue-virtual-textdocument'\nimport { getScriptBlockWithContent } from '../features/completions/SFCCompletionProvider'\nimport { getCode, getPaddingLength, indent } from '../helpers/utils'\nimport { TS } from '../interfaces'\n\nexport function registerLocalComponentWithSource(\n  document: VueTextDocument,\n  componentInfo: ComponentInfo,\n  source: ImportSource | { localName: string },\n  preferences: ProjectPreferences['script'],\n  vueVersion: string,\n  importStatement?: string,\n): TS.TextChange[] {\n  const { scriptSetup, script } = document.descriptor\n  const changes: TS.TextChange[] = []\n\n  if (importStatement == null && 'exportName' in source) {\n    importStatement = `import ${\n      source.exportName != null\n        ? source.localName === source.exportName\n          ? `{ ${source.exportName} }`\n          : `{ ${source.exportName} as ${source.localName} }`\n        : source.localName\n    } from ${JSON.stringify(source.moduleName)}`\n  }\n\n  if (scriptSetup != null) {\n    if (importStatement != null) {\n      changes.push({\n        span: { start: scriptSetup.loc.start.offset + 1, length: 0 },\n        newText: importStatement,\n      })\n    }\n  } else if (script != null) {\n    if (importStatement != null) {\n      changes.push({\n        span: { start: script.loc.start.offset + 1, length: 0 },\n        newText: importStatement,\n      })\n    }\n    changes.push(\n      ...registerComponentAPI(\n        document,\n        componentInfo,\n        'components',\n        source.localName,\n        source.localName,\n        vueVersion,\n      ).changes,\n    )\n  } else {\n    changes.push({\n      span: { start: 0, length: 0 },\n      newText: getScriptBlockWithContent(\n        vueVersion,\n        preferences,\n        [`{`, `  components: { ${source.localName} }`, `}`].join('\\n'),\n        importStatement,\n      ),\n    })\n  }\n\n  return changes\n}\n\nexport function registerComponentAPI(\n  document: VueTextDocument,\n  componentInfo: ComponentInfo,\n  apiName:\n    | 'data'\n    | 'setupComputed'\n    | 'setupMethods'\n    | 'methods'\n    | 'computed'\n    | 'watch'\n    | 'props'\n    | 'emits'\n    | 'components'\n    | 'directives',\n  name: string,\n  value: string,\n  version: string,\n  preferences?: ProjectConfigNormalized['preferences']['script'],\n): {\n  renameLocation?: number\n  changes: TS.TextChange[]\n  scriptStartOffset?: number\n} {\n  if (\n    apiName === 'setupComputed' ||\n    apiName === 'setupMethods' ||\n    apiName === 'data'\n  ) {\n    return addOptionToConfigFunction(\n      document,\n      componentInfo,\n      apiName,\n      name,\n      value,\n      version,\n    )\n  } else {\n    return addOptionToConfigObject(\n      document,\n      componentInfo,\n      apiName,\n      name,\n      value,\n      version,\n      preferences,\n    )\n  }\n}\n\nexport function addOptionToConfigFunction(\n  document: VueTextDocument,\n  componentInfo: ComponentInfo,\n  apiName: 'data' | 'setupComputed' | 'setupMethods',\n  name: string,\n  value: string,\n  vueVersion: string,\n  preferences?: ProjectConfigNormalized['preferences']['script'],\n): {\n  renameLocation?: number\n  changes: TS.TextChange[]\n  scriptStartOffset?: number\n} {\n  const { scriptSetup, script } = document.descriptor\n  if (scriptSetup != null) {\n    return addOptionToScriptSetupConfig(\n      scriptSetup,\n      componentInfo.scriptSetup,\n      apiName.startsWith('setup') ? apiName.substr(5).toLowerCase() : apiName,\n      name,\n      value,\n    )\n  } else if (script != null) {\n    const changes: TS.TextChange[] = []\n    let scriptStartOffset: number | undefined\n    if (apiName === 'data') {\n      // TODO: Find return statement in data() fn.\n    } else {\n      const api = apiName.substr(5).toLowerCase()\n\n      let code: string\n      if (api === 'computed') {\n        const hasComputed = /\\bcomputed\\b/.test(script.content)\n        if (!hasComputed) {\n          changes.push({\n            newText: getCode(`import { computed } from 'vue'`, ``),\n            span: {\n              start:\n                script.loc.start.offset +\n                getPaddingLength(script.content, script.loc.start.offset),\n              length: 0,\n            },\n          })\n        }\n        code = `const ${name} = computed(${value})`\n      } else if (api === 'methods') {\n        code = `function ${name}${value.replace(/^function /, '')}`\n      } else {\n        code = `const ${name} = ${value}`\n      }\n\n      if (componentInfo.fnSetupOption != null) {\n        if (componentInfo.fnSetupOption.return != null) {\n          const loc = componentInfo.fnSetupOption.return.loc\n          const start =\n            componentInfo.fnSetupOption.loc.start.offset +\n            componentInfo.fnSetupOption.loc.source.lastIndexOf('return')\n\n          changes.push({\n            newText: getCode(indent(code, 4, false), ``, `    `),\n            span: { start: start, length: 0 },\n          })\n\n          if (isSimpleIdentifier(loc.source)) {\n            changes.push({\n              newText: getCode(\n                `{`,\n                `    ...${loc.source.trim()}`,\n                `    ${name},`,\n                `}`,\n              ),\n              span: { start: loc.start.offset, length: loc.source.length },\n            })\n          } else {\n            if (loc.source.includes('\\n')) {\n              changes.push({\n                newText: getCode(``, `      ${name},`),\n                span: {\n                  start: loc.start.offset + 1,\n                  length: 0,\n                },\n              })\n            } else {\n              changes.push({\n                newText: getCode(` ${name},`),\n                span: {\n                  start: loc.start.offset + 1,\n                  length: 0,\n                },\n              })\n            }\n          }\n        } else {\n          // TODO: Insert return statement?\n        }\n      } else {\n        const newText = getCode(\n          `function (props, context) {`,\n          `  ${code}`,\n          `  return { ${name} }`,\n          `}`,\n        )\n\n        const result = addOptionToScriptConfig(\n          vueVersion,\n          script,\n          componentInfo.options,\n          componentInfo.fnSetupOption,\n          '',\n          'setup',\n          newText,\n        )\n\n        changes.push(...result.changes)\n      }\n    }\n\n    return {\n      scriptStartOffset,\n      changes,\n    }\n  } else {\n    return {\n      changes: [],\n    }\n  }\n}\n\nfunction addOptionToConfigObject(\n  document: VueTextDocument,\n  componentInfo: ComponentInfo,\n  apiName:\n    | 'methods'\n    | 'computed'\n    | 'watch'\n    | 'props'\n    | 'emits'\n    | 'components'\n    | 'directives',\n  name: string,\n  value: string,\n  vueVersion: string,\n  preferences?: ProjectConfigNormalized['preferences']['script'],\n): {\n  renameLocation?: number\n  changes: TS.TextChange[]\n  scriptStartOffset?: number\n} {\n  const { scriptSetup, script } = document.descriptor\n\n  if (scriptSetup != null) {\n    return addOptionToScriptSetupConfig(\n      scriptSetup,\n      componentInfo.scriptSetup,\n      apiName,\n      name,\n      value,\n    )\n  } else if (script != null) {\n    return addOptionToScriptConfig(\n      vueVersion,\n      script,\n      componentInfo.options,\n      componentInfo.fnSetupOption,\n      apiName,\n      name,\n      value,\n    )\n  } else if (preferences != null) {\n    const changes: TS.TextChange[] = []\n    const language =\n      preferences.language === 'js' ? '' : ` lang=\"${preferences.language}\"`\n    const mode = preferences.mode === 'normal' ? '' : ' setup'\n    const startTag = `<script${language}${mode}>\\n`\n\n    const result =\n      preferences.mode === 'normal'\n        ? addOptionToScriptConfig(\n            vueVersion,\n            createFakeScriptBock(preferences.language),\n            undefined,\n            undefined,\n            apiName,\n            name,\n            value,\n          )\n        : addOptionToScriptSetupConfig(\n            createFakeScriptSetupBock(preferences.language),\n            undefined,\n            apiName,\n            name,\n            value,\n          )\n\n    document.markDirty() // <- potentially changed\n\n    changes.push({\n      newText: startTag,\n      span: { start: 0, length: 0 },\n    })\n    changes.push(...result.changes)\n    changes.push({\n      newText: getCode(`</script>`, ``, ``),\n      span: { start: 0, length: 0 },\n    })\n\n    return {\n      changes,\n      renameLocation:\n        result.renameLocation != null\n          ? result.renameLocation + startTag.length\n          : 0,\n      scriptStartOffset: startTag.length,\n    }\n  }\n\n  return { changes: [] }\n}\n\nfunction createFakeScriptBock(lang?: string): SFCScriptBlock {\n  if (lang === 'js') lang = undefined\n\n  return {\n    content: '',\n    attrs: lang != null ? { lang } : {},\n    lang,\n    type: 'script',\n    loc: {\n      source: '',\n      start: {\n        offset: 0,\n        line: 0,\n        column: 0,\n      },\n      end: {\n        offset: 0,\n        line: 0,\n        column: 0,\n      },\n    },\n  }\n}\n\nfunction createFakeScriptSetupBock(lang?: string): SFCScriptBlock {\n  if (lang === 'js') lang = undefined\n\n  return {\n    content: '',\n    attrs: lang != null ? { lang, setup: true } : { setup: true },\n    lang,\n    setup: true,\n    type: 'script',\n    loc: {\n      source: '',\n      start: {\n        offset: 0,\n        line: 0,\n        column: 0,\n      },\n      end: {\n        offset: 0,\n        line: 0,\n        column: 0,\n      },\n    },\n  }\n}\n\nfunction addOptionToScriptConfig(\n  version: string,\n  script: SFCScriptBlock,\n  optionsLoc: ComponentInfo['options'],\n  fnSetupOptionLoc: ComponentInfo['fnSetupOption'],\n  apiName: string,\n  name: string,\n  value: string,\n): {\n  renameLocation?: number\n  changes: TS.TextChange[]\n} {\n  const changes: TS.TextChange[] = []\n  let renameLocation: number | undefined\n  if (apiName === '') {\n    const code = genPropertyCode(name, value, 2)\n    if (optionsLoc != null) {\n      const start = optionsLoc.loc.start.offset + 1\n      const newText = getCode(``, `  ${code}`)\n      renameLocation = start + newText.indexOf(code)\n      changes.push({ newText, span: { start: start, length: 0 } })\n    } else if (fnSetupOptionLoc != null) {\n      const setupLoc = fnSetupOptionLoc.loc\n      changes.push(\n        {\n          newText: getCode('{', code, '  setup: '),\n          span: { start: setupLoc.start.offset, length: 0 },\n        },\n        {\n          newText: `\\n}`,\n          span: { start: setupLoc.end.offset, length: 0 },\n        },\n      )\n    } else {\n      const isVue2 = version.startsWith('2.')\n      if (!isVue2) {\n        const hasDefineComponent = /\\bdefineComponent\\b/.test(script.content)\n        if (!hasDefineComponent) {\n          const padding = getPaddingLength(script.content)\n          changes.push({\n            newText: getCode(`import { defineComponent } from 'vue';`, ''),\n            span: { start: script.loc.start.offset + padding, length: 0 },\n          })\n        }\n      }\n      const newText = getCode(\n        '',\n        isVue2 ? `export default {` : `export default defineComponent({`,\n        code,\n        isVue2 ? '}' : `})`,\n        '',\n      )\n      changes.push({\n        span: { start: script.loc.end.offset, length: 0 },\n        newText: newText,\n      })\n    }\n\n    return { changes }\n  }\n\n  const code = genPropertyCode(name, value, 4)\n  if (optionsLoc != null) {\n    const api = optionsLoc.properties[apiName]\n    if (isSimpleIdentifier(optionsLoc.loc.source)) {\n      const start = optionsLoc.loc.start.offset\n      const comma = optionsLoc.loc.source.trimEnd().endsWith(',') ? '' : ','\n      const newText = getCode(\n        `{`,\n        `  ...${optionsLoc.loc.source}${comma}`,\n        `  ${code}`,\n        '},',\n      )\n      renameLocation = start + newText.indexOf(code)\n      changes.push({\n        newText,\n        span: { start: start, length: optionsLoc.loc.source.length },\n      })\n    } else if (api != null) {\n      if (isSimpleIdentifier(api.loc.source)) {\n        const start = api.loc.start.offset\n        const comma = api.loc.source.trimEnd().endsWith(',') ? '' : ','\n        const newText = getCode(\n          `{`,\n          `    ...${api.loc.source}${comma}`,\n          `    ${code}`,\n          '},',\n        )\n        renameLocation = start + newText.indexOf(code)\n        changes.push({\n          newText,\n          span: { start: start, length: api.loc.source.length },\n        })\n      } else {\n        const start = api.loc.start.offset + 1\n        const newText = getCode(``, `    ${code}`)\n        renameLocation = start + newText.indexOf(code)\n        changes.push({ newText, span: { start: start, length: 0 } })\n      }\n    } else {\n      const newText = getCode(`${apiName}: {`, `    ${code}`, `  },`, '  ')\n      const padding = getPaddingLength(optionsLoc.loc.source, 1)\n      const start = optionsLoc.loc.start.offset + padding + 1\n\n      renameLocation = start + padding + newText.indexOf(code)\n      changes.push({ newText, span: { start, length: 0 } })\n    }\n  } else if (fnSetupOptionLoc != null) {\n    const setupLoc = fnSetupOptionLoc.loc\n    const newText = getCode(\n      '{',\n      `  ${apiName}: {`,\n      `    ${code}`,\n      '  },',\n      '  setup: ',\n    )\n    renameLocation = setupLoc.start.offset + newText.indexOf(code)\n    changes.push(\n      {\n        newText,\n        span: { start: setupLoc.start.offset, length: 0 },\n      },\n      {\n        newText: `\\n}`,\n        span: { start: setupLoc.end.offset, length: 0 },\n      },\n    )\n  } else {\n    const isVue2 = version.startsWith('2.')\n    if (!isVue2) {\n      const hasDefineComponent = /\\bdefineComponent\\b/.test(script.content)\n      if (!hasDefineComponent) {\n        const padding = getPaddingLength(\n          script.content,\n          script.loc.start.offset,\n        )\n        changes.push({\n          newText: getCode(`import { defineComponent } from 'vue';`, ''),\n          span: { start: script.loc.start.offset + padding, length: 0 },\n        })\n      }\n    }\n    const newText = getCode(\n      '',\n      isVue2 ? `export default {` : `export default defineComponent({`,\n      `  ${apiName}: {`,\n      `    ${code}`,\n      `  },`,\n      isVue2 ? `}` : `})`,\n      '',\n    )\n    renameLocation = script.loc.end.offset + newText.indexOf(code)\n    changes.push({\n      span: { start: script.loc.end.offset, length: 0 },\n      newText: newText,\n    })\n  }\n\n  return { changes, renameLocation }\n}\n\nfunction addOptionToScriptSetupConfig(\n  scriptSetup: SFCScriptBlock,\n  scriptSetupLoc: ComponentInfo['scriptSetup'] | undefined,\n  apiName: string,\n  name: string,\n  value: string,\n): {\n  renameLocation?: number\n  changes: TS.TextChange[]\n} {\n  let renameLocation: number | undefined\n  const changes: TS.TextChange[] = []\n  if (apiName === 'components' || apiName === 'directives') {\n    // registration is not required.\n  } else if (apiName === 'props') {\n    if (scriptSetupLoc?.defineProps != null) {\n      const props = scriptSetupLoc.defineProps\n      const padding = getPaddingLength(\n        props.loc.source,\n        props.loc.source.indexOf('{'),\n      )\n      changes.push({\n        span: { start: props.loc.start.offset + padding, length: 0 },\n        newText: getCode(`  ${genPropertyCode(name, value, 2)}`, ``),\n      })\n    } else {\n      changes.push({\n        span: {\n          start:\n            scriptSetup.loc.start.offset +\n            getPaddingLength(scriptSetup.content, scriptSetup.loc.start.offset),\n          length: 0,\n        },\n        newText: getCode(\n          `import { defineProps } from 'vue'`,\n          `const props = defineProps({`,\n          `  ${genPropertyCode(name, value, 2)}`,\n          `})`,\n          ``,\n        ),\n      })\n    }\n  } else if (apiName === 'emits') {\n    if (scriptSetupLoc?.defineEmit != null) {\n      const emit = scriptSetupLoc.defineEmit\n      const padding = getPaddingLength(\n        emit.loc.source,\n        emit.loc.source.indexOf('{'),\n      )\n      changes.push({\n        span: { start: emit.loc.start.offset + padding, length: 0 },\n        newText: getCode(`  ${genPropertyCode(name, value, 2)}`, ``),\n      })\n    } else {\n      changes.push({\n        span: {\n          start:\n            scriptSetup.loc.start.offset +\n            getPaddingLength(scriptSetup.content, scriptSetup.loc.start.offset),\n          length: 0,\n        },\n        newText: getCode(\n          `import { defineEmit } from 'vue'`,\n          `const emit = defineEmit({`,\n          `  ${genPropertyCode(name, value, 2)}`,\n          `})`,\n          ``,\n        ),\n      })\n    }\n  } else if (apiName === 'watch') {\n    const hasWatch = /\\bwatch\\b/.test(scriptSetup.content)\n    if (!hasWatch) {\n      changes.push({\n        span: {\n          start:\n            scriptSetup.loc.start.offset +\n            getPaddingLength(scriptSetup.content, scriptSetup.loc.start.offset),\n          length: 0,\n        },\n        newText: getCode(`import { watch } from 'vue'`, ``),\n      })\n    }\n    changes.push({\n      span: { start: scriptSetup.loc.end.offset, length: 0 },\n      newText: getCode(`watch(() => ${name}, ${value})`, ``),\n    })\n  } else if (apiName === 'methods') {\n    const newText = getCode(\n      value.startsWith('function (')\n        ? value.replace(/^function /, `function ${name}`)\n        : `const ${name} = ${value}`,\n      '',\n    )\n\n    renameLocation = scriptSetup.loc.end.offset + newText.indexOf(name)\n\n    changes.push({\n      span: { start: scriptSetup.loc.end.offset, length: 0 },\n      newText,\n    })\n  } else if (apiName === 'computed') {\n    const hasComputed = /\\bcomputed\\b/.test(scriptSetup.content)\n    if (!hasComputed) {\n      changes.push({\n        span: {\n          start:\n            scriptSetup.loc.start.offset +\n            getPaddingLength(scriptSetup.content, scriptSetup.loc.start.offset),\n          length: 0,\n        },\n        newText: getCode(`import { computed } from 'vue'`, ``),\n      })\n    }\n\n    renameLocation = scriptSetup.loc.end.offset + 6 // < length of 'const '\n    changes.push({\n      span: { start: scriptSetup.loc.end.offset, length: 0 },\n      newText: getCode(`const ${name} = computed(${value})`, ``),\n    })\n  } else if (apiName === 'data') {\n    const hasRef = /\\bref\\b/.test(scriptSetup.content)\n    if (!hasRef) {\n      changes.push({\n        span: {\n          start:\n            scriptSetup.loc.start.offset +\n            getPaddingLength(scriptSetup.content, scriptSetup.loc.start.offset),\n          length: 0,\n        },\n        newText: getCode(`import { ref } from 'vue'`, ``),\n      })\n    }\n\n    renameLocation = scriptSetup.loc.end.offset + 6 // < length of 'const '\n    changes.push({\n      span: { start: scriptSetup.loc.end.offset, length: 0 },\n      newText: getCode(`const ${name} = ref(${value})`, ``),\n    })\n  }\n\n  return { changes, renameLocation }\n}\n\nfunction genPropertyCode(\n  name: string,\n  value: string,\n  indentSize: number,\n): string {\n  if (name === value) {\n    return `${name},`\n  } else if (value.trim().startsWith('function (')) {\n    return `${name}${indent(\n      value.replace(/^function /, ''),\n      indentSize,\n      false,\n    )},`\n  } else {\n    return `${name}: ${indent(value, indentSize, false)},`\n  }\n}\n","import type { TS } from '../interfaces'\n\nexport const noop: TS.LanguageService = {\n  toggleLineComment(fileName, textRange) {\n    return []\n  },\n\n  toggleMultilineComment(fileName, textRange) {\n    return []\n  },\n\n  commentSelection(fileName, textRange) {\n    return []\n  },\n\n  uncommentSelection(fileName, textRange) {\n    return []\n  },\n\n  getRenameInfo(fileName, position, options) {\n    return {\n      canRename: false,\n      localizedErrorMessage: 'Not implemented.',\n    }\n  },\n\n  findRenameLocations(fileName, position, findInStrings, findInComments) {\n    return undefined\n  },\n\n  getApplicableRefactors(fileName, positionOrRange, preferences) {\n    return []\n  },\n\n  getBraceMatchingAtPosition(fileName, position) {\n    return []\n  },\n\n  getBreakpointStatementAtPosition(fileName, position) {\n    return undefined\n  },\n\n  getCodeFixesAtPosition(\n    fileName,\n    start,\n    end,\n    errorCodes,\n    formatOptions,\n    preferences,\n  ) {\n    return []\n  },\n\n  getCombinedCodeFix(scope, fixId, formatOptions, preferences) {\n    return {\n      changes: [],\n    }\n  },\n\n  getCompilerOptionsDiagnostics() {\n    return []\n  },\n\n  getCompletionEntryDetails(\n    fileName,\n    position,\n    entryName,\n    formatOptions,\n    source,\n    preferences,\n  ) {\n    return undefined\n  },\n\n  getCompletionEntrySymbol(fileName, position, name, source) {\n    return undefined\n  },\n\n  getCompletionsAtPosition(fileName, position, options) {\n    return undefined\n  },\n\n  getDefinitionAndBoundSpan(fileName, position) {\n    return undefined\n  },\n\n  getDefinitionAtPosition(fileName, position) {\n    return undefined\n  },\n\n  getDocCommentTemplateAtPosition(fileName, position) {\n    return undefined\n  },\n\n  getDocumentHighlights(fileName, position, filesToSearch) {\n    return undefined\n  },\n\n  getEditsForFileRename(oldFilePath, newFilePath, formatOptions, preferences) {\n    return []\n  },\n\n  getEditsForRefactor(\n    fileName,\n    formatOptions,\n    positionOrRange,\n    refactorName,\n    actionName,\n    preferences,\n  ) {\n    return undefined\n  },\n\n  getEmitOutput(fileName) {\n    return { outputFiles: [], emitSkipped: true }\n  },\n\n  getEncodedSemanticClassifications(fileName, span) {\n    return {\n      spans: [],\n      endOfLineState: 0,\n    }\n  },\n\n  getEncodedSyntacticClassifications(fileName, span) {\n    return {\n      spans: [],\n      endOfLineState: 0,\n    }\n  },\n\n  getFormattingEditsAfterKeystroke(fileName, position, key, options) {\n    return []\n  },\n\n  getFormattingEditsForDocument(fileName, options) {\n    return []\n  },\n\n  getFormattingEditsForRange(fileName, start, end, options) {\n    return []\n  },\n\n  getImplementationAtPosition(fileName, position) {\n    return undefined\n  },\n\n  getIndentationAtPosition(fileName, position, options) {\n    return 0\n  },\n\n  getJsxClosingTagAtPosition(fileName, position) {\n    return undefined\n  },\n\n  getNameOrDottedNameSpan(fileName, startPos, endPos) {\n    return undefined\n  },\n\n  getNavigateToItems(searchValue) {\n    return []\n  },\n\n  getNavigationBarItems(fileName) {\n    return []\n  },\n\n  getNavigationTree(fileName) {\n    return {\n      text: '',\n      kind: 'module' as TS.ScriptElementKind.moduleElement,\n      kindModifiers: 'component',\n      spans: [],\n      nameSpan: undefined,\n    }\n  },\n\n  getOccurrencesAtPosition(fileName, position) {\n    return undefined\n  },\n\n  getOutliningSpans(fileName) {\n    return []\n  },\n\n  getQuickInfoAtPosition(fileName, position) {\n    return undefined\n  },\n\n  getReferencesAtPosition(fileName, position) {\n    return undefined\n  },\n\n  getSemanticClassifications(fileName, span) {\n    return []\n  },\n\n  getSemanticDiagnostics(fileName) {\n    return []\n  },\n\n  getSignatureHelpItems(fileName, position, options) {\n    return undefined\n  },\n\n  getSmartSelectionRange(fileName, position) {\n    return {\n      textSpan: { start: position, length: 0 },\n    }\n  },\n\n  getSpanOfEnclosingComment(fileName, position, onlyMultiLine) {\n    return undefined\n  },\n\n  getSuggestionDiagnostics(fileName) {\n    return []\n  },\n\n  getSyntacticClassifications(fileName, span) {\n    return []\n  },\n\n  getSyntacticDiagnostics(fileName) {\n    return []\n  },\n\n  getTodoComments(fileName, descriptors) {\n    return []\n  },\n\n  getTypeDefinitionAtPosition(fileName, position) {\n    return []\n  },\n\n  findReferences(fileName, position) {\n    return undefined\n  },\n\n  prepareCallHierarchy(fileName, position) {\n    return undefined\n  },\n\n  provideCallHierarchyIncomingCalls(fileName, position) {\n    return []\n  },\n\n  provideCallHierarchyOutgoingCalls(fileName, position) {\n    return []\n  },\n\n  isValidBraceCompletionAtPosition(fileName, position, openingBrace) {\n    return false\n  },\n\n  organizeImports(scope, formatOptions, preferences) {\n    return []\n  },\n\n  getProgram() {\n    throw new Error('Not Implemented')\n  },\n\n  cleanupSemanticCache() {\n    throw new Error('Not Implemented')\n  },\n  dispose() {\n    throw new Error('Not Implemented')\n  },\n  applyCodeActionCommand() {\n    return Promise.reject('Not Implemented')\n  },\n}\n","import { wrapObject } from '../helpers/logger'\nimport { TS } from '../interfaces'\nimport { LanguageServiceOptions } from '../types'\nimport { noop } from './noop'\n\nexport function createVirtualLanguageServer(\n  config: LanguageServiceOptions,\n): TS.LanguageService {\n  function removePrefix(fileName: string): string {\n    return fileName.startsWith('^vue:') ? fileName.substr(5) : fileName\n  }\n\n  function choose(fileName: string): TS.LanguageService {\n    return config.helpers.getLanguageServiceFor(fileName, config.service)\n  }\n\n  return wrapObject('VirtualLanguageServer', {\n    ...noop,\n    getQuickInfoAtPosition(rawFileName, position) {\n      const fileName = removePrefix(rawFileName)\n\n      return choose(fileName).getQuickInfoAtPosition(fileName, position)\n    },\n    getSemanticDiagnostics(rawFileName) {\n      const fileName = removePrefix(rawFileName)\n\n      return choose(fileName).getSemanticDiagnostics(fileName)\n    },\n  })\n}\n","import { TS } from '../../interfaces'\nimport { LanguageServiceOptions } from '../../types'\n\nexport type EncodedString<T> = string & { __virtualTypeProperty: T }\n\nexport function encode<T>(value: T): EncodedString<T> {\n  return JSON.stringify(value) as EncodedString<T>\n}\n\nexport function decode<T>(value: EncodedString<T>): T {\n  return JSON.parse(value) as T\n}\n\nexport interface RefactorProvider {\n  version: string\n\n  name: string\n\n  findRefactors: (\n    config: LanguageServiceOptions,\n    fileName: string,\n    position: number | TS.TextRange,\n    preferences?: TS.UserPreferences,\n  ) => TS.ApplicableRefactorInfo[]\n\n  applyRefactor: (\n    config: LanguageServiceOptions,\n    fileName: string,\n    options: TS.FormatCodeSettings,\n    position: number | TS.TextRange,\n    refactorName: string,\n    actionName: string,\n    preferences?: TS.UserPreferences,\n  ) => TS.RefactorEditInfo | undefined\n}\n\nexport const REFACTORS = {\n  EXTRACT_COMPONENT: 'vue:extract-component',\n  EXTRACT_METHOD: 'vue:extract-method',\n  EXTRACT_COMPUTED: 'vue:extract-computed',\n  MOVE_DIRECTIVE_TO_COMPONENT: 'vue:move-directive-to-component',\n  ADD_TO_SETUP_CONTEXT: 'vue:add-to-setup-context',\n}\n","import { isSimpleIdentifier } from '@vuedx/template-ast-types'\nimport { getCode, isTextRangeInSourceRange } from '../../helpers/utils'\nimport { TS } from '../../interfaces'\nimport { RefactorProvider, REFACTORS } from './abstract'\n\nexport const AddToSetupContextRefactor: RefactorProvider = {\n  version: '*',\n\n  name: REFACTORS.ADD_TO_SETUP_CONTEXT,\n\n  findRefactors(\n    { helpers, context, service },\n    fileName,\n    position,\n    preferences,\n  ) {\n    const addToSetupContext: TS.RefactorActionInfo = {\n      name: 'default',\n      description: 'Add to return statement',\n    }\n    const refactor: TS.ApplicableRefactorInfo = {\n      name: REFACTORS.ADD_TO_SETUP_CONTEXT,\n      description: 'Add to return statement',\n      inlineable: true,\n      actions: [addToSetupContext],\n    }\n\n    const document = helpers.getVueDocument(fileName)\n    if (document != null) {\n      const info = helpers.getComponentInfo(document)\n      if (__DEV__) context.debug(`Is position in setup function?`)\n      if (\n        info.fnSetupOption?.return != null &&\n        isTextRangeInSourceRange(position, info.fnSetupOption.loc) &&\n        !isTextRangeInSourceRange(position, info.fnSetupOption.return.loc)\n      ) {\n        const node = helpers.findTypeScriptNodeAtPosition(fileName, position)\n        if (node != null && context.typescript.isIdentifier(node)) {\n          const name = node.text\n\n          if (info.identifierSource[name]?.name === 'setup') {\n            addToSetupContext.notApplicableReason =\n              'Already exists in return statement'\n\n            return [refactor]\n          }\n\n          const parent = helpers.findTypeScriptNodeAtPosition(fileName, {\n            pos: info.fnSetupOption.loc.start.offset,\n            end: info.fnSetupOption.loc.end.offset,\n          })\n\n          if (parent != null) {\n            if (\n              context.typescript.isFunctionExpression(parent) ||\n              context.typescript.isArrowFunction(parent) ||\n              context.typescript.isMethodDeclaration(parent)\n            ) {\n              const program = service.getProgram()\n              if (parent.body != null && program != null) {\n                const checker = program.getTypeChecker()\n                const symbols = checker.getSymbolsInScope(\n                  parent.body,\n                  context.typescript.SymbolFlags.BlockScopedVariable,\n                )\n\n                if (symbols.some((sym) => sym.name === name)) {\n                  addToSetupContext.description = `Add '${name}' to return statement`\n\n                  return [refactor]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n\n    addToSetupContext.notApplicableReason = 'Could not find identifier'\n\n    return [refactor]\n  },\n\n  applyRefactor(\n    { helpers, context, service },\n    fileName,\n    _,\n    position,\n    refactorName,\n    action,\n  ) {\n    if (refactorName !== REFACTORS.ADD_TO_SETUP_CONTEXT) return\n    const changes: TS.TextChange[] = []\n    const document = helpers.getVueDocument(fileName)\n    if (document != null) {\n      const info = helpers.getComponentInfo(document)\n      if (info.fnSetupOption?.return != null) {\n        const node = helpers.findTypeScriptNodeAtPosition(fileName, position)\n        if (node != null && context.typescript.isIdentifier(node)) {\n          const loc = info.fnSetupOption.return.loc\n\n          if (isSimpleIdentifier(loc.source)) {\n            changes.push({\n              newText: getCode(\n                `{`,\n                `    ...${loc.source.trim()}`,\n                `    ${node.text},`,\n                `}`,\n              ),\n              span: { start: loc.start.offset, length: loc.source.length },\n            })\n          } else {\n            if (loc.source.includes('\\n')) {\n              changes.push({\n                newText: getCode(``, `      ${node.text},`),\n                span: {\n                  start: loc.start.offset + 1,\n                  length: 0,\n                },\n              })\n            } else {\n              changes.push({\n                newText: getCode(` ${node.text},`),\n                span: {\n                  start: loc.start.offset + 1,\n                  length: 0,\n                },\n              })\n            }\n          }\n        }\n      }\n      return {\n        edits: [\n          {\n            fileName: document.fsPath,\n            textChanges: changes,\n          },\n        ],\n      }\n    }\n  },\n}\n","import {\n  ComponentInfo,\n  ImportSourceWithLocation,\n  VueProject,\n} from '@vuedx/analyze'\nimport { ProjectConfigNormalized } from '@vuedx/projectconfig'\nimport { findNextSibling, first, last, getComponentName } from '@vuedx/shared'\nimport {\n  createSimpleExpression,\n  ElementNode,\n  findTemplateChildrenInRange,\n  isComponentNode,\n  isDirectiveNode,\n  isElementNode,\n  isSimpleExpressionNode,\n  isSimpleIdentifier,\n  Node,\n  RootNode,\n  stringify,\n  traverseFast,\n} from '@vuedx/template-ast-types'\nimport {\n  RenderFunctionTextDocument,\n  VueTextDocument,\n} from '@vuedx/vue-virtual-textdocument'\nimport Path from 'path'\nimport { PluginContext } from '../../context'\nimport { getFilenameForNewComponent } from '../../helpers/utils'\nimport { TS } from '../../interfaces'\nimport { registerLocalComponentWithSource } from '../../transforms/registerLocalComponent'\nimport {\n  decode,\n  encode,\n  EncodedString,\n  RefactorProvider,\n  REFACTORS,\n} from './abstract'\n\n/// <reference types=\"@vuedx/compiler-tsx\" />\n\ninterface ExtractComponentArgs {\n  directory: string\n}\n\ntype ExtractComponentAction = EncodedString<ExtractComponentArgs>\n\nexport const RefactorExtractComponent: RefactorProvider = {\n  version: '*',\n  name: REFACTORS.EXTRACT_COMPONENT,\n  findRefactors({ helpers, context }, fileName, position) {\n    const extractInCurrentDirectory: TS.RefactorActionInfo = {\n      name: encode<ExtractComponentArgs>({ directory: '.' }),\n      description: 'Extract to component in current directory',\n    }\n\n    const refactor: TS.ApplicableRefactorInfo = {\n      name: REFACTORS.EXTRACT_COMPONENT,\n      description: 'Extract to component',\n      inlineable: true,\n      actions: [extractInCurrentDirectory],\n    }\n\n    // Check if refactor can be applied\n    const document = helpers.getDocumentAt(fileName, position)\n    if (helpers.isRenderFunctionDocument(document)) {\n      const nodes = findNodes(document, position)\n      if (nodes.length === 0) {\n        extractInCurrentDirectory.notApplicableReason = 'No active selection'\n      } else if (document.ast != null && nodes.length > 1) {\n        const parent = findParentNode(document.ast, nodes)\n        if (isElementNode(parent)) {\n          if (detectConditionType(parent, nodes) === 'partial') {\n            extractInCurrentDirectory.notApplicableReason =\n              'Partial v-if/v-else-if/v-else tags cannot be extracted'\n          }\n        }\n      }\n    } else {\n      extractInCurrentDirectory.notApplicableReason =\n        'Only supported in template block'\n    }\n\n    // Load project component directories.\n    const project = context.getVueProjectForFile(fileName, true)\n    project.config.preferences.componentsDirectories.forEach((directory) => {\n      refactor.actions.push({\n        name: encode<ExtractComponentArgs>({ directory }),\n        description: `Extract to component in \"${directory}\" directory`,\n        notApplicableReason: extractInCurrentDirectory.notApplicableReason,\n      })\n    })\n\n    // TODO: Add options to extract including v-if/v-for on root node.\n\n    if (refactor.actions.length > 4) {\n      refactor.inlineable = false\n    }\n\n    return [refactor]\n  },\n  applyRefactor(config, fileName, _, position, refactorName, actionName) {\n    if (refactorName !== REFACTORS.EXTRACT_COMPONENT) return\n    const { helpers, context } = config\n    const args = decode(actionName as ExtractComponentAction)\n    const document = helpers.getRenderDoc(fileName)\n    if (document?.ast == null) return\n\n    // Resolved target directory.\n    const project = context.getVueProjectForFile(fileName, true)\n    const directoryName =\n      args.directory === '.'\n        ? Path.posix.dirname(fileName)\n        : Path.posix.resolve(project.rootDir, args.directory)\n\n    // Pick a placeholder component name.\n    const info = helpers.getComponentInfo(document.container)\n    const componentFileName = getFilenameForNewComponent(\n      config.context,\n      directoryName,\n      new Set(info.components.map((component) => component.name)),\n    )\n\n    const nodes = findNodes(document, position)\n\n    // Known identifiers.\n    const rawIdentifiers = new Set(\n      nodes.flatMap((node) => node.scope.identifiers),\n    )\n\n    // Collection of nodes that should be replaced when generating code of new component.\n    const replaceNodes = new Map<Node, null | Node>()\n    const addSkipNodes = (skipped: Node[], all: Node[]): void => {\n      skipped.forEach((node) => {\n        replaceNodes.set(node, null)\n        node.scope.identifiers.forEach((id) => rawIdentifiers.delete(id))\n      })\n      all.forEach((prop) => {\n        if (!replaceNodes.has(prop)) {\n          prop.scope.identifiers.forEach((id) => rawIdentifiers.add(id))\n        }\n      })\n    }\n\n    // Detect how to process conditional directives.\n    const parent = findParentNode(document.ast, nodes)\n    const conditionType = detectConditionType(parent, nodes) // TODO: Provide choice to user.\n    if (conditionType === 'preserve') {\n      nodes.forEach((node) => {\n        if (isElementNode(node)) {\n          addSkipNodes(\n            node.props.filter(\n              (prop) =>\n                isDirectiveNode(prop) && /^(if|else-if|else)$/.test(prop.name),\n            ),\n            [...node.props, ...node.children],\n          )\n        }\n      })\n    }\n\n    // For single element node extracts, for look can be preserved.\n    if (nodes.length === 1) {\n      const el = first(nodes)\n      if (isElementNode(el)) {\n        const forNode = el.props.find(\n          (prop) => isDirectiveNode(prop) && prop.name === 'for',\n        )\n\n        if (forNode != null) {\n          addSkipNodes([forNode], [...el.props, ...el.children])\n        }\n      }\n    }\n\n    // Find components, v-model and v-emit.\n    const components = new Set<string>()\n    const models = new Set<string>()\n    const emits = new Map<string, string>()\n    nodes.forEach((node) =>\n      traverseFast(node, (node) => {\n        if (isComponentNode(node)) components.add(node.tag)\n        else if (isDirectiveNode(node)) {\n          if (isSimpleExpressionNode(node.exp)) {\n            if (node.name === 'model') {\n              node.exp.scope.globals.forEach((identifier) => {\n                models.add(identifier)\n                rawIdentifiers.delete(identifier)\n              })\n            } else if (node.name === 'on') {\n              if (isSimpleIdentifier(node.exp.content.trim())) {\n                const name = node.exp.content.trim()\n                addSkipNodes([node.exp], [])\n                replaceNodes.set(\n                  node.exp,\n                  createSimpleExpression(`$emit('${name}')`, false),\n                )\n\n                emits.set(name, name)\n              }\n            }\n          }\n        }\n      }),\n    )\n\n    // Generate template for new component\n    const identifiers = Array.from(rawIdentifiers)\n    const script: string[] = []\n\n    if (project.config.preferences.script.mode === 'normal') {\n      // Generate options for new component\n      const options = {\n        components: genComponentsOptionsText({\n          info,\n          addImport: (text) => script.push(text),\n          fileName,\n          components,\n          componentFileName,\n        }),\n        props: genPropsOptionsText({ identifiers, models }),\n        emits: genEmitsOptionsText({ emits, models }),\n      }\n\n      const optionsText = Array.from(Object.values(options))\n        .filter(Boolean)\n        .map((line) => '  ' + line)\n        .join('\\n')\n\n      if (optionsText !== '') {\n        if (project.version.startsWith('2.')) {\n          script.push(`export default {\\n${optionsText}\\n}`)\n        } else {\n          script.unshift(`import { defineComponent } from 'vue'`)\n          script.push(`export default defineComponent({\\n${optionsText}\\n})`)\n        }\n      }\n    } else {\n      // We don't need to register components in <script setup> mode, so reusing\n      // components option generation but rejecting output and keeping only imports.\n      genComponentsOptionsText({\n        info,\n        addImport: (text) => script.push(text),\n        fileName,\n        components,\n        componentFileName,\n      })\n\n      // TODO: Generate props/emits in object syntax with types maybe.\n      const vueImports: string[] = []\n      if (identifiers.length > 0 || models.size > 0) {\n        vueImports.push('defineProps')\n        script.push(\n          `const props = defineProps(${genProps(context, [\n            ...identifiers,\n            ...models,\n          ])})`,\n        )\n      }\n\n      if (emits.size > 0 || models.size > 0) {\n        vueImports.push('defineEmit')\n        const text = genEmits(\n          context,\n          Array.from(emits.keys()),\n          Array.from(models),\n        )\n\n        script.push(`const emit = defineEmit(${text})`)\n      }\n\n      if (vueImports.length > 0) {\n        script.unshift(`import { ${vueImports.join(', ')} } from 'vue'`)\n      }\n    }\n\n    const sfc: string[] = []\n    if (script.length > 0) {\n      sfc.push(\n        getScriptStartTag(project.config.preferences.script),\n        ...script,\n        `</script>\\n`,\n      )\n    }\n\n    sfc.push(\n      `<template>${stringify(nodes, {\n        indent: 2,\n        initialIndent: 1,\n        directive: project.config.preferences.template.directiveSyntax,\n        replaceNodes,\n      })}</template>\\n`,\n    )\n\n    // Generate text changes to import newly created component.\n    const code = sfc.join('\\n')\n    const { name, changes, renameLocation } = getImportEditForComponent(\n      document.container,\n      info,\n      componentFileName,\n      project,\n    )\n\n    // Generate text changes to use newly created component in <template> of current component.\n    const templateReplacement = {\n      newText: genTagForExtractedComponent({\n        name,\n        project,\n        emits,\n        models,\n        identifiers,\n        replaceNodes,\n      }),\n      span: {\n        start: first(nodes).loc.start.offset,\n        length: last(nodes).loc.end.offset - first(nodes).loc.start.offset,\n      },\n    }\n\n    changes.push(templateReplacement)\n    config.context.createVueDocument(componentFileName, code)\n\n    return {\n      renameFilename: document.container.fsPath,\n      renameLocation: renameLocation,\n      edits: [\n        {\n          isNewFile: true,\n          fileName: componentFileName,\n          textChanges: [\n            {\n              span: {\n                start: 0,\n                length: 0,\n              },\n              newText: code,\n            },\n          ],\n        },\n        {\n          fileName: document.container.fsPath,\n          textChanges: changes,\n        },\n      ],\n    }\n  },\n}\n\nfunction genEmits(\n  context: PluginContext,\n  emits: string[],\n  models: string[],\n): string {\n  return `[${[...emits, ...models.map((id) => `onUpdate:${id}`)]\n    .map((key) => `'${key}'`)\n    .join(', ')}]`\n}\n\nfunction genProps(context: PluginContext, identifiers: string[]): string {\n  return `[${identifiers.map((id) => `'${id}'`).join(', ')}]`\n}\n\nfunction genTagForExtractedComponent({\n  name,\n  project,\n  emits,\n  models,\n  identifiers,\n  replaceNodes,\n}: {\n  name: string\n  project: VueProject\n  emits: Map<string, string>\n  models: Set<string>\n  identifiers: string[]\n  replaceNodes: Map<Node, Node | null>\n}): string {\n  const useShorthand =\n    project.config.preferences.template.directiveSyntax === 'shorthand'\n  const skipNodes = new Set<Node>()\n  replaceNodes.forEach((value, key) => {\n    if (value == null) skipNodes.add(key)\n  })\n  const skipNodesTemplate = Array.from(skipNodes)\n    .map((node) =>\n      stringify(node, {\n        indent: 2,\n        initialIndent: 0,\n        directive: project.config.preferences.template.directiveSyntax,\n      }),\n    )\n    .join(' ')\n  const modelsTemplate = Array.from(models)\n    .map((id) => `v-model:${id}=\"${id}\"`)\n    .join(' ')\n\n  const vOnDirText = useShorthand ? '@' : 'v-on:'\n  const vBindDirText = useShorthand ? ':' : 'v-bind:'\n\n  const emitsTemplate = Array.from(emits.entries())\n    .map(([key, value]) => `${vOnDirText}${key}=\"${value}\"`)\n    .join(' ')\n\n  const bindsTemplate = identifiers\n    .map((id) => `${vBindDirText}${id}=\"${id}\"`)\n    .join(' ')\n\n  const openTag = [\n    name,\n    skipNodesTemplate,\n    modelsTemplate,\n    emitsTemplate,\n    bindsTemplate,\n  ]\n    .filter(Boolean)\n    .join(' ')\n\n  return `<${openTag} />`\n}\n\nfunction genEmitsOptionsText({\n  emits,\n  models,\n}: {\n  emits: Map<string, string>\n  models: Set<string>\n}): string {\n  const text = [\n    ...emits.keys(),\n    ...Array.from(models).map((id) => `onUpdate:${id}`),\n  ]\n    .map((key) => `'${key}'`)\n    .join(', ')\n\n  return text !== '' ? `emits: [${text}],` : ''\n}\n\nfunction genPropsOptionsText({\n  identifiers,\n  models,\n}: {\n  identifiers: string[]\n  models: Set<string>\n}): string {\n  const text = [...identifiers, ...models].map((id) => `'${id}'`).join(', ')\n  return text !== '' ? `props: [${text}],` : ''\n}\n\nfunction genComponentsOptionsText({\n  components,\n  info,\n  addImport,\n  fileName,\n  componentFileName,\n}: {\n  info: ComponentInfo\n  addImport(text: string): void\n  fileName: string\n  componentFileName: string\n  components: Set<string>\n}): string {\n  const text = info.components\n    .map(({ name, source, aliases }) => {\n      if (aliases.some((alias) => components.has(alias))) {\n        addImport(genComponentImport(fileName, componentFileName, source))\n        const registration =\n          name === source.localName\n            ? source.localName\n            : `${name}: ${source.localName}`\n\n        return registration\n      }\n    })\n    .filter(Boolean)\n    .join(', ')\n\n  return text !== '' ? `components: {${text}},` : ''\n}\n\nfunction genComponentImport(\n  oldFileName: string,\n  newFileName: string,\n  source: ImportSourceWithLocation,\n): string {\n  let moduleName = source.moduleName\n\n  if (moduleName.startsWith('.')) {\n    moduleName = Path.posix.relative(\n      Path.posix.dirname(newFileName),\n      Path.posix.resolve(Path.posix.dirname(oldFileName), moduleName),\n    )\n\n    if (!moduleName.startsWith('.')) {\n      moduleName = `./${moduleName}`\n    }\n  }\n\n  return `import ${\n    source.exportName != null\n      ? `{ ${\n          source.localName === source.exportName\n            ? ``\n            : `${source.exportName} as `\n        }${source.localName} }`\n      : `${source.localName}`\n  } from '${moduleName}'`\n}\n\nfunction detectConditionType(\n  parent: ElementNode | RootNode,\n  nodes: Node[],\n): 'none' | 'extract' | 'preserve' | 'partial' {\n  const conditions = nodes.map((node) => {\n    if (isElementNode(node)) {\n      return node.props.find(\n        (prop) =>\n          isDirectiveNode(prop) && /^(if|else-if|else)$/.test(prop.name),\n      )\n    }\n  })\n\n  const nonNullConditions = conditions.filter((condition) => condition != null)\n\n  if (nonNullConditions.length > 0) {\n    if (conditions.length === 1) return 'preserve'\n\n    const firstCondition = first(conditions)\n    const lastCondition = last(conditions)\n    if (\n      (firstCondition == null || firstCondition.name === 'if') &&\n      (lastCondition == null || lastCondition.name === 'else')\n    ) {\n      return 'extract'\n    }\n\n    if (firstCondition != null && firstCondition.name !== 'if') return 'partial'\n    const nextSibling = findNextSibling(parent.children, last(nodes))\n    const nextCondition = isElementNode(nextSibling)\n      ? nextSibling.props.find(\n          (prop) => isDirectiveNode(prop) && /^(else-if|else)$/.test(prop.name),\n        )\n      : undefined\n\n    if (nextCondition == null) return 'extract'\n\n    return 'partial'\n  } else {\n    return 'none'\n  }\n}\n\nfunction getScriptStartTag(\n  preferences: ProjectConfigNormalized['preferences']['script'],\n): string {\n  return preferences.mode === 'normal'\n    ? preferences.language !== 'js'\n      ? `<script lang=${JSON.stringify(preferences.language)}>`\n      : `<script>`\n    : preferences.language !== 'js'\n    ? `<script lang=${JSON.stringify(preferences.language)} setup>`\n    : `<script setup>`\n}\n\nfunction findNodes(\n  document: RenderFunctionTextDocument,\n  position: number | TS.TextRange,\n): Node[] {\n  return document.ast != null\n    ? typeof position === 'number'\n      ? findTemplateChildrenInRange(document.ast, position, position)\n      : findTemplateChildrenInRange(document.ast, position.pos, position.end)\n    : []\n}\n\nfunction findParentNode(ast: RootNode, nodes: Node[]): ElementNode | RootNode {\n  if (nodes.length === 0) return ast\n\n  const search = nodes[0]\n  let result: ElementNode | undefined\n\n  traverseFast(ast, (node, _, stop) => {\n    if (isElementNode(node)) {\n      if (node.children.includes(search as any)) {\n        result = node\n        stop()\n      }\n    }\n  })\n\n  return result ?? ast\n}\n\nfunction getImportEditForComponent(\n  document: VueTextDocument,\n  info: ComponentInfo,\n  fileName: string,\n  project: VueProject,\n): {\n  name: string\n  changes: TS.TextChange[]\n  renameLocation: number\n} {\n  const name = getComponentName(fileName)\n  const { script, scriptSetup } = document.descriptor\n  const relativeFileName = `./${Path.posix.relative(\n    Path.posix.dirname(document.fsPath),\n    fileName,\n  )}`\n  const importStatement = `import ${name} from '${relativeFileName}';\\n`\n  let renameLocation =\n    importStatement.indexOf(relativeFileName) + relativeFileName.length - 3\n  const changes = registerLocalComponentWithSource(\n    document,\n    info,\n    { moduleName: relativeFileName, localName: name },\n    project.config.preferences.script,\n    project.version,\n    importStatement,\n  )\n\n  if (scriptSetup != null) {\n    renameLocation += scriptSetup.loc.start.offset\n  } else if (script != null) {\n    renameLocation += script.loc.start.offset\n  } else {\n    renameLocation += changes[0].newText.indexOf(importStatement)\n  }\n\n  return { name, changes, renameLocation }\n}\n","import { ComponentInfo } from '@vuedx/analyze'\nimport * as t from '@vuedx/template-ast-types'\nimport { VueTextDocument } from '@vuedx/vue-virtual-textdocument'\nimport { getScriptFileName } from './utils'\nimport { TS } from '../interfaces'\n\nexport function detectRefsAndProps(\n  service: TS.LanguageService,\n  document: VueTextDocument,\n  info: ComponentInfo,\n  node: t.Node,\n): { refs: string[]; props: string[] } {\n  const refs: string[] = []\n  const props: string[] = []\n\n  const program = service.getProgram()\n  const sourceFile = program?.getSourceFile(getScriptFileName(document))\n\n  if (program != null && sourceFile != null) {\n    const checker = program.getTypeChecker()\n    const findNodeAt = (\n      start: number,\n      end: number,\n      container: TS.Node = sourceFile,\n    ): TS.Node | undefined => {\n      const node = container\n        .getChildren()\n        .find((node) => node.pos <= start && end <= node.end)\n\n      if (node != null) {\n        if (node.pos === start && node.pos === end) return node\n        else return findNodeAt(start, end, node)\n      } else {\n        return container\n      }\n    }\n\n    node.scope.identifiers.forEach((id) => {\n      if (node.scope.getBinding(id) == null && id in info.identifierSource) {\n        const source = info.identifierSource[id]\n        if (source.name === 'setup' || source.name.startsWith('scriptSetup:')) {\n          const node = findNodeAt(\n            source.loc.start.offset,\n            source.loc.end.offset,\n          )\n          if (node != null) {\n            const type = checker.getTypeAtLocation(node)\n            const str = checker.typeToString(type)\n\n            if (/^(Ref|ComputedRef)<.*?>$/.test(str.trim())) {\n              refs.push(id)\n            }\n          }\n        } else if (source.name === 'props') {\n          props.push(id)\n        }\n      }\n    })\n  }\n\n  return { refs, props }\n}\n","import { ComponentInfo } from '@vuedx/analyze'\nimport * as t from '@vuedx/template-ast-types'\nimport { TS } from '../interfaces'\nimport { getPaddingLength } from './utils'\n\nexport function genSetupFnParams(\n  info: ComponentInfo,\n  node: t.Node,\n): TS.TextChange[] {\n  const changes: TS.TextChange[] = []\n  if (info.fnSetupOption != null) {\n    const needsProps =\n      node.scope.identifiers.some((id) => {\n        if (node.scope.getBinding(id) == null) {\n          return info.identifierSource[id]?.name === 'props'\n        }\n        return false\n      }) && info.fnSetupOption.props?.rest == null\n    const needsEmit =\n      node.scope.identifiers.includes('$emit') &&\n      info.fnSetupOption.context?.identifiers.emit == null &&\n      info.fnSetupOption.context?.rest == null\n    const needsAttrs =\n      node.scope.identifiers.includes('$attrs') &&\n      info.fnSetupOption.context?.identifiers.attrs == null &&\n      info.fnSetupOption.context?.rest == null\n\n    const needsSlots =\n      node.scope.identifiers.includes('$slots') &&\n      info.fnSetupOption.context?.identifiers.slots == null &&\n      info.fnSetupOption.context?.rest == null\n    const needsContext = needsAttrs || needsEmit || needsSlots\n\n    if (needsProps || needsContext) {\n      if (info.fnSetupOption.context != null) {\n        const index = info.fnSetupOption.context.loc.source.indexOf('{')\n        if (index >= 0) {\n          const offset =\n            getPaddingLength(info.fnSetupOption.context.loc.source, index + 1) +\n            index +\n            1\n\n          const args = [\n            needsSlots ? 'slots' : undefined,\n            needsAttrs ? 'attrs' : undefined,\n            needsEmit ? 'emit' : undefined,\n          ]\n            .filter(Boolean)\n            .join(', ')\n\n          changes.push({\n            newText: `${args}, `,\n            span: {\n              start: info.fnSetupOption.context.loc.start.offset + offset,\n              length: 0,\n            },\n          })\n        }\n      } else if (info.fnSetupOption.props != null) {\n        const hasParen =\n          info.fnSetupOption.loc.source.indexOf('(') <\n          info.fnSetupOption.props.loc.start.offset\n        const props = info.fnSetupOption.props.loc.source\n        changes.push({\n          newText: hasParen ? `${props}, context` : `(${props}, context)`,\n          span: {\n            start: info.fnSetupOption.props.loc.start.offset,\n            length: info.fnSetupOption.props.loc.source.length,\n          },\n        })\n      } else {\n        changes.push({\n          newText: needsContext ? 'props, context' : 'props',\n          span: {\n            start:\n              info.fnSetupOption.loc.start.offset +\n              info.fnSetupOption.loc.source.indexOf('(') +\n              1,\n            length: 0,\n          },\n        })\n      }\n    }\n  }\n  return changes\n}\n","import { ComponentInfo } from '@vuedx/analyze'\n\nexport function getContextIdentifiers(\n  info: ComponentInfo,\n): Record<'props' | 'slots' | 'attrs' | 'emit', string> {\n  if (info.fnSetupOption != null) {\n    const { context, props } = info.fnSetupOption\n    if (context?.rest != null) {\n      return {\n        props: props?.rest ?? 'props',\n        slots: context.identifiers.slots ?? `${context.rest}.slots`,\n        attrs: context.identifiers.attrs ?? `${context.rest}.attrs`,\n        emit: context.identifiers.emit ?? `${context.rest}.emit`,\n      }\n    } else if (context != null) {\n      return {\n        props: props?.rest ?? 'props',\n        slots: context?.identifiers.slots ?? `slots`,\n        attrs: context?.identifiers.attrs ?? `attrs`,\n        emit: context?.identifiers.emit ?? `emit`,\n      }\n    } else {\n      return {\n        props: props?.rest ?? 'props',\n        slots: `context.slots`,\n        attrs: `context.attrs`,\n        emit: `context.emit`,\n      }\n    }\n  }\n\n  return {\n    props: 'props',\n    slots: `context.slots`,\n    attrs: `context.attrs`,\n    emit: `context.emit`,\n  }\n}\n","import { transformToFunction } from '@vuedx/analyze'\nimport { last } from '@vuedx/shared'\nimport {\n  isDirectiveNode,\n  isSimpleExpressionNode,\n  isSimpleIdentifier,\n} from '@vuedx/template-ast-types'\nimport { detectRefsAndProps } from '../../helpers/detectRefsAndProps'\nimport { genSetupFnParams } from '../../helpers/genSetupFnParams'\nimport { getContextIdentifiers } from '../../helpers/getContextIdentifiers'\nimport { TS } from '../../interfaces'\nimport { registerComponentAPI } from '../../transforms/registerLocalComponent'\nimport { decode, encode, RefactorProvider, REFACTORS } from './abstract'\ninterface RefactorExtractComputedArgs {\n  target: 'computed' | 'setupComputed'\n}\n\nexport const RefactorExtractComputed: RefactorProvider = {\n  version: '*',\n\n  name: REFACTORS.EXTRACT_COMPUTED,\n\n  findRefactors({ helpers, service }, fileName, position, preferences) {\n    const extractAsComputedProperty: TS.RefactorActionInfo = {\n      name: encode<RefactorExtractComputedArgs>({ target: 'computed' }),\n      description: 'Extract to computed property',\n    }\n    const extractAsComputedValue: TS.RefactorActionInfo = {\n      name: encode<RefactorExtractComputedArgs>({ target: 'setupComputed' }),\n      description: 'Extract to computed value',\n    }\n    const refactor: TS.ApplicableRefactorInfo = {\n      name: REFACTORS.EXTRACT_COMPUTED,\n      description: 'Extract to computed',\n      inlineable: true,\n      actions: [extractAsComputedProperty, extractAsComputedValue],\n    }\n\n    const { node, ancestors, document } = helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n\n    if (document != null && isSimpleExpressionNode(node)) {\n      const parent = last(ancestors).node\n      if (document.container.descriptor.scriptSetup != null) {\n        extractAsComputedProperty.notApplicableReason =\n          extractAsComputedProperty.notApplicableReason ??\n          'Not supported when using <script setup>'\n      } else {\n        const info = helpers.getComponentInfo(document.container)\n        node.scope.identifiers.forEach((id) => {\n          const binding = node.scope.getBinding(id)\n          if (binding != null) {\n            extractAsComputedProperty.notApplicableReason =\n              extractAsComputedProperty.notApplicableReason ??\n              `Expression uses local variables`\n            extractAsComputedValue.notApplicableReason =\n              extractAsComputedValue.notApplicableReason ??\n              `Expression uses local variables`\n          } else {\n            const source = info.identifierSource[id]\n            if (source != null) {\n              if (/^(methods|computed|data)$/.test(source.name)) {\n                extractAsComputedValue.notApplicableReason =\n                  extractAsComputedValue.notApplicableReason ??\n                  `Cannot use ${source.name} from options API in setup() function`\n              }\n            }\n          }\n        })\n      }\n\n      if (isSimpleIdentifier(node.content)) {\n        extractAsComputedProperty.notApplicableReason =\n          extractAsComputedProperty.notApplicableReason ?? 'Already extracted'\n        extractAsComputedValue.notApplicableReason =\n          extractAsComputedValue.notApplicableReason ?? 'Already extracted'\n      } else if (\n        isDirectiveNode(parent) && // Unsupported directives.\n        (parent.name === 'slot' ||\n          parent.name === 'for' ||\n          parent.name === 'on' ||\n          parent.name === 'model')\n      ) {\n        extractAsComputedProperty.notApplicableReason =\n          extractAsComputedProperty.notApplicableReason ??\n          `Not supported in v-${parent.name}`\n        extractAsComputedValue.notApplicableReason =\n          extractAsComputedValue.notApplicableReason ??\n          `Not supported in v-${parent.name}`\n      }\n    } else {\n      extractAsComputedProperty.notApplicableReason =\n        extractAsComputedProperty.notApplicableReason ??\n        'Only expressions can be extracted as computed property'\n      extractAsComputedValue.notApplicableReason =\n        extractAsComputedValue.notApplicableReason ??\n        'Only expressions can be extracted as computed value'\n    }\n\n    if (\n      extractAsComputedProperty.notApplicableReason == null &&\n      helpers.getVueDocument(fileName)?.descriptor.scriptSetup != null\n    ) {\n      extractAsComputedProperty.notApplicableReason =\n        'No supported when using <script setup>'\n    }\n\n    if (\n      typeof position === 'object' &&\n      position.pos !== position.end &&\n      (extractAsComputedProperty.notApplicableReason == null ||\n        extractAsComputedValue.notApplicableReason == null)\n    ) {\n      // TODO: Ensure expression in selected range is actually extractable.\n    }\n\n    return [refactor]\n  },\n\n  applyRefactor(\n    { helpers, context, service },\n    fileName,\n    _,\n    position,\n    refactorName,\n    action,\n  ) {\n    if (refactorName !== REFACTORS.EXTRACT_COMPUTED) return\n    const args = decode<RefactorExtractComputedArgs>(action as any)\n    const document = helpers.getVueDocument(fileName)\n    const { node } = helpers.findTemplateNodeAtPosition(fileName, position)\n\n    if (isSimpleExpressionNode(node) && document !== null) {\n      const project = context.getVueProjectForFile(document.fsPath, true)\n\n      const shouldRewriteContext =\n        args.target === 'computed' && document.descriptor.scriptSetup == null\n\n      let start = node.loc.start.offset\n      let end = node.loc.end.offset\n\n      if (typeof position !== 'number' && position.pos !== position.end) {\n        start = position.pos\n        end = position.end\n      }\n\n      const content = node.content.substring(\n        start - node.loc.start.offset,\n        end - node.loc.start.offset,\n      )\n\n      const info = helpers.getComponentInfo(document)\n      const code = transformToFunction(content, {\n        name: 'anonymous',\n        kind: 'expression',\n        args: [],\n        rewrite: shouldRewriteContext\n          ? { context: 'this' }\n          : {\n              ...detectRefsAndProps(service, document, info, node),\n              identifiers: getContextIdentifiers(info),\n            },\n      })\n\n      const name = 'newComputed'\n      const replaceExp: TS.TextChange = {\n        newText: name,\n        span: {\n          start: start,\n          length: end - start,\n        },\n      }\n\n      const { changes } = registerComponentAPI(\n        document,\n        info,\n        args.target,\n        name,\n        code,\n        project.version,\n        project.config.preferences.script,\n      )\n\n      if (info.fnSetupOption != null) {\n        changes.push(...genSetupFnParams(info, node))\n      }\n\n      return {\n        renameFilename: document.fsPath,\n        renameLocation: start,\n        edits: [\n          {\n            fileName: document.fsPath,\n            textChanges: [...changes, replaceExp],\n          },\n        ],\n      }\n    }\n  },\n}\n","import { transformToFunction } from '@vuedx/analyze'\nimport { last } from '@vuedx/shared'\nimport {\n  isDirectiveNode,\n  isSimpleExpressionNode,\n  isSimpleIdentifier,\n} from '@vuedx/template-ast-types'\nimport { detectRefsAndProps } from '../../helpers/detectRefsAndProps'\nimport { genSetupFnParams } from '../../helpers/genSetupFnParams'\nimport { getContextIdentifiers } from '../../helpers/getContextIdentifiers'\nimport { TS } from '../../interfaces'\nimport { registerComponentAPI } from '../../transforms/registerLocalComponent'\nimport { decode, encode, RefactorProvider, REFACTORS } from './abstract'\n\ninterface RefactorExtractMethodArgs {\n  target: 'methods' | 'setupMethods'\n}\n\nexport const RefactorExtractMethod: RefactorProvider = {\n  version: '*',\n\n  name: REFACTORS.EXTRACT_METHOD,\n\n  findRefactors({ helpers }, fileName, position) {\n    const extractAsMethod: TS.RefactorActionInfo = {\n      name: encode<RefactorExtractMethodArgs>({ target: 'methods' }),\n      description: 'Extract to method',\n    }\n    const extractAsFunction: TS.RefactorActionInfo = {\n      name: encode<RefactorExtractMethodArgs>({ target: 'setupMethods' }),\n      description: 'Extract to function',\n    }\n    const refactor: TS.ApplicableRefactorInfo = {\n      name: REFACTORS.EXTRACT_METHOD,\n      description: 'Extract to function/method',\n      inlineable: true,\n      actions: [extractAsMethod, extractAsFunction],\n    }\n\n    const { node, ancestors, document } = helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n\n    if (document != null && isSimpleExpressionNode(node)) {\n      const parent = last(ancestors).node\n      if (document.container.descriptor.scriptSetup != null) {\n        extractAsMethod.notApplicableReason =\n          extractAsMethod.notApplicableReason ??\n          'Not supported when using <script setup>'\n      } else {\n        const info = helpers.getComponentInfo(document.container)\n        node.scope.identifiers.forEach((id) => {\n          const binding = node.scope.getBinding(id)\n          const source = info.identifierSource[id]\n          if (source != null && binding == null) {\n            if (/^(methods|computed|data)$/.test(source.name)) {\n              extractAsFunction.notApplicableReason =\n                extractAsFunction.notApplicableReason ??\n                `Cannot use ${source.name} from options API in setup() function`\n            }\n          }\n        })\n      }\n\n      if (isSimpleIdentifier(node.content)) {\n        extractAsMethod.notApplicableReason =\n          extractAsMethod.notApplicableReason ?? 'Already extracted'\n        extractAsFunction.notApplicableReason =\n          extractAsFunction.notApplicableReason ?? 'Already extracted'\n      } else if (\n        isDirectiveNode(parent) &&\n        (parent.name === 'slot' || parent.name === 'for')\n      ) {\n        extractAsMethod.notApplicableReason =\n          extractAsMethod.notApplicableReason ??\n          `Not supported in v-${parent.name}`\n        extractAsFunction.notApplicableReason =\n          extractAsFunction.notApplicableReason ??\n          `Not supported in v-${parent.name}`\n      }\n    } else {\n      extractAsMethod.notApplicableReason =\n        extractAsMethod.notApplicableReason ??\n        'Only expressions can be extracted as method'\n      extractAsFunction.notApplicableReason =\n        extractAsFunction.notApplicableReason ??\n        'Only expressions can be extracted as function'\n    }\n\n    if (\n      extractAsMethod.notApplicableReason == null &&\n      helpers.getVueDocument(fileName)?.descriptor.scriptSetup != null\n    ) {\n      extractAsMethod.notApplicableReason =\n        'No supported when using <script setup>'\n    }\n\n    return [refactor]\n  },\n\n  applyRefactor(\n    { helpers, context, service },\n    fileName,\n    _,\n    position,\n    refactorName,\n    action,\n  ) {\n    if (refactorName !== REFACTORS.EXTRACT_METHOD) return\n    const args = decode<RefactorExtractMethodArgs>(action as any)\n    const document = helpers.getVueDocument(fileName)\n    const { node, ancestors } = helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n\n    if (isSimpleExpressionNode(node) && document !== null) {\n      const project = context.getVueProjectForFile(document.fsPath, true)\n      const parent = last(ancestors)?.node\n      const isEventHandler =\n        isDirectiveNode(parent) && parent.name === 'on' && parent.exp === node\n      const shouldRewriteContext =\n        args.target === 'methods' && document.descriptor.scriptSetup == null\n      const methodArgs: string[] = []\n      let shouldCallEventHandler = false\n\n      if (\n        isEventHandler &&\n        /(?<![a-z.[])\\$event(?=[^a-zA-Z0-9_$])/.test(node.content)\n      ) {\n        methodArgs.push('$event')\n      }\n\n      node.scope.identifiers.forEach((id) => {\n        if (node.scope.getBinding(id) != null) {\n          methodArgs.push(id)\n          shouldCallEventHandler = true\n        }\n      })\n\n      const info = helpers.getComponentInfo(document)\n\n      const code = transformToFunction(node.content, {\n        name: 'anonymous',\n        kind: isEventHandler ? 'statement' : 'expression',\n        args: methodArgs,\n        rewrite: shouldRewriteContext\n          ? { context: 'this' }\n          : {\n              ...detectRefsAndProps(service, document, info, node),\n              identifiers: getContextIdentifiers(info),\n            },\n      })\n\n      const name = args.target === 'methods' ? 'newMethod' : 'newFunction'\n      const replaceExp: TS.TextChange = {\n        newText:\n          isEventHandler && !shouldCallEventHandler\n            ? name\n            : `${name}(${methodArgs.join(', ')})`,\n        span: {\n          start: node.loc.start.offset,\n          length: node.loc.end.offset - node.loc.start.offset,\n        },\n      }\n\n      const { changes } = registerComponentAPI(\n        document,\n        info,\n        args.target,\n        name,\n        code,\n        project.version,\n        project.config.preferences.script,\n      )\n\n      if (info.fnSetupOption != null) {\n        changes.push(...genSetupFnParams(info, node))\n      }\n\n      return {\n        renameFilename: document.fsPath,\n        renameLocation: node.loc.start.offset, // TODO: Use `node.loc.start.offset` when renaming it template is supported.\n        edits: [\n          {\n            fileName: document.fsPath,\n            textChanges: [...changes, replaceExp],\n          },\n        ],\n      }\n    }\n  },\n}\n","import { AddToSetupContextRefactor } from './add-to-setup-context'\nimport { RefactorExtractComponent } from './extract-component'\nimport { RefactorExtractComputed } from './extract-computed'\nimport { RefactorExtractMethod } from './extract-method'\n\nexport const REFACTOR_PROVIDERS = [\n  RefactorExtractComponent,\n  RefactorExtractMethod,\n  RefactorExtractComputed,\n]\n\nexport const SCRIPT_REFACTOR_PROVIDERS = [AddToSetupContextRefactor]\n\n/*\n☑︎  1. Extract to component\n☑︎  2. Extract to computed property (full and partial expression)\n☑︎  3. Extract to method (v-on and other expression)\n☑︎  4. Add to return statement in setup() function\n◼︎  5. Move v-if inside component\n☐  6. Convert options API to functional API\n☒  7. Convert <script> to <script setup>\n☒  8. Convert <script setup> to <script>\n☒  9. Convert to ref syntax sugar\n☒ 10. Remove ref syntax sugar\n☐ 11. Convert template to render function\n */\n","import { LocalComponentRegistrationInfo } from '@vuedx/analyze'\nimport { getComponentName } from '@vuedx/shared'\nimport {\n  ComponentNode,\n  isComponentNode,\n  RootNode,\n  traverseFast,\n} from '@vuedx/template-ast-types'\nimport {\n  isVueFile,\n  SCRIPT_BLOCK_SELECTOR,\n  SCRIPT_SETUP_BLOCK_SELECTOR,\n} from '@vuedx/vue-virtual-textdocument'\nimport { computeIdentifierReplacement } from '../../helpers/utils'\nimport { TS } from '../../interfaces'\nimport { RenameProvider } from './abstract'\n\nexport const RenameComponentTag: RenameProvider = {\n  version: '*',\n  name: 'component-tag',\n  canRename(config, fileName, position, options) {\n    const { node, document } = config.helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n    if (\n      isComponentNode(node) &&\n      isPositionInTagName(position, node) &&\n      document != null\n    ) {\n      const info = config.helpers.getComponentInfo(document.container)\n      const name = node.tag\n      const component = info.components.find(\n        (component) => component.name === name,\n      )\n\n      if (component == null) {\n        return {\n          canRename: false,\n          localizedErrorMessage: 'Cannot rename global component',\n        }\n      }\n\n      return {\n        canRename: true,\n        displayName: node.tag,\n        fullDisplayName: node.tag,\n        kind: config.context.typescript.ScriptElementKind.unknown,\n        kindModifiers: 'componentTagName',\n        fileToRename: undefined,\n        triggerSpan: {\n          start: node.loc.start.offset + 1,\n          length: node.tag.length,\n        },\n      }\n    }\n  },\n  applyRename(\n    { helpers, service },\n    fileName,\n    position,\n    findInStrings,\n    findInComments,\n  ) {\n    const { node, document } = helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n\n    if (document == null) return\n    if (!isComponentNode(node)) return\n\n    const info = helpers.getComponentInfo(document.container)\n    const name = node.tag\n    const component = info.components.find(\n      (component) => component.name === name,\n    )\n    if (component == null) return\n\n    const scriptFileName =\n      document.container.descriptor.scriptSetup != null\n        ? document.container.getDocumentFileName(SCRIPT_SETUP_BLOCK_SELECTOR)\n        : document.container.getDocumentFileName(SCRIPT_BLOCK_SELECTOR)\n\n    const renameLocations: TS.RenameLocation[] = []\n    // if component is registered with an alias, then update to reflect in template.\n    if (component.source.localName !== component.name) {\n      renameLocations.push({\n        fileName: document.container.fsPath,\n        textSpan: {\n          start: component.loc.start.offset,\n          length: component.loc.source.length,\n        },\n        ...computeIdentifierReplacement(component.loc.source, component.name),\n      })\n    }\n    // update the import statement.\n    else {\n      const { prefixText } = computeIdentifierReplacement(\n        component.loc.source,\n        component.source.localName,\n      )\n\n      const locations = service.findRenameLocations(\n        scriptFileName,\n        component.loc.start.offset + prefixText.length,\n        findInStrings,\n        findInComments,\n      )\n      if (locations != null) {\n        renameLocations.push(\n          ...locations.filter(\n            (location) => location.fileName === scriptFileName,\n          ),\n        )\n      }\n    }\n\n    if (document.ast != null) {\n      getChangesForComponentTagRename(document.ast, component).forEach(\n        (textSpan) =>\n          renameLocations.push({\n            fileName: document.container.fsPath,\n            textSpan,\n          }),\n      )\n    }\n\n    return renameLocations\n  },\n  applyFileRename(\n    config,\n    containerFile,\n    oldFileName,\n    newFileName,\n    options,\n    preferences,\n  ) {\n    const fileTextChanges: TS.FileTextChanges[] = []\n    if (isVueFile(oldFileName)) {\n      const document = config.helpers.getRenderDoc(containerFile)\n\n      if (document != null) {\n        const name = getComponentName(oldFileName)\n        const newName = getComponentName(newFileName)\n        const info = config.helpers.getComponentInfo(document.container)\n        const component = info.components.find(\n          (component) => component.name === name,\n        )\n\n        if (component != null) {\n          const { scriptSetup, script } = document.container.descriptor\n          const scriptFileName =\n            scriptSetup != null\n              ? document.container.getDocumentFileName('scriptSetup')\n              : script != null\n              ? document.container.getDocumentFileName('script')\n              : null\n\n          if (scriptFileName != null) {\n            const position = Math.max(\n              component.loc.end.offset - 2,\n              component.loc.start.offset,\n            )\n\n            const renameInfo = config.service.getRenameInfo(\n              scriptFileName,\n              position,\n            )\n\n            if (renameInfo.canRename) {\n              const edits = config.service.findRenameLocations(\n                scriptFileName,\n                position,\n                false,\n                false,\n              )\n              if (edits != null) {\n                const fileName = document.container.fsPath\n                fileTextChanges.push({\n                  fileName: fileName,\n                  textChanges: edits\n                    .filter((edit) => edit.fileName === scriptFileName)\n                    .map((edit) => ({ span: edit.textSpan, newText: newName })),\n                })\n              }\n            }\n\n            // update tags in template\n            if (\n              document.ast != null &&\n              name === component.source.localName &&\n              component.name === component.source.localName\n            ) {\n              const textChanges: TS.TextChange[] = []\n              if (component.loc.source.trim() !== name) {\n                // Rename alias in components options\n                textChanges.push({\n                  span: {\n                    start: component.loc.start.offset,\n                    length: component.loc.source.indexOf(':'),\n                  },\n                  newText: newName,\n                })\n              }\n\n              traverseFast(document.ast, (node) => {\n                if (isComponentNode(node)) {\n                  if (component.aliases.includes(node.tag)) {\n                    textChanges.push({\n                      newText: newName,\n                      span: {\n                        start: node.loc.start.offset + 1,\n                        length: node.tag.length,\n                      },\n                    })\n\n                    if (!node.isSelfClosing) {\n                      textChanges.push({\n                        newText: newName,\n                        span: {\n                          start:\n                            node.loc.start.offset +\n                            node.loc.source.lastIndexOf('</' + node.tag) +\n                            2,\n                          length: node.tag.length,\n                        },\n                      })\n                    }\n                  }\n                }\n              })\n\n              fileTextChanges.push({\n                fileName: document.container.fsPath,\n                textChanges: textChanges,\n              })\n            }\n          }\n        }\n      }\n    }\n    if (fileTextChanges.length > 0) return fileTextChanges\n  },\n}\n\nexport function getChangesForComponentTagRename(\n  ast: RootNode,\n  component: LocalComponentRegistrationInfo,\n): TS.TextSpan[] {\n  const locations: TS.TextSpan[] = []\n  traverseFast(ast, (node) => {\n    if (isComponentNode(node)) {\n      if (component.aliases.includes(node.tag)) {\n        locations.push({\n          start: node.loc.start.offset + 1,\n          length: node.tag.length,\n        })\n\n        if (!node.isSelfClosing) {\n          locations.push({\n            start:\n              node.loc.start.offset +\n              node.loc.source.lastIndexOf('</' + node.tag) +\n              2,\n            length: node.tag.length,\n          })\n        }\n      }\n    }\n  })\n  return locations\n}\n\nfunction isPositionInTagName(position: number, node: ComponentNode): boolean {\n  return (\n    // In start tag.\n    position <= node.loc.start.offset + node.tag.length ||\n    // In end tag.\n    (!node.isSelfClosing &&\n      node.loc.start.offset + node.loc.source.lastIndexOf('</') <= position)\n  )\n}\n","import { TS } from '../../interfaces'\nimport { LanguageServiceOptions } from '../../types'\n\nexport interface CompletionProvider {\n  name: string\n  version: string\n\n  getCompletionsAtPosition(\n    context: LanguageServiceOptions,\n    fileName: string,\n    position: number,\n    options: TS.GetCompletionsAtPositionOptions | undefined,\n  ): TS.WithMetadata<TS.CompletionInfo> | undefined\n\n  getCompletionEntryDetails(\n    context: LanguageServiceOptions,\n    fileName: string,\n    position: number,\n    entryName: string,\n    formatOptions: TS.FormatCodeOptions | TS.FormatCodeSettings | undefined,\n    source: string | undefined,\n    preferences: TS.UserPreferences | undefined,\n  ): TS.CompletionEntryDetails | undefined\n\n  getCompletionEntrySymbol(\n    context: LanguageServiceOptions,\n    fileName: string,\n    position: number,\n    name: string,\n    source: string | undefined,\n  ): TS.Symbol | undefined\n}\n\nexport function defineCompletionProvider(\n  options: CompletionProvider,\n): CompletionProvider {\n  return options\n}\n","import { isNotNull } from '@vuedx/shared'\nimport { isSimpleExpressionNode } from '@vuedx/template-ast-types'\nimport { defineCompletionProvider } from './abstract'\n\nexport const TemplateContextCompletionProvider = defineCompletionProvider({\n  name: 'context expression',\n  version: '*',\n\n  getCompletionsAtPosition(\n    { helpers, service, context },\n    fileName,\n    position,\n    options,\n  ) {\n    const { node, document } = helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n\n    if (\n      isNotNull(document) &&\n      isSimpleExpressionNode(node) &&\n      options?.triggerCharacter !== '.' // Not a member expression\n    ) {\n      context.debug('TemplateContext Completion')\n      const result = service.getCompletionsAtPosition(\n        document.fsPath,\n        document.contextCompletionsTriggerOffset,\n        {\n          ...options,\n          triggerCharacter: '.',\n          includeAutomaticOptionalChainCompletions: true,\n          includeCompletionsForModuleExports: false,\n          includeCompletionsWithInsertText: true,\n          includePackageJsonAutoImports: 'off',\n          provideRefactorNotApplicableReason: false,\n          disableSuggestions: true,\n        },\n      )\n\n      if (isNotNull(result)) {\n        result.entries.filter((entry) => {\n          if (entry.name.startsWith('$')) {\n            entry.sortText = '9'\n          }\n\n          return entry.name.startsWith('_')\n        })\n      }\n\n      return result\n    }\n\n    return undefined\n  },\n\n  getCompletionEntryDetails(\n    { helpers, service },\n    fileName,\n    position,\n    entryName,\n    formatOptions,\n    source,\n    preferences,\n  ) {\n    const { node, document } = helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n\n    if (isNotNull(document) && isSimpleExpressionNode(node)) {\n      return service.getCompletionEntryDetails(\n        document.fsPath,\n        document.contextCompletionsTriggerOffset,\n        entryName,\n        formatOptions,\n        source,\n        preferences,\n      )\n    }\n\n    return undefined\n  },\n\n  getCompletionEntrySymbol(\n    { helpers, service },\n    fileName,\n    position,\n    name,\n    source,\n  ) {\n    const { node, document } = helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n\n    if (isNotNull(document) && isSimpleExpressionNode(node)) {\n      return service.getCompletionEntrySymbol(\n        document.fsPath,\n        document.contextCompletionsTriggerOffset,\n        name,\n        source,\n      )\n    }\n\n    return undefined\n  },\n})\n","import { isNotNull } from '@vuedx/shared'\nimport { isSimpleExpressionNode } from '@vuedx/template-ast-types'\nimport { defineCompletionProvider } from './abstract'\n\nconst disallowedIdentifiers = new Set([\n  'arguments',\n  'globalThis',\n  'default',\n  '_ctx',\n])\nconst allowedGlobals = new Set([\n  'Infinity',\n  'undefined',\n  'NaN',\n  'isFinite',\n  'isNaN',\n  'parseFloat',\n  'parseInt',\n  'decodeURI',\n  'decodeURIComponent',\n  'encodeURI',\n  'encodeURIComponent',\n  'Math',\n  'Number',\n  'Date',\n  'Array',\n  'Object',\n  'Boolean',\n  'String',\n  'RegExp',\n  'Map',\n  'Set',\n  'JSON',\n  'Intl',\n])\n\nconst allowedKeywords = new Set([\n  'function',\n  'return',\n  'true',\n  'false',\n  'null',\n  'typeof',\n  'instanceof',\n  'async',\n  'await',\n  'new',\n])\n\nexport const TemplateExpressionCompletionProvider = defineCompletionProvider({\n  name: 'expression',\n  version: '*',\n\n  getCompletionsAtPosition(\n    { helpers, service, context },\n    fileName,\n    position,\n    options,\n  ) {\n    const { node, document } = helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n\n    if (isNotNull(document) && isSimpleExpressionNode(node)) {\n      const loc = document.tryGetGeneratedOffset(position)\n      if (isNotNull(loc)) {\n        if (__DEV__) context.debug('TemplateExpression Completion')\n        const result = service.getCompletionsAtPosition(\n          document.fsPath,\n          loc,\n          options,\n        )\n\n        if (isNotNull(result)) {\n          const isPropertyCompletion = options?.triggerCharacter === '.'\n          result.entries = result.entries.filter((entry) => {\n            if (isNotNull(entry.source)) return false // Ignore externals.\n            if (disallowedIdentifiers.has(entry.name)) return false\n            if (entry.kind === 'keyword') {\n              return allowedKeywords.has(entry.name)\n            }\n            if (isPropertyCompletion) return true\n            if (\n              entry.kind === 'var' ||\n              entry.kind === 'module' ||\n              entry.kind === 'function'\n            ) {\n              return allowedGlobals.has(entry.name)\n            }\n\n            return false\n          })\n        }\n\n        return result\n      }\n    }\n\n    return undefined\n  },\n\n  getCompletionEntryDetails(\n    { helpers, service },\n    fileName,\n    position,\n    entryName,\n    formatOptions,\n    source,\n    preferences,\n  ) {\n    const { node, document } = helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n\n    if (isNotNull(document) && isSimpleExpressionNode(node)) {\n      const loc = document.tryGetGeneratedOffset(position)\n      if (isNotNull(loc)) {\n        return service.getCompletionEntryDetails(\n          document.fsPath,\n          loc,\n          entryName,\n          formatOptions,\n          source,\n          preferences,\n        )\n      }\n    }\n\n    return undefined\n  },\n\n  getCompletionEntrySymbol(\n    { helpers, service },\n    fileName,\n    position,\n    name,\n    source,\n  ) {\n    const { node, document } = helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n\n    if (isNotNull(document) && isSimpleExpressionNode(node)) {\n      const loc = document.tryGetGeneratedOffset(position)\n      if (isNotNull(loc)) {\n        return service.getCompletionEntrySymbol(\n          document.fsPath,\n          loc,\n          name,\n          source,\n        )\n      }\n    }\n\n    return undefined\n  },\n})\n","import { TS } from '../../../interfaces'\n\nexport const BUILTIN_DIRECTIVES_DETAIL: Record<\n  string,\n  TS.CompletionEntryDetails\n> = {\n  show: {\n    name: 'v-show',\n    kind: 'JSX attribute' as TS.ScriptElementKind.jsxAttribute,\n    kindModifiers: '',\n    displayParts: [],\n    documentation: [\n      {\n        text: `[See documentation](https://vuejs.org)`,\n        kind: 'markdown',\n      },\n    ],\n    tags: [{ name: 'version', text: '3.0.1' }],\n  },\n}\n","import { TS } from '../../../interfaces'\nimport data from 'vscode-web-custom-data/data/browsers.html-data.json'\n\nconst enum TagOrder {\n  LocalComponent = '0',\n  KnownGlobalComponent = '1',\n  GlobalComponent = '2',\n  CustomElement = '3',\n  HTMLElement = '4',\n  SVGElement = '5',\n}\n\nconst enum AttributeOrder {\n  Attribute = '1',\n}\n\ninterface TagCompletionInfo {\n  detail: TS.CompletionEntryDetails\n  attributes: TS.CompletionEntry[]\n  attributesDetail: ReadonlyMap<string, TS.CompletionEntryDetails>\n}\n\nconst HTML_ELEMENT_EVENT_NAME_RE = /^on(beforeinput|change|input|invalid)$/\n\nfunction getAdditionalDocumentation(\n  attribute: string,\n  element?: string,\n): TS.SymbolDisplayPart[] {\n  if (attribute.startsWith('on')) {\n    const source = HTML_ELEMENT_EVENT_NAME_RE.test(attribute)\n      ? 'HTMLElement'\n      : 'Element'\n    return [\n      {\n        text: `[MDN Reference](https://developer.mozilla.org/en-US/docs/Web/API/${source}/${attribute.substr(\n          2,\n        )}_event) `,\n        kind: 'markdown',\n      },\n    ]\n  }\n\n  return []\n}\n\nfunction asMarkdown(content: string): string {\n  return content.replace(/</g, '&lt;').replace(/>/g, '&gt;')\n}\n\nexport const HTML_ELEMENTS: TS.CompletionEntry[] = data.tags.map((tag) =>\n  Object.freeze({\n    name: tag.name,\n    kind: 'JSX attribute' as TS.ScriptElementKind.jsxAttribute,\n    kindModifiers: '',\n    sortText: TagOrder.HTMLElement,\n  }),\n)\n\nexport const HTML_ELEMENTS_BY_NAME = new Map<string, TagCompletionInfo>(\n  data.tags.map((tag) => [\n    tag.name,\n    {\n      detail: Object.freeze({\n        name: tag.name,\n        kind: 'JSX attribute' as TS.ScriptElementKind.memberVariableElement,\n        kindModifiers: '',\n        displayParts: [],\n        documentation: [\n          {\n            text: asMarkdown(tag.description.value) + '\\n\\n',\n            kind: 'markdown',\n          },\n          ...tag.references.map((reference) => ({\n            text: `[${reference.name}](${reference.url}) `,\n            kind: 'markdown',\n          })),\n        ],\n        tags: [],\n      }),\n      attributes: tag.attributes.map((attribute) =>\n        Object.freeze({\n          name: attribute.name,\n          kind: 'JSX attribute' as TS.ScriptElementKind.jsxAttribute,\n          kindModifiers: '',\n          sortText: AttributeOrder.Attribute,\n          source: undefined,\n        }),\n      ),\n      attributesDetail: new Map(\n        tag.attributes.map((attribute) => [\n          attribute.name,\n          Object.freeze({\n            name: attribute.name,\n            kind: 'JSX attribute' as TS.ScriptElementKind.jsxAttribute,\n            kindModifiers: '',\n            displayParts: [], // TODO: Load valueSet as type definition?\n            documentation: [\n              typeof attribute.description === 'string'\n                ? {\n                    text: asMarkdown(attribute.description) + '\\n\\n',\n                    kind: 'markdown',\n                  }\n                : attribute.description != null\n                ? {\n                    text: asMarkdown(attribute.description.value) + '\\n\\n',\n                    kind: 'markdown',\n                  }\n                : { text: '', kind: 'markdown' },\n              ...tag.references.map((reference) => ({\n                text: `[${reference.name}](${reference.url}#attr-${attribute.name}) `,\n                kind: 'markdown',\n              })),\n\n              ...getAdditionalDocumentation(attribute.name, tag.name),\n            ],\n            tags: [],\n          }),\n        ]),\n      ),\n    },\n  ]),\n)\n\nexport const GLOBAL_ATTRIBUTES: TS.CompletionEntry[] = data.globalAttributes.map(\n  (attribute) =>\n    Object.freeze({\n      name: attribute.name,\n      kind: 'JSX attribute' as TS.ScriptElementKind.jsxAttribute,\n      kindModifiers: '',\n      sortText: AttributeOrder.Attribute,\n      source: undefined,\n    }),\n)\n\nexport const GLOBAL_ATTRIBUTES_BY_NAME = new Map<\n  string,\n  TS.CompletionEntryDetails\n>(\n  data.globalAttributes.map((attribute) => [\n    attribute.name,\n    Object.freeze({\n      name: attribute.name,\n      kind: 'JSX attribute' as TS.ScriptElementKind.jsxAttribute,\n      kindModifiers: '',\n      displayParts: [], // TODO: Load valueSet as type definition?\n      documentation: [\n        attribute.description != null\n          ? {\n              text: asMarkdown(attribute.description.value) + '\\n\\n',\n              kind: 'markdown',\n            }\n          : { text: '', kind: 'markdown' },\n\n        ...(attribute.references ?? []).map((reference) => ({\n          text: `[${reference.name}](${reference.url}) `,\n          kind: 'markdown',\n        })),\n\n        ...getAdditionalDocumentation(attribute.name),\n      ],\n      tags: [],\n    }),\n  ]),\n)\n\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Element\nconst HTML_TAGS = new Set(\n  (\n    'html,body,base,head,link,meta,style,title,address,article,aside,footer,' +\n    'header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,' +\n    'figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,' +\n    'data,dfn,em,i,kbd,keygen,mark,noindex,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,' +\n    'time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,' +\n    'canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,' +\n    'th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,' +\n    'option,output,progress,select,textarea,details,dialog,menu,' +\n    'summary,template,blockquote,iframe,tfoot,webview'\n  ).split(','),\n)\nexport const isHTMLTag = (tagName: string): boolean => HTML_TAGS.has(tagName)\n\n// https://developer.mozilla.org/en-US/docs/Web/SVG/Element\nconst SVG_TAGS = new Set(\n  (\n    'svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,' +\n    'defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,' +\n    'feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,' +\n    'feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,' +\n    'feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,feDistantLight,' +\n    'fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,' +\n    'foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,' +\n    'mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,' +\n    'polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,' +\n    'text,textPath,title,tspan,unknown,use,view'\n  ).split(','),\n)\nexport const isSVGTag = (tagName: string): boolean => SVG_TAGS.has(tagName)\n","import { ComponentRegistrationInfo, TypeInfo } from '@vuedx/analyze'\nimport {\n  camelCase,\n  concat,\n  first,\n  getComponentNameAliases,\n  getRelativeFileName,\n  isNotNull,\n  isPascalCase,\n  kebabCase,\n  last,\n  pascalCase,\n  uncapitalize,\n} from '@vuedx/shared'\nimport {\n  AttributeNode,\n  DirectiveNode,\n  ElementNode,\n  findParentNode,\n  isAttributeNode,\n  isCommentNode,\n  isComponentNode,\n  isDirectiveNode,\n  isElementNode,\n  isPlainElementNode,\n  isSimpleExpressionNode,\n  isTextNode,\n} from '@vuedx/template-ast-types'\nimport {\n  isVirtualFileOfType,\n  MODULE_SELECTOR,\n  RenderFunctionTextDocument,\n} from '@vuedx/vue-virtual-textdocument'\nimport Path from 'path'\nimport { getScriptFileName } from '../../helpers/utils'\nimport { TS } from '../../interfaces'\nimport { LanguageServiceOptions } from '../../types'\nimport { defineCompletionProvider } from './abstract'\nimport { BUILTIN_DIRECTIVES_DETAIL } from './data/directives'\nimport {\n  GLOBAL_ATTRIBUTES,\n  GLOBAL_ATTRIBUTES_BY_NAME,\n  HTML_ELEMENTS,\n  HTML_ELEMENTS_BY_NAME,\n  isHTMLTag,\n} from './data/html'\n\nfunction stringifyTypeInfo(typeInfo: TypeInfo[]): string {\n  if (typeInfo.length === 0) {\n    return 'never'\n  } else if (typeInfo.length === 1) {\n    const info = typeInfo[0]\n    switch (info.kind) {\n      case 'string':\n      case 'number':\n      case 'boolean':\n        return info.kind\n      case 'enum':\n        return info.values.join(' | ')\n      default:\n        return info.expression\n    }\n  } else {\n    return typeInfo\n      .map((type) => {\n        if (type.kind === 'enum') {\n          return `${type.values.join('|')}`\n        } else if (type.kind === 'expression') {\n          return `${type.expression}`\n        } else {\n          return type.kind\n        }\n      })\n      .map((type) => (/[()|=]/.test(type) ? `(${type})` : type))\n      .join('|')\n  }\n}\n\nexport class HTMLService {\n  constructor(private readonly $: LanguageServiceOptions) {}\n\n  public getCompletionsAtPosition(\n    fileName: string,\n    position: number,\n    options: TS.GetCompletionsAtPositionOptions | undefined,\n  ): TS.WithMetadata<TS.CompletionInfo> | undefined {\n    return this.findCompletionKind(fileName, position, (args) => {\n      if (args.kind === 'tag') {\n        return this.getTagCompletionsAtPosition(\n          args.document,\n          position,\n          options,\n          args.element,\n        )\n      } else if (args.kind === 'attribute') {\n        return this.getAttributeCompletionsAtPosition(\n          args.document,\n          position,\n          options,\n          args.element,\n          args.attribute,\n        )\n      }\n    })\n  }\n\n  public getCompletionEntryDetails(\n    fileName: string,\n    position: number,\n    entryName: string,\n    formatOptions: TS.FormatCodeOptions | TS.FormatCodeSettings | undefined,\n    source: string | undefined,\n    preferences: TS.UserPreferences | undefined,\n  ): TS.CompletionEntryDetails | undefined {\n    return this.findCompletionKind(fileName, position, (args) => {\n      __DEV__ && this.$.context.debug(`\"${entryName}\" is \"${args.kind}\"`)\n      if (args.kind === 'tag') {\n        return this.getTagCompletionEntryDetails(\n          args.document,\n          position,\n          entryName,\n          formatOptions,\n          source,\n          preferences,\n          args.element,\n        )\n      } else if (args.kind === 'attribute') {\n        return this.getAttributeCompletionEntryDetails(\n          args.document,\n          position,\n          entryName,\n          formatOptions,\n          source,\n          preferences,\n          args.element,\n          args.attribute,\n        )\n      }\n    })\n  }\n\n  public getCompletionEntrySymbol(\n    _context: LanguageServiceOptions,\n    _fileName: string,\n    _position: number,\n    _name: string,\n    _source: string | undefined,\n  ): TS.Symbol | undefined {\n    return undefined\n  }\n\n  private findCompletionKind<T>(\n    fileName: string,\n    position: number,\n    fn: (\n      options:\n        | {\n            kind: 'tag'\n            document: RenderFunctionTextDocument\n            element?: ElementNode\n          }\n        | {\n            kind: 'attribute'\n            document: RenderFunctionTextDocument\n            element: ElementNode\n            attribute?: AttributeNode | DirectiveNode\n          },\n    ) => T,\n  ): T | undefined {\n    const {\n      node,\n      document,\n      ancestors,\n    } = this.$.helpers.findTemplateNodeAtPosition(fileName, position)\n\n    if (isNotNull(document)) {\n      if (isElementNode(node)) {\n        /**\n         * HTML tag completion is supported only when cursor in or at the\n         * end of element tag.\n         */\n        if (this.isPositionInElementTagname(node, position)) {\n          return fn({ kind: 'tag', document, element: node })\n        } else if (this.isPositionInElementOpenTag(node, position)) {\n          /**\n           * If in open tag of element, we need to provide attribute completion.\n           */\n          return fn({ kind: 'attribute', document, element: node })\n        } else if (position > 2) {\n          if (document.container.getText(position - 2, 2) === '</') {\n            return fn({\n              kind: 'tag',\n              document,\n            })\n          }\n        }\n      } else if (isTextNode(node) || isCommentNode(node)) {\n        if (__DEV__) this.$.context.debug(`incomplete tag as text/comment`)\n        /**\n         * Template parser parses some incomplete elements as text.\n         */\n        if (\n          (node.content.trim().startsWith('<') &&\n            position ===\n              node.loc.start.offset + node.loc.source.indexOf('<') + 1) ||\n          (node.content.trim().startsWith('</') &&\n            position ===\n              node.loc.start.offset + node.loc.source.indexOf('</') + 2)\n        ) {\n          return fn({ kind: 'tag', document })\n        }\n      } else if (isDirectiveNode(node) || isAttributeNode(node)) {\n        return fn({\n          kind: 'attribute',\n          document,\n          element: last(ancestors).node as ElementNode,\n          attribute: node,\n        })\n      } else if (isSimpleExpressionNode(node) && node.isStatic) {\n        const directive = last(ancestors).node\n        if (isDirectiveNode(directive) && directive.arg === node) {\n          return fn({\n            kind: 'attribute',\n            document,\n            element: last(ancestors, 2).node as ElementNode,\n            attribute: directive,\n          })\n        }\n      }\n    }\n\n    __DEV__ &&\n      this.$.context.debug`Neither \"tag\" or \"attribute\" completion: ${node}`\n  }\n\n  private mergeCompletionEntryDetails(\n    details1: TS.CompletionEntryDetails | undefined,\n    details2: TS.CompletionEntryDetails | undefined,\n  ): TS.CompletionEntryDetails | undefined {\n    if (details1 != null && details2 != null) {\n      const details = { ...details1, ...details2 }\n\n      details.displayParts = concat(\n        details1?.displayParts,\n        details2?.displayParts,\n      )\n      details.documentation = concat(\n        details1?.documentation,\n        details2?.documentation,\n      )\n      if (details1?.source != null || details2.source != null) {\n        details.source = concat(details1?.source, details2?.source)\n      }\n      details.codeActions = concat(details1?.codeActions, details2?.codeActions)\n      details.tags = concat(details1?.tags, details2?.tags)\n\n      return details\n    } else if (details1 != null) {\n      return { ...details1 }\n    } else if (details2 != null) {\n      return { ...details2 }\n    }\n  }\n\n  private isPositionInElementOpenTag(\n    node: ElementNode,\n    position: number,\n  ): boolean {\n    const start = node.loc.start.offset + node.tag.length + 2\n    if (node.isSelfClosing) {\n      // An incomplete element is parsed as open tag.\n      const suffixLength = node.loc.source.endsWith('/>') ? 2 : 0\n\n      return start <= position && position <= node.loc.end.offset - suffixLength\n    }\n\n    const maxIndex =\n      node.children.length > 0\n        ? first(node.children).loc.start.offset\n        : node.loc.source.lastIndexOf('</')\n\n    const end =\n      node.loc.start.offset +\n      node.loc.source.substr(0, maxIndex).lastIndexOf('>')\n\n    return start <= position && position <= end\n  }\n\n  private isPositionInElementTagname(\n    node: ElementNode,\n    position: number,\n  ): boolean {\n    return (\n      node.loc.start.offset < position &&\n      position <= node.loc.start.offset + node.tag.length + 1\n    )\n  }\n\n  private getTagCompletionsAtPosition(\n    document: RenderFunctionTextDocument,\n    position: number,\n    options: TS.GetCompletionsAtPositionOptions | undefined,\n    node?: ElementNode,\n  ): TS.WithMetadata<TS.CompletionInfo> | undefined {\n    const result: TS.WithMetadata<TS.CompletionInfo> = {\n      isGlobalCompletion: false,\n      isMemberCompletion: false,\n      isNewIdentifierLocation: false,\n      entries: [],\n    }\n\n    const project = this.$.context.getVueProjectForFile(\n      document.container.fsPath,\n      true,\n    )\n    const { preferences } = project.config\n\n    let replacementSpan: TS.TextSpan | undefined\n    if (isElementNode(node)) {\n      replacementSpan = {\n        start: node.loc.start.offset + 1,\n        length: node.tag.length,\n      }\n    }\n\n    const known = new Set<string>()\n    const add = (entry: TS.CompletionEntry): void => {\n      const id =\n        entry.source != null ? `${entry.name}:${entry.source}` : entry.name\n      if (!known.has(id)) {\n        known.add(id)\n        result.entries.push(entry)\n      }\n    }\n    const addHandlingSource = (item: TS.CompletionEntry): void => {\n      const entry: TS.CompletionEntry = {\n        ...item,\n        kind: this.$.context.typescript.ScriptElementKind.jsxAttribute,\n        replacementSpan,\n        hasAction: true,\n      }\n\n      if (entry.source != null) {\n        switch (preferences.template.tagCase) {\n          case 'kebab':\n            add({\n              ...entry,\n              name: kebabCase(entry.name),\n            })\n            break\n          case 'pascal':\n            add({\n              ...entry,\n              name: pascalCase(entry.name),\n            })\n            break\n          default:\n            getComponentNameAliases(entry.name).forEach((alias) => {\n              add({\n                ...entry,\n                name: alias,\n              })\n            })\n            break\n        }\n      } else {\n        add(entry)\n      }\n    }\n\n    const openIndex = document.container.getText(0, position).lastIndexOf('<')\n    if (openIndex >= 0) {\n      const prefixText = document.container.getText(\n        openIndex,\n        position - openIndex,\n      )\n\n      __DEV__ &&\n        this.$.context.debug`May be a closing tag: ${{\n          prefixText,\n          position,\n          openIndex,\n        }}`\n      if (prefixText.startsWith('</')) {\n        const replacementSpan: TS.TextSpan = {\n          start: openIndex,\n          length: prefixText.length,\n        }\n\n        const { ancestors } = this.$.helpers.findTemplateNodeAtPosition(\n          document.container.fsPath,\n          position,\n        )\n\n        ancestors.reverse().forEach((ancestor) => {\n          if (isElementNode(ancestor.node)) {\n            result.entries.push({\n              name: ancestor.node.tag,\n              kind: this.$.context.typescript.ScriptElementKind.jsxAttribute,\n              insertText: `</${ancestor.node.tag}>`,\n              kindModifiers: '',\n              sortText: '0',\n              isRecommended: ancestor.node.tag === node?.tag ? true : undefined,\n              replacementSpan,\n            })\n          }\n        })\n\n        return result\n      } else if (replacementSpan == null) {\n        replacementSpan = {\n          start: openIndex,\n          length: prefixText.length,\n        }\n      }\n    }\n\n    HTML_ELEMENTS.forEach((element) => add({ ...element }))\n\n    project.globalComponents.forEach((component) =>\n      addHandlingSource({\n        name: component.name,\n        kind: this.$.context.typescript.ScriptElementKind.jsxAttribute,\n        kindModifiers: 'export',\n        sortText: '9',\n        source: component.source.moduleName,\n        hasAction: true,\n      }),\n    )\n\n    const jsx = this.$.service.getCompletionsAtPosition(\n      document.fsPath,\n      document.tagCompletionsTriggerOffset,\n      {\n        ...options,\n        triggerCharacter: '<',\n      },\n    )\n\n    const deps = new Set(Object.keys(project.packageJSON.dependencies))\n    jsx?.entries.forEach((entry) => {\n      if (isHTMLTag(entry.name)) {\n        add(entry)\n      } else if (\n        entry.source != null &&\n        this.$.helpers.isVueModuleFileName(entry.source)\n      ) {\n        addHandlingSource(entry)\n      } else if (\n        entry.kind === this.$.context.typescript.ScriptElementKind.jsxAttribute\n      ) {\n        if (entry.source == null) {\n          add(entry)\n        } else if (isPascalCase(entry.name)) {\n          if (deps.has(entry.name) || Path.posix.isAbsolute(entry.source)) {\n            addHandlingSource(entry)\n          }\n        }\n      }\n    })\n\n    if (\n      this.$.context.getTSProjectForFile(document.fsPath, true)?.projectKind ===\n      this.$.context.typescript.server.ProjectKind.Inferred\n    ) {\n      project.components.forEach((component) =>\n        addHandlingSource({\n          name: component.name,\n          kind: this.$.context.typescript.ScriptElementKind.jsxAttribute,\n          kindModifiers: 'export',\n          sortText: '9',\n          source: component.source.moduleName,\n          hasAction: true,\n        }),\n      )\n    }\n\n    this.$.helpers\n      .getComponentInfo(document.container)\n      .components.forEach((component) => {\n        component.aliases.forEach((alias) =>\n          add({\n            name: alias,\n            kind: this.$.context.typescript.ScriptElementKind.jsxAttribute,\n            kindModifiers: '',\n            sortText: '0',\n            source: this.$.helpers.getResolvedModule(\n              getScriptFileName(document.container),\n              component.source.moduleName,\n            )?.resolvedFileName,\n            hasAction: true,\n          }),\n        )\n      })\n\n    return result\n  }\n\n  private getTagCompletionEntryDetails(\n    document: RenderFunctionTextDocument,\n    _position: number,\n    entryName: string,\n    formatOptions: TS.FormatCodeOptions | TS.FormatCodeSettings | undefined,\n    source: string | undefined,\n    preferences: TS.UserPreferences | undefined,\n    _element?: ElementNode,\n  ): TS.CompletionEntryDetails | undefined {\n    // TODO: Use getTagCompletionsAtPosition (with extra metadata) to simplify this logic.\n    let result: TS.CompletionEntryDetails | undefined\n    let registration: ComponentRegistrationInfo | undefined\n    let isGlobalComponent = false\n    let isLocalComponent = false\n    if (isHTMLTag(entryName)) {\n      result = this.mergeCompletionEntryDetails(\n        result,\n        HTML_ELEMENTS_BY_NAME.get(entryName)?.detail,\n      )\n    } else if (source != null) {\n      const project = this.$.context.getVueProjectForFile(\n        document.container.fsPath,\n        true,\n      )\n      const info = this.$.helpers.getComponentInfo(document.container)\n      registration = info.components.find((component) =>\n        component.aliases.includes(entryName),\n      )\n\n      if (registration != null) {\n        isLocalComponent = true\n      } else {\n        registration = project.components.find(\n          (component) =>\n            component.source.moduleName === source &&\n            component.aliases.includes(entryName),\n        )\n        if (registration != null) {\n          isGlobalComponent = project.globalComponents.includes(registration)\n        }\n      }\n    }\n\n    result = this.mergeCompletionEntryDetails(\n      result,\n      this.$.service.getCompletionEntryDetails(\n        document.fsPath,\n        document.tagCompletionsTriggerOffset,\n        entryName.includes('-') && source != null\n          ? pascalCase(entryName)\n          : entryName,\n        formatOptions,\n        source,\n        preferences,\n      ),\n    )\n\n    if (source != null && isVirtualFileOfType(source, MODULE_SELECTOR)) {\n      const document = this.$.helpers.getVueDocument(source)\n      if (document != null) {\n        if (result != null) result.displayParts = []\n        const info = this.$.helpers.getComponentInfo(document)\n        result = this.mergeCompletionEntryDetails(result, {\n          name: entryName,\n          kind: this.$.context.typescript.ScriptElementKind.jsxAttribute,\n          kindModifiers: '',\n          displayParts: [\n            { text: '(', kind: 'punctuation' },\n            {\n              text:\n                (isGlobalComponent\n                  ? 'Global '\n                  : isLocalComponent\n                  ? 'Local '\n                  : '') + 'Vue Component',\n              kind: 'text',\n            },\n            { text: ')', kind: 'punctuation' },\n            { text: ' ', kind: 'space' },\n            { text: pascalCase(entryName), kind: 'propertyName' },\n            { text: ':', kind: 'punctuation' },\n            { text: ' ', kind: 'space' },\n            { text: 'Component', kind: 'aliasName' },\n            { text: '<', kind: 'punctuation' },\n            { text: '{', kind: 'punctuation' },\n            ...info.props.flatMap((prop) => [\n              { text: '\\n', kind: 'lineBreak' },\n              { text: '    ', kind: 'space' },\n              { text: camelCase(prop.name), kind: 'propertyName' },\n              { text: ':', kind: 'punctuation' },\n              { text: ' ', kind: 'space' },\n              // TODO: Tokenize type info if needed.\n              { text: stringifyTypeInfo(prop.type), kind: 'type' },\n              { text: ';', kind: 'punctuation' },\n            ]),\n            ...info.emits.flatMap((prop) => [\n              { text: '\\n', kind: 'lineBreak' },\n              { text: '    ', kind: 'space' },\n              { text: camelCase(`on-${prop.name}`), kind: 'propertyName' },\n              { text: ':', kind: 'punctuation' },\n              { text: ' ', kind: 'space' },\n              // TODO: Tokenize type info if needed.\n              { text: stringifyTypeInfo(prop.type), kind: 'type' },\n              { text: ';', kind: 'punctuation' },\n            ]),\n            info.emits.length > 0 || info.props.length > 0\n              ? { text: '\\n', kind: 'lineBreak' }\n              : { text: '', kind: 'space' },\n            { text: '}', kind: 'punctuation' },\n            // TODO: Add slots\n            { text: '>', kind: 'punctuation' },\n          ],\n          documentation: [{ kind: 'markdown', text: info.description }],\n        })\n      }\n    }\n\n    if (registration != null && result == null) {\n      // Either in inferred typescript project or component resolved from vueconfig.json\n      result = {\n        name: entryName,\n        kind: this.$.context.typescript.ScriptElementKind.jsxAttribute,\n        kindModifiers: '',\n        displayParts: [\n          { text: '(', kind: 'punctuation' },\n          {\n            text:\n              (isGlobalComponent\n                ? 'Global '\n                : isLocalComponent\n                ? 'Local '\n                : '') + 'Vue Component',\n            kind: 'text',\n          },\n          { text: ')', kind: 'punctuation' },\n          { text: ' ', kind: 'space' },\n          { text: pascalCase(entryName), kind: 'propertyName' },\n          { text: ':', kind: 'punctuation' },\n          { text: ' ', kind: 'space' },\n          { text: 'Component', kind: 'aliasName' },\n        ],\n      }\n    }\n\n    if (\n      !isLocalComponent &&\n      !isGlobalComponent &&\n      source != null &&\n      result != null &&\n      (result.codeActions?.length ?? 0) === 0\n    ) {\n      if (isVirtualFileOfType(source, MODULE_SELECTOR)) {\n        // When there is source theres should be an import statement.\n        const id = getRelativeFileName(document.fsPath, source)\n        result.codeActions = [\n          {\n            description: `Import default '${pascalCase(\n              entryName,\n            )}' from module \"${id}\"`,\n            changes: [\n              {\n                fileName: document.fsPath,\n                textChanges: [\n                  {\n                    span: { start: 0, length: 0 },\n                    newText: `import ${pascalCase(entryName)} from '${id}'\\n`,\n                  },\n                ],\n              },\n            ],\n            commands: undefined,\n          },\n        ]\n\n        result.source = [\n          {\n            text: id,\n            kind: 'text',\n          },\n        ]\n      } else if (registration != null) {\n        const id = getRelativeFileName(\n          document.fsPath,\n          registration.source.moduleName,\n        ).replace(/\\.(ts|js)x?$/, '')\n        const name = pascalCase(entryName)\n        result.codeActions = [\n          {\n            description: `Import ${\n              registration.source.exportName != null ? '' : 'default'\n            } '${name}' from module \"${id}\"`,\n            changes: [\n              {\n                fileName: document.fsPath,\n                textChanges: [\n                  {\n                    span: { start: 0, length: 0 },\n                    newText: `import ${\n                      registration.source.exportName != null\n                        ? `{${\n                            registration.source.exportName !== name\n                              ? ` ${registration.source.exportName} as `\n                              : ''\n                          } ${name} }`\n                        : name\n                    } from '${id}'\\n`,\n                  },\n                ],\n              },\n            ],\n            commands: undefined,\n          },\n        ]\n\n        result.source = [\n          {\n            text: id,\n            kind: 'text',\n          },\n        ]\n      }\n    }\n\n    if (isLocalComponent || isGlobalComponent) {\n      if (result != null) {\n        result.codeActions = undefined // Already registered component.\n        result.source = undefined // Already registered component.\n      }\n    }\n\n    return result\n  }\n\n  private getAttributeCompletionsAtPosition(\n    document: RenderFunctionTextDocument,\n    _position: number,\n    options: TS.GetCompletionsAtPositionOptions | undefined,\n    element: ElementNode,\n    attribute?: DirectiveNode | AttributeNode,\n  ): TS.WithMetadata<TS.CompletionInfo> | undefined {\n    // 1. <div | >\n    // 2. <div fo|o>\n    // 3(a). <div v-on:| >\n    // 3(b). <div v-on:cli|ck >\n    // 4(a). <div v-on:click. >\n    // 4(b). <div v-on:click.le|ft >\n    // 5(b). <div v-on:click.left=| >\n    const result: TS.WithMetadata<TS.CompletionInfo> = {\n      isGlobalCompletion: false,\n      isMemberCompletion: false,\n      isNewIdentifierLocation: false,\n      entries: [],\n    }\n\n    let isAttribute = true\n    let isEvent = false\n    let replacementSpan: TS.TextSpan | undefined\n    if (isAttributeNode(attribute)) {\n      isAttribute = true\n      replacementSpan = {\n        start: attribute.loc.start.offset,\n        length: attribute.name.length,\n      }\n    } else if (isDirectiveNode(attribute)) {\n      // either in arg or modifier\n      isAttribute = attribute.name === 'bind'\n      isEvent = attribute.name === 'on'\n    }\n\n    if (isAttribute || isEvent) {\n      const alreadyExists = new Set(\n        element.props\n          .map((prop) =>\n            isAttributeNode(prop) && !/^(class|style)$/.test(prop.name) // TODO: Handle static/dynamic class and style attributes.\n              ? prop.name\n              : isDirectiveNode(prop) &&\n                isSimpleExpressionNode(prop.arg) &&\n                prop.arg.isStatic\n              ? prop.arg.content\n              : null,\n          )\n          .filter(isNotNull),\n      )\n      const { preferences } = this.$.context.getVueProjectForFile(\n        document.container.fsPath,\n        true,\n      ).config\n      // TODO: Handle <component :is=\"xxxx\"\n      const offset = document.tryGetGeneratedOffset(\n        element.loc.start.offset + element.tag.length + 1,\n      )\n      const jsxAttributes = new Set<string>()\n\n      const add = (item: TS.CompletionEntry): void => {\n        const entry = {\n          ...item,\n          kind: this.$.context.typescript.ScriptElementKind.jsxAttribute,\n          source: undefined,\n          replacementSpan,\n        }\n\n        if (isAttribute) {\n          if (entry.name.startsWith('on')) return\n        }\n\n        if (isEvent) {\n          if (!entry.name.startsWith('on')) return\n          entry.name = uncapitalize(entry.name.replace(/^on-?/, ''))\n        }\n\n        entry.name =\n          preferences.template.propCase === 'kebab'\n            ? kebabCase(entry.name)\n            : entry.name.startsWith('aria-') || entry.name.startsWith('data-')\n            ? entry.name\n            : camelCase(entry.name)\n\n        if (jsxAttributes.has(entry.name) || alreadyExists.has(entry.name)) {\n          // Already there...\n        } else {\n          jsxAttributes.add(entry.name)\n          result.entries.push(entry)\n        }\n      }\n\n      if (offset != null) {\n        const jsx = this.$.service.getCompletionsAtPosition(\n          document.fsPath,\n          offset + 1, // include space after tagName.\n          options,\n        )\n\n        jsx?.entries.forEach(add)\n      }\n\n      if (isHTMLTag(element.tag)) {\n        HTML_ELEMENTS_BY_NAME.get(element.tag)?.attributes.forEach(add)\n        GLOBAL_ATTRIBUTES.forEach(add)\n      }\n    }\n\n    // Directives\n    if (!isDirectiveNode(attribute)) {\n      // TODO: Use directive description from vue reference.\n      const allowedDirectives = [\n        'v-show',\n        'v-bind',\n        'v-on',\n        'v-for',\n        'v-if',\n        'v-else',\n        'v-else-if',\n        'v-text',\n        'v-html',\n      ]\n\n      if (isPlainElementNode(element)) {\n        allowedDirectives.push('v-text', 'v-html')\n      }\n\n      /**\n       * v-slot is allowed on components or their immediate child\n       * template elements.\n       */\n      if (isComponentNode(element)) {\n        allowedDirectives.push('v-slot')\n      } else if (element.tag === 'template' && document.ast != null) {\n        const parent = findParentNode(document.ast, element)\n        if (isComponentNode(parent)) {\n          allowedDirectives.push('v-slot')\n        }\n      }\n\n      allowedDirectives.forEach((name) => {\n        result.entries.push({\n          name,\n          kind: 'JSX attribute' as TS.ScriptElementKind.jsxAttribute,\n          kindModifiers: '',\n          sortText: '9',\n          replacementSpan,\n        })\n      })\n    }\n\n    return result\n  }\n\n  private getAttributeCompletionEntryDetails(\n    document: RenderFunctionTextDocument,\n    _position: number,\n    entryName: string,\n    formatOptions: TS.FormatCodeOptions | TS.FormatCodeSettings | undefined,\n    source: string | undefined,\n    preferences: TS.UserPreferences | undefined,\n    element: ElementNode,\n    attribute?: AttributeNode | DirectiveNode,\n  ): TS.CompletionEntryDetails | undefined {\n    let result: TS.CompletionEntryDetails | undefined\n    const isEvent = isDirectiveNode(attribute) && attribute.name === 'on'\n    const isAttribute =\n      (isDirectiveNode(attribute) && attribute.name === 'bind') ||\n      isAttributeNode(attribute)\n    const newEntryName = isEvent\n      ? camelCase(`on-${entryName}`)\n      : camelCase(entryName)\n\n    if (isEvent || isAttribute) {\n      const offset = document.tryGetGeneratedOffset(\n        element.loc.start.offset + element.tag.length + 1,\n      )\n\n      if (offset != null) {\n        const text = document.getText()\n        __DEV__ &&\n          this.$.context.debug(\n            `Cursor at \"${text.substr(offset - 10, 11)}|${text.substr(\n              offset + 1,\n              10,\n            )}\"`,\n          )\n        const jsxInfo = this.$.service.getCompletionEntryDetails(\n          document.fsPath,\n          offset + 1,\n          newEntryName,\n          formatOptions,\n          source,\n          preferences,\n        )\n        __DEV__ &&\n          this.$.context.debug(\n            `Check \"${newEntryName}\" for \"${entryName}\" at ${\n              offset + 1\n            }, ${JSON.stringify(jsxInfo, null, 2)}`,\n          )\n\n        result = this.mergeCompletionEntryDetails(result, jsxInfo)\n      }\n    }\n\n    if (entryName.startsWith('v-')) {\n      result = this.mergeCompletionEntryDetails(\n        result,\n        BUILTIN_DIRECTIVES_DETAIL[entryName],\n      )\n    }\n\n    if (isHTMLTag(element.tag)) {\n      const tag = HTML_ELEMENTS_BY_NAME.get(element.tag)\n      const attr = newEntryName.toLowerCase()\n      __DEV__ &&\n        this.$.context.debug(\n          `Find attribute \"${attr}\" details in \"${element.tag}\"`,\n        )\n      if (tag?.attributesDetail.has(attr) === true) {\n        result = this.mergeCompletionEntryDetails(\n          result,\n          tag.attributesDetail.get(newEntryName),\n        )\n      } else if (GLOBAL_ATTRIBUTES_BY_NAME.has(attr)) {\n        result = this.mergeCompletionEntryDetails(\n          result,\n          GLOBAL_ATTRIBUTES_BY_NAME.get(attr),\n        )\n      }\n    }\n\n    if (result != null) {\n      result.name = entryName\n    }\n\n    return result\n  }\n}\n\nexport const TemplateCompletionProvider = defineCompletionProvider({\n  name: 'template',\n  version: '*',\n\n  getCompletionsAtPosition(config, fileName, position, options) {\n    return new HTMLService(config).getCompletionsAtPosition(\n      fileName,\n      position,\n      options,\n    )\n  },\n\n  getCompletionEntryDetails(\n    config,\n    fileName,\n    position,\n    entryName,\n    formatOptions,\n    source,\n    preferences,\n  ) {\n    return new HTMLService(config).getCompletionEntryDetails(\n      fileName,\n      position,\n      entryName,\n      formatOptions,\n      source,\n      preferences,\n    )\n  },\n\n  getCompletionEntrySymbol(\n    { helpers, service },\n    fileName,\n    position,\n    name,\n    source,\n  ) {\n    const { node, document } = helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n\n    if (isNotNull(document) && isElementNode(node)) {\n      const maxOffset = node.loc.start.offset + pascalCase(node.tag).length + 1\n\n      if (position <= maxOffset) {\n        const loc = document.tryGetGeneratedOffset(position)\n        if (isNotNull(loc)) {\n          return service.getCompletionEntrySymbol(\n            document.fsPath,\n            document.contextCompletionsTriggerOffset,\n            name,\n            source,\n          )\n        }\n      }\n    }\n\n    return undefined\n  },\n})\n","import { TemplateContextCompletionProvider } from './TemplateContextCompletionProvider'\nimport { TemplateExpressionCompletionProvider } from './TemplateExpressionCompletionProvider'\nimport { TemplateCompletionProvider } from './TemplateCompletionProvider'\n\nexport const TEMPLATE_COMPLETION_PROVIDERS = [\n  TemplateCompletionProvider,\n  TemplateContextCompletionProvider,\n  TemplateExpressionCompletionProvider,\n]\n","import { TS } from '../../interfaces'\nimport { LanguageServiceOptions } from '../../types'\n\nexport interface DiagnosticProvider {\n  version: string\n\n  semantic(context: LanguageServiceOptions, fileName: string): TS.Diagnostic[]\n\n  syntax(\n    context: LanguageServiceOptions,\n    fileName: string,\n  ): TS.DiagnosticWithLocation[]\n\n  suggestions(\n    context: LanguageServiceOptions,\n    fileName: string,\n  ): TS.DiagnosticWithLocation[]\n}\n\nexport function defineDiagnosticProvider(\n  options: DiagnosticProvider,\n): DiagnosticProvider {\n  return options\n}\n","import { createCoreContext, translate } from '@intlify/core'\n\nexport const enum DiagnosticCode {\n  InferredGlobalComponent_Unknown = 59001,\n  InferredGlobalComponent_Known,\n  InferredGlobalComponent_PossibleSource,\n}\n\nconst context = createCoreContext({\n  locale: 'en',\n  messages: {\n    en: {\n      [DiagnosticCode.InferredGlobalComponent_Unknown]: `Cannot find a global component matching: '{tag}'.`,\n      [DiagnosticCode.InferredGlobalComponent_Known]: `The component '{tag}' is inferred as global component. It may not be available at runtime.`,\n      [DiagnosticCode.InferredGlobalComponent_PossibleSource]: `The component '{tag}' can be imported from '{source}'.`,\n    },\n  },\n})\n\nexport function getMessage(\n  code: DiagnosticCode,\n  options: Record<string, string | boolean | undefined | null | number> = {},\n): string {\n  try {\n    return String(translate(context, String(code), options))\n  } catch {\n    return 'Error in message translation'\n  }\n}\n","import { ComponentInfo, VueProject } from '@vuedx/analyze'\nimport { isComponentNode, traverseFast } from '@vuedx/template-ast-types'\nimport { getRelativeFileName } from '@vuedx/shared'\nimport { TS } from '../../interfaces'\nimport { defineDiagnosticProvider } from './abstract'\nimport { DiagnosticCode, getMessage } from './messages'\n\nexport const InferredComponentDiagnosticsProvider = defineDiagnosticProvider({\n  version: '*',\n\n  semantic({ context, helpers, service }, fileName) {\n    const diagnostics: TS.Diagnostic[] = []\n    const document = helpers.getRenderDoc(fileName)\n    if (document?.ast == null) return diagnostics\n    const project = context.getVueProjectForFile(fileName, true)\n    if (project.kind !== 'inferred') return diagnostics\n\n    const info = helpers.getComponentInfo(document.container)\n    const {\n      projectComponentNames,\n      localComponentNames,\n      globalComponentNames,\n    } = getKnownComponents(info, project)\n    const projectComponents = project.components\n    const file = helpers\n      .getLanguageServiceFor(document.fsPath, service)\n      .getProgram()\n      ?.getSourceFile(document.fsPath)\n\n    traverseFast(document.ast, (node) => {\n      if (isComponentNode(node)) {\n        if (\n          !localComponentNames.has(node.tag) &&\n          !globalComponentNames.has(node.tag)\n        ) {\n          if (projectComponentNames.has(node.tag)) {\n            const components = projectComponents.filter((component) =>\n              component.aliases.includes(node.tag),\n            )\n\n            const relatedInformation: TS.DiagnosticRelatedInformation[] = []\n            const diagnostic: TS.Diagnostic = {\n              category: context.typescript.DiagnosticCategory.Warning,\n              code: DiagnosticCode.InferredGlobalComponent_Known,\n              start: node.loc.start.offset + 1,\n              length: node.tag.length,\n              messageText: getMessage(\n                DiagnosticCode.InferredGlobalComponent_Known,\n                { tag: node.tag },\n              ),\n              file,\n              relatedInformation,\n            }\n\n            if (components.length > 0) {\n              components.forEach((component) => {\n                relatedInformation.push({\n                  code: DiagnosticCode.InferredGlobalComponent_PossibleSource,\n                  category: context.typescript.DiagnosticCategory.Warning,\n                  messageText: getMessage(\n                    DiagnosticCode.InferredGlobalComponent_PossibleSource,\n                    {\n                      tag: node.tag,\n                      source: getRelativeFileName(\n                        document.fsPath,\n                        component.source.moduleName,\n                      ),\n                    },\n                  ),\n                  file: undefined,\n                  start: undefined,\n                  length: undefined,\n                })\n              })\n            }\n\n            diagnostics.push(diagnostic)\n          } else {\n            diagnostics.push({\n              category: context.typescript.DiagnosticCategory.Warning,\n              code: DiagnosticCode.InferredGlobalComponent_Unknown,\n              start: node.loc.start.offset + 1,\n              length: node.tag.length,\n              messageText: getMessage(\n                DiagnosticCode.InferredGlobalComponent_Unknown,\n                { tag: node.tag },\n              ),\n              file,\n            })\n          }\n        }\n      }\n    })\n\n    return diagnostics\n  },\n\n  suggestions(context, fileName) {\n    return []\n  },\n\n  syntax(context, fileName) {\n    return []\n  },\n})\n\nfunction getKnownComponents(\n  info: ComponentInfo,\n  project: VueProject,\n): {\n  projectComponentNames: Set<string>\n  localComponentNames: Set<string>\n  globalComponentNames: Set<string>\n} {\n  const localComponentNames = new Set<string>(\n    info.components.flatMap((component) => component.aliases),\n  )\n  const globalComponentNames = new Set<string>(\n    project.globalComponents.flatMap((component) => component.aliases),\n  )\n  const projectComponentNames = new Set<string>(\n    project.components.flatMap((component) => component.aliases),\n  )\n  return { projectComponentNames, localComponentNames, globalComponentNames }\n}\n","import { TS } from '../../interfaces'\nimport { defineDiagnosticProvider } from './abstract'\n\nexport const TemplateCompilerDiagnosticsProvider = defineDiagnosticProvider({\n  version: '*',\n\n  semantic({ context, helpers, service }, fileName) {\n    return []\n  },\n\n  suggestions(context, fileName) {\n    return []\n  },\n\n  syntax({ context, helpers, service }, fileName) {\n    const document = helpers.getRenderDoc(fileName)\n    const diagnostics: TS.DiagnosticWithLocation[] = []\n    if (document != null && document.parserErrors.length > 0) {\n      const sourceFile = helpers.getSourceFile(document.fsPath, service)\n      const block = document.container.descriptor.template\n      if (sourceFile != null && block != null) {\n        const start = block.loc.start.offset\n\n        document.parserErrors.forEach((error) => {\n          if (error.code === 43) return // JS expression parsing error. Ignore it.\n          diagnostics.push({\n            category: context.typescript.DiagnosticCategory.Error,\n            code: 60000 + Math.max(0, error.code),\n            file: sourceFile,\n            start: error.loc != null ? error.loc.start.offset : start,\n            length:\n              error.loc != null\n                ? Math.max(1, error.loc.end.offset - error.loc.start.offset)\n                : 1,\n            messageText: error.message,\n          })\n        })\n      }\n    }\n\n    return diagnostics\n  },\n})\n","import {\n  isSimpleExpressionNode,\n  SimpleExpressionNode,\n  traverseFast,\n} from '@vuedx/template-ast-types'\nimport { RenderFunctionTextDocument } from '@vuedx/vue-virtual-textdocument'\nimport { TS } from '../../interfaces'\nimport { defineDiagnosticProvider } from './abstract'\n\nexport const TSProxyDiagnosticsProvider = defineDiagnosticProvider({\n  version: '*',\n\n  semantic({ helpers, service }, fileName) {\n    const document = helpers.getRenderDoc(fileName)\n\n    return document != null\n      ? helpers\n          .getLanguageServiceFor(document.fsPath, service)\n          .getSemanticDiagnostics(document.fsPath)\n          .map(createDiagnosticsHandler(document))\n          .flat()\n      : []\n  },\n\n  suggestions({ helpers, service }, fileName) {\n    const document = helpers.getRenderDoc(fileName)\n\n    return document != null\n      ? helpers\n          .getLanguageServiceFor(document.fsPath, service)\n          .getSuggestionDiagnostics(document.fsPath)\n          .map(createDiagnosticsHandler(document))\n          .flat()\n      : []\n  },\n\n  syntax({ helpers, service }, fileName) {\n    const document = helpers.getRenderDoc(fileName)\n\n    return document != null\n      ? helpers\n          .getLanguageServiceFor(document.fsPath, service)\n          .getSyntacticDiagnostics(document.fsPath)\n          .map(createDiagnosticsHandler(document))\n          .flat()\n      : []\n  },\n})\n\nfunction createDiagnosticsHandler<T extends TS.Diagnostic>(\n  document: RenderFunctionTextDocument,\n): (value: T) => T[] {\n  let reason: string | null = null\n  let isInTemplate = (diagnostic: T): T[] => [diagnostic]\n  if (document.container.descriptor.template != null) {\n    const start = document.container.descriptor.template.loc.start.offset\n    const end = document.container.descriptor.template.loc.end.offset\n    isInTemplate = (diagnostic) => {\n      const result =\n        diagnostic.start == null ||\n        diagnostic.length == null ||\n        (start <= diagnostic.start &&\n          diagnostic.start + diagnostic.length <= end)\n\n      if (result) return [diagnostic]\n      else {\n        reason = 'Outside <template> block'\n        return []\n      }\n    }\n  }\n\n  return (item: T): T[] => {\n    const diagnostic: T = { ...item } // To avoid mutating as TS server reuses diagnostics.\n    try {\n      if (diagnostic.file == null) {\n        diagnostic.file = ({\n          fileName: document.fsPath,\n        } as unknown) as TS.SourceFile\n      }\n      if (diagnostic.file.fileName !== document.fsPath) {\n        // In case of async diagnostics, the service may be wrapped twice.\n        if (diagnostic.file.fileName === document.container.fsPath) {\n          return [diagnostic]\n        }\n\n        return []\n      }\n      if (diagnostic.start != null) {\n        if (document.isInGeneratedRange(diagnostic.start)) {\n          const position = document.getOriginalOffsetAt(diagnostic.start)\n\n          if (position != null) {\n            diagnostic.start = position.offset\n            if (diagnostic.length != null) {\n              diagnostic.length = Math.max(\n                1,\n                Math.min(position.length, diagnostic.length),\n              )\n            }\n          }\n\n          return isInTemplate(diagnostic)\n        } else if (document.isInTemplateIdentifierRange(diagnostic.start)) {\n          if (document.ast != null) {\n            const identifier = getIdentifier(diagnostic)\n            if (identifier != null) {\n              const diagnostics: T[] = []\n              const nodes: SimpleExpressionNode[] = []\n              traverseFast(document.ast, (node) => {\n                if (\n                  isSimpleExpressionNode(node) &&\n                  node.scope.identifiers.includes(identifier) &&\n                  node.scope.getBinding(identifier) == null\n                ) {\n                  nodes.push(node)\n                }\n              })\n\n              if (nodes.length > 0) {\n                nodes.forEach((node) => {\n                  const RE = new RegExp(\n                    `(?!<\\\\.)${identifier}(?=[^A-Za-z0-9_$]|$)`,\n                    'gm',\n                  )\n                  let matches: RegExpExecArray | null\n                  while ((matches = RE.exec(node.content)) != null) {\n                    diagnostics.push({\n                      ...diagnostic,\n                      start: node.loc.start.offset + matches.index,\n                      length: diagnostic.length,\n                    })\n                  }\n                })\n\n                return diagnostics\n              }\n            }\n          }\n\n          reason = 'Cannot find identifier'\n\n          return []\n        } else {\n          reason = `Outside generated`\n          return []\n        }\n      } else {\n        return isInTemplate(diagnostic)\n      }\n    } finally {\n      if (__DEV__ && reason != null) {\n        console.debug(\n          `@@debug Filtered: \"${reason}\" - ${diagnostic.code} ${JSON.stringify(\n            diagnostic.messageText,\n          )}`,\n        )\n        reason = null\n      }\n    }\n  }\n}\n\nfunction getIdentifier(diagnostic: TS.Diagnostic): string | undefined {\n  switch (diagnostic.code) {\n    case 2339:\n      {\n        const result = /Property '([^']+)' does not exist on type/.exec(\n          JSON.stringify(diagnostic.messageText),\n        )\n\n        if (result != null) {\n          return result[1]\n        }\n      }\n      break\n\n    default:\n      break\n  }\n}\n","import { InferredComponentDiagnosticsProvider } from './InferredComponentDiagnosticsProvider'\nimport { TemplateCompilerDiagnosticsProvider } from './TemplateCompilerDiagnosticsProvider'\nimport { TSProxyDiagnosticsProvider } from './TSProxyDiagnosticsProvider'\n\nexport const TEMPLATE_DIAGNOSTICS_PROVIDERS = [\n  TSProxyDiagnosticsProvider,\n  InferredComponentDiagnosticsProvider,\n  TemplateCompilerDiagnosticsProvider,\n]\n","import { GotoProvider } from './abstract'\nimport {\n  Node,\n  isAttributeNode,\n  isComponentNode,\n  isDirectiveNode,\n  isSimpleExpressionNode,\n} from '@vuedx/template-ast-types'\nimport {\n  isVirtualFile,\n  getContainingFile,\n} from '@vuedx/vue-virtual-textdocument'\n\nexport const GotoExternalComponentProp: GotoProvider = {\n  version: '*',\n  getDefinitionAndBoundSpan({ helpers: h, context }, fileName, position) {\n    const document = h.getRenderDoc(fileName)\n    if (document?.ast == null) return\n\n    const targetNode = h.findTemplateNodeAtPosition(fileName, position)\n\n    if (isSimpleExpressionNode(targetNode.node)) {\n      const last = targetNode.ancestors.pop()\n      if (last != null) {\n        targetNode.node = last.node\n      }\n    }\n\n    let name: string\n    let node: Node\n    if (\n      isDirectiveNode(targetNode?.node) &&\n      targetNode.node.name === 'bind' &&\n      isSimpleExpressionNode(targetNode.node.arg)\n    ) {\n      name = targetNode.node.arg.content\n      node = targetNode.node.arg\n    } else if (isAttributeNode(targetNode?.node)) {\n      name = targetNode.node.name\n      node = targetNode.node\n    } else {\n      return\n    }\n\n    const parent = targetNode.ancestors[targetNode.ancestors.length - 1]?.node\n    if (!isComponentNode(parent)) return\n\n    const componentInfo = h.getComponentInfo(document.container)\n    const component = componentInfo.components.find((component) =>\n      component.aliases.includes(parent.tag),\n    )\n\n    if (component == null) return\n    const scriptFileName = (\n      document.container.getDocument('script') ??\n      document.container.getDocument('scriptSetup')\n    ).fsPath\n    const resolvedModule = h.getResolvedModule(\n      scriptFileName,\n      component.source.moduleName,\n    )\n    if (resolvedModule == null) return\n\n    if (!isVirtualFile(resolvedModule.resolvedFileName)) return\n    const externalComponentFilename = getContainingFile(\n      resolvedModule.resolvedFileName,\n    )\n\n    const componentDoc = h.getVueDocument(externalComponentFilename)\n    if (componentDoc == null) return\n\n    const externalComponentInfo = h.getComponentInfo(componentDoc)\n    const prop = externalComponentInfo.props.find((prop) => prop.name === name)\n    if (prop == null) return\n\n    return {\n      textSpan: {\n        start: node.loc.start.offset,\n        length: name.length,\n      },\n      definitions: [\n        {\n          name: prop.name,\n          kind: context.typescript.ScriptElementKind.jsxAttribute,\n          fileName: componentDoc.fsPath,\n          textSpan: {\n            start: prop.loc.start.offset,\n            length: prop.loc.source.length,\n          },\n          containerKind: context.typescript.ScriptElementKind.unknown,\n          containerName: '',\n          contextSpan:\n            externalComponentInfo.options?.properties.props != null\n              ? {\n                  start:\n                    externalComponentInfo.options.properties.props.loc.start\n                      .offset,\n                  length:\n                    externalComponentInfo.options.properties.props.loc.source\n                      .length,\n                }\n              : undefined,\n        },\n      ],\n    }\n  },\n}\n","import {\n  findTemplateNodeAt,\n  isAttributeNode,\n  isElementNode,\n  isSimpleExpressionNode,\n} from '@vuedx/template-ast-types'\nimport { RenderFunctionTextDocument } from '@vuedx/vue-virtual-textdocument'\nimport { TS } from '../../interfaces'\nimport { GotoProvider } from './abstract'\n\nexport const GotoScriptDefinitions: GotoProvider = {\n  version: '*',\n  getDefinitionAndBoundSpan(\n    { helpers: h, context, service },\n    fileName,\n    position,\n  ) {\n    const document = h.getRenderDoc(fileName)\n    if (document == null) return\n\n    const location = document.getGeneratedOffsetAt(position)\n    if (location == null) return\n\n    const result = service.getDefinitionAndBoundSpan(fileName, location.offset)\n    if (result == null) return\n\n    let isTextSpanSet = false\n    const definitions: TS.DefinitionInfo[] = []\n    const nodeAtCursor = h.findTemplateNodeAtPosition(document.fsPath, position)\n\n    result.definitions?.forEach((definition) => {\n      if (h.isRenderFunctionFileName(definition.fileName)) {\n        if (definition.fileName !== document.fsPath) {\n          if (__DEV__)\n            context.debug(\n              `Unexpected bound span in ${document.fsPath} resolved to ${definition.fileName}`,\n            )\n          return\n        }\n\n        if (!document.isInGeneratedRange(definition.textSpan.start)) {\n          const newResult = service.getDefinitionAndBoundSpan(\n            definition.fileName,\n            definition.textSpan.start,\n          )\n\n          if (\n            newResult != null &&\n            Array.isArray(newResult.definitions) &&\n            newResult.definitions.length > 0\n          ) {\n            // TODO: Resolved contextSpan if `newResult` is resolved as return from setup()\n            definitions.push(...newResult.definitions)\n          } else if (definition.kind === 'var') {\n            const componentInfo = h.getComponentInfo(document.container)\n            const prop = componentInfo.props.find(\n              (prop) => prop.name === definition.name,\n            )\n\n            if (prop != null) {\n              definitions.push({\n                ...definition,\n                fileName: document.container.fsPath,\n                textSpan: {\n                  start: prop.loc.start.offset,\n                  length: prop.loc.source.length,\n                },\n                containerKind: context.typescript.ScriptElementKind.unknown,\n                containerName: '',\n                contextSpan:\n                  componentInfo.options?.properties.props != null\n                    ? {\n                        start:\n                          componentInfo.options.properties.props.loc.start\n                            .offset,\n                        length:\n                          componentInfo.options.properties.props.loc.source\n                            .length,\n                      }\n                    : undefined,\n              })\n            }\n          }\n        } else {\n          const textSpan = h.getTextSpan(\n            document,\n            definition.textSpan,\n            nodeAtCursor.node,\n          )\n          if (textSpan !== definition.textSpan) {\n            isTextSpanSet = true\n            definition.textSpan = textSpan\n            if (definition.contextSpan != null) {\n              definition.contextSpan = h.getTextSpan(\n                document,\n                definition.contextSpan,\n                nodeAtCursor.node,\n              )\n            }\n            definition.fileName = document.container.fsPath\n            definitions.push(definition)\n          }\n        }\n      } else {\n        definitions.push(definition)\n      }\n    })\n    result.definitions = definitions\n\n    if (!isTextSpanSet) {\n      if (isSimpleExpressionNode(nodeAtCursor.node)) {\n        result.textSpan = h.getTextSpan(\n          document,\n          result.textSpan,\n          nodeAtCursor.node,\n        )\n      } else {\n        const textSpan: TS.TextSpan | null = getTextSpan(document, position)\n        if (textSpan != null) result.textSpan = textSpan\n      }\n    }\n\n    return result\n  },\n}\n\nfunction getTextSpan(\n  document: RenderFunctionTextDocument,\n  position: number,\n): TS.TextSpan | null {\n  if (document.ast == null) return null\n\n  const targetNode = findTemplateNodeAt(document.ast, position)\n  if (targetNode?.node == null) return null\n\n  if (isAttributeNode(targetNode.node)) {\n    return {\n      start: targetNode.node.loc.start.offset,\n      length: targetNode.node.name.length,\n    }\n  } else if (isElementNode(targetNode.node)) {\n    return {\n      start: targetNode.node.loc.start.offset + 1,\n      length: targetNode.node.tag.length,\n    }\n  } else {\n    return {\n      start: targetNode.node.loc.start.offset,\n      length: targetNode.node.loc.source.length,\n    }\n  }\n}\n","import { GotoExternalComponentProp } from './goto-external-component-prop'\nimport { GotoScriptDefinitions } from './goto-script-definitions'\n\nexport const GOTO_PROVIDERS = [GotoScriptDefinitions, GotoExternalComponentProp]\n","import { isSimpleExpressionNode } from '@vuedx/template-ast-types'\nimport { RenameProvider } from './abstract'\n\nexport const RenameExpression: RenameProvider = {\n  version: '*',\n  name: 'expression',\n  canRename(config, fileName, position, preferences) {\n    const { node, document } = config.helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n\n    if (isSimpleExpressionNode(node) && document != null) {\n      const mappedPosition = document.getGeneratedOffsetAt(position)\n\n      if (mappedPosition?.offset != null) {\n        const result = config.service.getRenameInfo(\n          fileName,\n          mappedPosition.offset,\n          preferences,\n        )\n\n        if (result.canRename) {\n          if (result.displayName === '$event') {\n            return {\n              canRename: false,\n              localizedErrorMessage:\n                '$event is builtin variable, it cannot be renamed.',\n            }\n          }\n\n          result.triggerSpan = config.helpers.getTextSpan(\n            document,\n            result.triggerSpan,\n          )\n        }\n\n        return result\n      }\n\n      return {\n        canRename: false,\n        localizedErrorMessage:\n          'Cannot find mapped position in render function.',\n      }\n    }\n  },\n  applyRename(config, fileName, position, findInStrings, findInComments) {\n    const { node, document } = config.helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n\n    if (isSimpleExpressionNode(node) && document != null) {\n      const mappedPosition = document.getGeneratedOffsetAt(position)\n\n      if (mappedPosition?.offset != null) {\n        const result = config.service\n          .findRenameLocations(\n            fileName,\n            mappedPosition.offset,\n            findInStrings,\n            findInComments,\n          )\n          ?.slice()\n\n        return result\n      }\n    }\n  },\n  applyFileRename() {\n    return undefined\n  },\n}\n","import { isPlainElementNode, PlainElementNode } from '@vuedx/template-ast-types'\nimport { TS } from '../../interfaces'\nimport { RenameProvider } from './abstract'\n\nexport const RenameElementTag: RenameProvider = {\n  version: '*',\n  name: 'element-tag',\n  canRename(config, fileName, position) {\n    const { node } = config.helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n    if (isPlainElementNode(node) && isPositionInTagName(position, node)) {\n      return {\n        canRename: true,\n        displayName: node.tag,\n        fullDisplayName: node.tag,\n        kind: config.context.typescript.ScriptElementKind.unknown,\n        kindModifiers: 'elementTagName',\n        triggerSpan: {\n          start: node.loc.start.offset + 1,\n          length: node.tag.length,\n        },\n      }\n    }\n  },\n  applyRename(config, fileName, position) {\n    const { node, document } = config.helpers.findTemplateNodeAtPosition(\n      fileName,\n      position,\n    )\n    if (\n      isPlainElementNode(node) &&\n      isPositionInTagName(position, node) &&\n      document != null\n    ) {\n      const locations: TS.RenameLocation[] = [\n        {\n          fileName: document.container.fsPath,\n          textSpan: {\n            start: node.loc.start.offset + 1,\n            length: node.tag.length,\n          },\n        },\n      ]\n\n      if (!node.isSelfClosing) {\n        locations.push({\n          fileName: document.container.fsPath,\n          textSpan: {\n            start:\n              node.loc.start.offset +\n              node.loc.source.lastIndexOf('</' + node.tag) +\n              2,\n            length: node.tag.length,\n          },\n        })\n      }\n\n      return locations\n    }\n  },\n  applyFileRename() {\n    return undefined\n  },\n}\n\nfunction isPositionInTagName(\n  position: number,\n  node: PlainElementNode,\n): boolean {\n  return (\n    // In start tag.\n    position <= node.loc.start.offset + node.tag.length ||\n    // In end tag.\n    (!node.isSelfClosing &&\n      node.loc.start.offset + node.loc.source.lastIndexOf('</') <= position)\n  )\n}\n","import { RenameExpression } from './expression';\nimport { RenameComponentTag } from './component-tag';\nimport { RenameElementTag } from './element-tag';\n\nexport const RENAME_PROVIDERS = [RenameExpression, RenameComponentTag, RenameElementTag];\n","import { isNotNull } from '@vuedx/shared'\nimport { isElementNode } from '@vuedx/template-ast-types'\nimport { getContainingFile } from '@vuedx/vue-virtual-textdocument'\nimport { TEMPLATE_COMPLETION_PROVIDERS } from '../features/completions'\nimport { TEMPLATE_DIAGNOSTICS_PROVIDERS } from '../features/diagnostics'\nimport { GOTO_PROVIDERS } from '../features/goto'\nimport { REFACTOR_PROVIDERS } from '../features/refactors'\nimport { RENAME_PROVIDERS } from '../features/renames'\nimport { wrapObject } from '../helpers/logger'\nimport { TS } from '../interfaces'\nimport { LanguageServiceOptions } from '../types'\nimport { noop } from './noop'\ninterface AdditionalFunctions {\n  getEditsForFileRenameIn(\n    fileName: string,\n    oldFilePath: string,\n    newFilePath: string,\n  ): TS.FileTextChanges[]\n}\n\nexport const forAliasRE = /([\\s\\S]*?)\\s+(?:in|of)\\s+([\\s\\S]*)/\nexport function createTemplateLanguageServer(\n  config: LanguageServiceOptions,\n): TS.LanguageService & AdditionalFunctions {\n  const { helpers: h, context, service } = config\n  const choose = (fileName: string): TS.LanguageService => {\n    return h.getLanguageServiceFor(fileName, service)\n  }\n\n  return wrapObject('TemplateLanguageServer', {\n    ...noop,\n\n    getCompletionsAtPosition(fileName, position, options) {\n      const result: TS.CompletionInfo = {\n        isGlobalCompletion: false,\n        isMemberCompletion: false,\n        isNewIdentifierLocation: false,\n        entries: [],\n      }\n\n      for (const provider of TEMPLATE_COMPLETION_PROVIDERS) {\n        const providerResults = provider.getCompletionsAtPosition(\n          config,\n          fileName,\n          position,\n          options,\n        )\n        if (isNotNull(providerResults)) {\n          result.entries.push(...providerResults.entries)\n        }\n      }\n\n      return result\n    },\n\n    getCompletionEntryDetails(\n      fileName,\n      position,\n      entryName,\n      formatOptions,\n      source,\n      preferences,\n    ) {\n      for (const provider of TEMPLATE_COMPLETION_PROVIDERS) {\n        const result = provider.getCompletionEntryDetails(\n          config,\n          fileName,\n          position,\n          entryName,\n          formatOptions,\n          source,\n          preferences,\n        )\n        if (isNotNull(result)) {\n          __DEV__ &&\n            context.debug(\n              `getCompletionEntryDetails got result from \"${provider.name}\"`,\n            )\n          return result\n        }\n      }\n    },\n\n    getCompletionEntrySymbol(fileName, position, name, source) {\n      for (const provider of TEMPLATE_COMPLETION_PROVIDERS) {\n        const result = provider.getCompletionEntrySymbol(\n          config,\n          fileName,\n          position,\n          name,\n          source,\n        )\n        if (isNotNull(result)) return result\n      }\n    },\n\n    getSignatureHelpItems(fileName, position, options) {\n      const document = h.getRenderDoc(fileName)\n      const loc = document?.getGeneratedOffsetAt(position)\n\n      if (loc != null && document != null) {\n        return choose(document.fsPath).getSignatureHelpItems(\n          document.fsPath,\n          loc.offset,\n          options,\n        )\n      }\n    },\n\n    getQuickInfoAtPosition(fileName, position) {\n      const document = h.getRenderDoc(fileName)\n      if (document == null) return\n\n      const loc = document.getGeneratedOffsetAt(position)\n      if (loc == null) return\n\n      const nodeAtCursor = h.findTemplateNodeAtPosition(\n        document.fsPath,\n        position,\n      )\n      const result = choose(document.fsPath).getQuickInfoAtPosition(\n        fileName,\n        loc.offset,\n      )\n\n      if (result != null) {\n        const textSpan = h.getTextSpan(\n          document,\n          result.textSpan,\n          nodeAtCursor.node,\n        )\n        if (textSpan != null) {\n          result.textSpan = textSpan\n        } else {\n          return\n        }\n        result.displayParts?.forEach((displayPart) => {\n          if (displayPart.text === 'JSX attribute') {\n            displayPart.text = 'prop' // TODO: Maybe event or prop or attribute?\n          }\n        })\n      }\n      return result\n    },\n\n    getSemanticDiagnostics(fileName) {\n      const document = h.getRenderDoc(fileName)\n      if (document == null) return []\n\n      const diagnostics = TEMPLATE_DIAGNOSTICS_PROVIDERS.map((provider) =>\n        provider.semantic(config, fileName),\n      ).flat()\n\n      return diagnostics\n    },\n\n    getSuggestionDiagnostics(fileName) {\n      const document = h.getRenderDoc(fileName)\n      if (document == null) return []\n\n      const diagnostics = TEMPLATE_DIAGNOSTICS_PROVIDERS.map((provider) =>\n        provider.suggestions(config, fileName),\n      ).flat()\n\n      return diagnostics\n    },\n\n    getSyntacticDiagnostics(fileName) {\n      const document = h.getRenderDoc(fileName)\n      if (document == null) return []\n\n      const diagnostics = TEMPLATE_DIAGNOSTICS_PROVIDERS.map((provider) =>\n        provider.syntax(config, fileName),\n      ).flat()\n\n      return diagnostics\n    },\n\n    getRenameInfo(fileName, position, preferences = {}): TS.RenameInfo {\n      for (const provider of RENAME_PROVIDERS) {\n        const result = provider.canRename(\n          config,\n          fileName,\n          position,\n          preferences,\n        )\n        if (result != null) {\n          __DEV__ &&\n            context.debug(`found getRenameInfo using \"${provider.name}\"`)\n\n          return result\n        }\n      }\n\n      return {\n        canRename: false,\n        localizedErrorMessage: 'You cannot rename this element.',\n      }\n    },\n\n    findRenameLocations(fileName, position, findInStrings, findInComments) {\n      for (const provider of RENAME_PROVIDERS) {\n        const result = provider.applyRename(\n          config,\n          fileName,\n          position,\n          findInStrings,\n          findInComments,\n        )\n\n        if (result != null) {\n          if (__DEV__)\n            context.debug(`found findRenameLocations using \"${provider.name}\"`)\n\n          return result\n        }\n      }\n    },\n\n    getEditsForFileRenameIn(fileName, oldFilePath, newFilePath) {\n      const fileTextChanges: TS.FileTextChanges[] = []\n      for (const provider of RENAME_PROVIDERS) {\n        const result = provider.applyFileRename(\n          config,\n          fileName,\n          oldFilePath,\n          newFilePath,\n          {},\n          {},\n        )\n        if (result != null) fileTextChanges.push(...result)\n      }\n\n      return fileTextChanges\n    },\n\n    getApplicableRefactors(fileName, position, preferences = {}) {\n      const refactors: TS.ApplicableRefactorInfo[] = []\n\n      for (const provider of REFACTOR_PROVIDERS) {\n        const result = provider.findRefactors(\n          config,\n          fileName,\n          position,\n          preferences,\n        )\n\n        if (result != null) refactors.push(...result)\n      }\n\n      return refactors\n    },\n\n    getEditsForRefactor(\n      fileName,\n      formatOptions,\n      positionOrRange,\n      refactorName,\n      actionName,\n      preferences = {},\n    ) {\n      const provider = REFACTOR_PROVIDERS.find(\n        (provider) => provider.name === refactorName,\n      )\n\n      if (provider != null) {\n        if (__DEV__) context.debug(`Using ${provider.name}`)\n        return provider.applyRefactor(\n          config,\n          fileName,\n          formatOptions,\n          positionOrRange,\n          refactorName,\n          actionName,\n          preferences,\n        )\n      }\n    },\n\n    getDefinitionAndBoundSpan(\n      fileName,\n      position,\n    ): TS.DefinitionInfoAndBoundSpan | undefined {\n      for (const provider of GOTO_PROVIDERS) {\n        const result = provider.getDefinitionAndBoundSpan(\n          config,\n          fileName,\n          position,\n        )\n\n        if (result != null) return result\n      }\n    },\n\n    getJsxClosingTagAtPosition(fileName, position) {\n      const { node } = h.findTemplateNodeAtPosition(\n        getContainingFile(fileName),\n        position - 1,\n      )\n\n      if (isElementNode(node)) {\n        if (node.isSelfClosing && node.loc.source.trim().endsWith('/>')) return\n        if (node.loc.source.trim().endsWith(`</${node.tag}>`)) return\n        return { newText: `</${node.tag}>` }\n      }\n    },\n  })\n}\n","import {\n  isSimpleExpressionNode,\n  isSimpleIdentifier,\n  traverseEvery,\n} from '@vuedx/template-ast-types'\nimport {\n  INTERNAL_MODULE_SELECTOR,\n  isVirtualFile,\n  isVueFile,\n  MODULE_SELECTOR,\n  RENDER_SELECTOR,\n  SCRIPT_BLOCK_SELECTOR,\n  SCRIPT_SETUP_BLOCK_SELECTOR,\n  VirtualTextDocument,\n  VIRTUAL_FILENAME_SEPARATOR,\n} from '@vuedx/vue-virtual-textdocument'\nimport { SFCCompletionService } from '../features/completions/SFCCompletionProvider'\nimport { SCRIPT_REFACTOR_PROVIDERS } from '../features/refactors'\nimport { REFACTORS } from '../features/refactors/abstract'\nimport { getChangesForComponentTagRename } from '../features/renames/component-tag'\nimport { traceObject, wrapObject } from '../helpers/logger'\nimport { isSpanInSourceRange } from '../helpers/utils'\nimport { TS } from '../interfaces'\nimport { LanguageServiceOptions } from '../types'\nimport { noop } from './noop'\nimport { createTemplateLanguageServer } from './template'\nconst IGNORED_SELECTORS = new Set([MODULE_SELECTOR, INTERNAL_MODULE_SELECTOR])\nexport function createVueLanguageServer(\n  options: LanguageServiceOptions,\n): TS.LanguageService {\n  const template = createTemplateLanguageServer(options)\n  const { helpers: h, service, context } = options\n  const script = wrapObject('ScriptLanguageServer', service)\n  const completionProvider = new SFCCompletionService(options)\n\n  function choose(\n    document: VirtualTextDocument,\n    isSyntaxOnly: boolean = false,\n  ): TS.LanguageService {\n    if (h.isRenderFunctionDocument(document)) {\n      return template\n    }\n\n    return isSyntaxOnly\n      ? script\n      : h.getLanguageServiceFor(document.fsPath, script)\n  }\n\n  function isSupportLanguage(lang: string): boolean {\n    return /^(javascript|typescript|javascriptreact|typescriptreact)$/i.test(\n      lang,\n    )\n  }\n\n  return wrapObject('VueLanguageService', {\n    ...noop,\n    ...traceObject<Partial<TS.LanguageService>>('VueLanguageService', {\n      getSemanticDiagnostics(fileName) {\n        if (!h.isFeatureEnabled('diagnostics', 'semantic')) {\n          return []\n        }\n\n        const diagnostics: TS.Diagnostic[] = []\n        h.getAllDocuments(fileName).forEach((virtual) => {\n          if (\n            isSupportLanguage(virtual.languageId) &&\n            !IGNORED_SELECTORS.has(virtual.selector.type)\n          ) {\n            const results = choose(virtual).getSemanticDiagnostics(\n              virtual.fsPath,\n            )\n            diagnostics.push(...results)\n          }\n        })\n\n        diagnostics.forEach((diagnostic) => {\n          if (diagnostic.code >= 59000) {\n            diagnostic.source = 'VueDX'\n          } else {\n            diagnostic.source = 'VueDX/TS'\n          }\n        })\n\n        return diagnostics\n      },\n\n      getSuggestionDiagnostics(fileName) {\n        if (!h.isFeatureEnabled('diagnostics', 'suggestion')) {\n          return []\n        }\n\n        const diagnostics: TS.DiagnosticWithLocation[] = []\n        h.getAllDocuments(fileName).forEach((virtual) => {\n          if (__DEV__)\n            context.debug(`${virtual.languageId} => ${virtual.fsPath} `)\n          if (\n            isSupportLanguage(virtual.languageId) &&\n            !IGNORED_SELECTORS.has(virtual.selector.type)\n          ) {\n            const results = choose(virtual).getSuggestionDiagnostics(\n              virtual.fsPath,\n            )\n            diagnostics.push(...results)\n          }\n        })\n\n        diagnostics.forEach((diagnostic) => {\n          if (diagnostic.code >= 59000) {\n            diagnostic.source = 'VueDX'\n          } else {\n            diagnostic.source = 'VueDX/TS'\n          }\n        })\n        return diagnostics\n      },\n\n      getSyntacticDiagnostics(fileName) {\n        if (!h.isFeatureEnabled('diagnostics', 'syntactic')) {\n          return []\n        }\n\n        const diagnostics: TS.DiagnosticWithLocation[] = []\n        h.getAllDocuments(fileName).forEach((virtual) => {\n          if (__DEV__)\n            context.debug(`${virtual.languageId} => ${virtual.fsPath} `)\n          if (\n            isSupportLanguage(virtual.languageId) &&\n            !IGNORED_SELECTORS.has(virtual.selector.type)\n          ) {\n            const results = choose(virtual).getSyntacticDiagnostics(\n              virtual.fsPath,\n            )\n            diagnostics.push(...results)\n          }\n        })\n\n        diagnostics.forEach((diagnostic) => {\n          if (diagnostic.code >= 59000) {\n            diagnostic.source = 'VueDX'\n          } else {\n            diagnostic.source = 'VueDX/TS'\n          }\n        })\n\n        return diagnostics\n      },\n\n      organizeImports(scope, formatOptions, preferences) {\n        if (!h.isFeatureEnabled('organizeImports')) return []\n\n        const document = h.getVueDocument(scope.fileName)\n        if (document != null) {\n          // TODO: Organize imports in both <script> and <script setup>\n          const virtual =\n            document.getDocument('script') ??\n            document.getDocument('scriptSetup')\n          if (virtual != null) {\n            return script.organizeImports(\n              { ...scope, fileName: virtual.fsPath },\n              formatOptions,\n              preferences,\n            )\n          }\n        }\n\n        return []\n      },\n\n      getQuickInfoAtPosition(fileName, position): TS.QuickInfo | undefined {\n        if (!h.isFeatureEnabled('quickInfo')) return\n\n        // TODO: Provide better quick info for components and props.\n        const document = h.getDocumentAt(fileName, position)\n        if (document != null)\n          return choose(document).getQuickInfoAtPosition(\n            document.fsPath,\n            position,\n          )\n      },\n\n      getRenameInfo(fileName, position, options): TS.RenameInfo {\n        if (!h.isFeatureEnabled('rename')) {\n          return {\n            canRename: false,\n            localizedErrorMessage: 'Rename feature disabled.',\n          }\n        }\n\n        const document = h.getDocumentAt(fileName, position)\n        if (document == null) {\n          return {\n            canRename: false,\n            localizedErrorMessage: 'Cannot rename this entity.',\n          }\n        }\n\n        const result = choose(document).getRenameInfo(\n          document.fsPath,\n          position,\n          options,\n        )\n\n        return result\n      },\n\n      findRenameLocations(\n        fileName,\n        position,\n        findInStrings,\n        findInComments,\n      ): readonly TS.RenameLocation[] | undefined {\n        if (!h.isFeatureEnabled('rename')) return\n\n        const document = h.getDocumentAt(fileName, position)\n        if (document == null) return\n\n        const locations = choose(document)\n          .findRenameLocations(\n            document.fsPath,\n            position,\n            findInStrings,\n            findInComments,\n          )\n          ?.slice()\n        // TODO: Refactor this 🤷‍♂️\n        if (locations != null && locations.length > 0) {\n          const result = choose(document).getRenameInfo(\n            document.fsPath,\n            position,\n            {\n              allowRenameOfImportPath: false,\n            },\n          )\n          if (result.canRename) {\n            const info = h.getComponentInfo(document.container)\n            if (!h.isRenderFunctionDocument(document)) {\n              // Maybe component got renamed\n              const component = info.components.find(\n                (component) => component.name === result.displayName,\n              )\n              if (\n                component != null &&\n                locations.some(\n                  (loc) =>\n                    isSpanInSourceRange(loc.textSpan, component.loc) ||\n                    isSpanInSourceRange(loc.textSpan, component.source.loc),\n                )\n              ) {\n                const doc = h.getRenderDoc(document.fsPath)\n                if (doc?.ast != null) {\n                  getChangesForComponentTagRename(doc.ast, component).forEach(\n                    (textSpan) => {\n                      locations.push({ fileName, textSpan })\n                    },\n                  )\n                }\n              } else if (\n                (info.options != null &&\n                  isSpanInSourceRange(result.triggerSpan, info.options.loc)) ||\n                (info.fnSetupOption?.return != null &&\n                  isSpanInSourceRange(\n                    result.triggerSpan,\n                    info.fnSetupOption.return.loc,\n                  ))\n              ) {\n                if (isSimpleIdentifier(result.displayName)) {\n                  const property = Object.entries(\n                    info.options?.properties ?? {\n                      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                      setup: info.fnSetupOption!.return!,\n                    },\n                  ).find(([_, value]) =>\n                    isSpanInSourceRange(result.triggerSpan, value.loc),\n                  )\n\n                  if (property != null) {\n                    switch (property[0]) {\n                      case 'data':\n                      case 'methods':\n                      case 'computed':\n                      case 'props':\n                      case 'emits':\n                      case 'setup':\n                        {\n                          const render = h.getRenderDoc(fileName)\n                          if (render?.ast != null) {\n                            if (\n                              render.ast.scope.identifiers.includes(\n                                result.displayName,\n                              )\n                            ) {\n                              // Find an expression using this identifiers.\n\n                              let isDone = false\n                              traverseEvery(render.ast, (node) => {\n                                if (isDone) return false\n                                if (\n                                  isSimpleExpressionNode(node) &&\n                                  node.scope.identifiers.includes(\n                                    result.displayName,\n                                  )\n                                ) {\n                                  const binding = node.scope.getBinding(\n                                    result.displayName,\n                                  )\n\n                                  if (binding == null) {\n                                    isDone = true\n                                    if (__DEV__)\n                                      context.debug(\n                                        'found expression usage in template',\n                                      )\n                                    const additionalLocations = template.findRenameLocations(\n                                      document.container.getDocumentFileName(\n                                        RENDER_SELECTOR,\n                                      ),\n                                      node.loc.start.offset +\n                                        node.content.indexOf(\n                                          result.displayName,\n                                        ) +\n                                        1,\n                                      findInStrings,\n                                      findInComments,\n                                    )\n\n                                    if (additionalLocations != null) {\n                                      if (__DEV__)\n                                        context.debug(\n                                          'found additional change locations',\n                                        )\n                                      locations.push(...additionalLocations)\n                                    }\n\n                                    return false // stop\n                                  }\n                                }\n                                return true\n                              })\n                            }\n                          }\n                        }\n                        break\n                    }\n                  }\n                }\n              }\n            } else {\n              if (isSimpleIdentifier(result.displayName)) {\n                const source = info.identifierSource[result.displayName.trim()]\n                if (source != null) {\n                  const scriptFileName =\n                    document.container.descriptor.scriptSetup != null\n                      ? document.container.getDocumentFileName(\n                          SCRIPT_SETUP_BLOCK_SELECTOR,\n                        )\n                      : document.container.getDocumentFileName(\n                          SCRIPT_BLOCK_SELECTOR,\n                        )\n                  const additionalLocations = script.findRenameLocations(\n                    scriptFileName,\n                    source.loc.start.offset,\n                    findInStrings,\n                    findInComments,\n                  )\n                  if (additionalLocations != null) {\n                    locations.push(...additionalLocations)\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        return locations\n      },\n\n      getEditsForFileRename(\n        oldFilePath,\n        newFilePath,\n        formatOptions,\n        preferences,\n      ): TS.FileTextChanges[] {\n        if (!h.isFeatureEnabled('rename')) return []\n\n        const document = h.getVueDocument(oldFilePath)\n        const fileTextChanges: TS.FileTextChanges[] = []\n        const visited = new Set<string>()\n\n        if (document != null) {\n          const component = document.getDocument(MODULE_SELECTOR)\n          const currentChanges = script.getEditsForFileRename(\n            component.fsPath,\n            isVueFile(newFilePath)\n              ? newFilePath + VIRTUAL_FILENAME_SEPARATOR + MODULE_SELECTOR\n              : newFilePath,\n            formatOptions,\n            preferences,\n          )\n\n          fileTextChanges.push(...currentChanges)\n\n          currentChanges.forEach((item) => {\n            if (isVirtualFile(item.fileName) || isVueFile(item.fileName)) {\n              const render = h\n                .getVueDocument(item.fileName)\n                ?.getDocument('_render')\n              if (render != null && !visited.has(render.fsPath)) {\n                visited.add(render.fsPath)\n                fileTextChanges.push(\n                  ...template.getEditsForFileRenameIn(\n                    render.fsPath,\n                    oldFilePath,\n                    newFilePath,\n                  ),\n                )\n              }\n            }\n          })\n        }\n\n        return fileTextChanges\n      },\n\n      getApplicableRefactors(fileName, position, preferences) {\n        if (!h.isFeatureEnabled('refactor')) return []\n\n        const document = h.getDocumentAt(fileName, position)\n        const result: TS.ApplicableRefactorInfo[] =\n          document != null\n            ? choose(document).getApplicableRefactors(\n                document.fsPath,\n                position,\n                preferences,\n              )\n            : []\n\n        if (document != null && !h.isRenderFunctionDocument(document)) {\n          SCRIPT_REFACTOR_PROVIDERS.forEach((provider) => {\n            result.push(\n              ...provider.findRefactors(\n                options,\n                document.fsPath,\n                position,\n                preferences,\n              ),\n            )\n          })\n        }\n\n        return result\n      },\n\n      getEditsForRefactor(\n        fileName,\n        formatOptions,\n        positionOrRange,\n        refactorName,\n        actionName,\n        preferences,\n      ) {\n        if (!h.isFeatureEnabled('refactor')) return\n        const document = h.getDocumentAt(fileName, positionOrRange)\n        if (document != null) {\n          const provider = SCRIPT_REFACTOR_PROVIDERS.find(\n            (provider) => provider.name === refactorName,\n          )\n\n          if (provider != null) {\n            return provider.applyRefactor(\n              options,\n              document.fsPath,\n              formatOptions,\n              positionOrRange,\n              refactorName,\n              actionName,\n              preferences,\n            )\n          }\n\n          const result = choose(document).getEditsForRefactor(\n            document.fsPath,\n            formatOptions,\n            positionOrRange,\n            refactorName,\n            actionName,\n            preferences,\n          )\n\n          if (result?.renameLocation != null) {\n            const isExtractComponent =\n              refactorName === REFACTORS.EXTRACT_COMPONENT\n            const renameLocation = result.renameLocation\n            let delta = 0\n            result.edits.forEach((edit) => {\n              if (edit.fileName === fileName) {\n                edit.textChanges.forEach((textChange) => {\n                  if (\n                    textChange.span.start + textChange.span.length <\n                      renameLocation &&\n                    (!isExtractComponent ||\n                      // For extract-component, renameLocation should be generated import statement.\n                      textChange.span.start -\n                        textChange.span.length +\n                        textChange.newText.length <\n                        renameLocation)\n                  ) {\n                    delta -= textChange.span.length\n                    delta += textChange.newText.length\n                  }\n                })\n              }\n            })\n\n            result.renameLocation = renameLocation + delta\n          }\n\n          return result\n        }\n      },\n\n      getDocumentHighlights(\n        fileName: string,\n        position: number,\n        filesToSearch: string[],\n      ): TS.DocumentHighlights[] | undefined {\n        const document = h.getDocumentAt(fileName, position)\n\n        if (document != null && !h.isRenderFunctionDocument(document)) {\n          return script.getDocumentHighlights(\n            document.fsPath,\n            position,\n            filesToSearch\n              .map((fileName) => {\n                if (isVueFile(fileName)) {\n                  const document = h.getVueDocument(fileName)\n                  if (document == null) return\n\n                  const script =\n                    document.getDocument('script') ??\n                    document.getDocument('scriptSetup')\n                  if (script == null) return\n\n                  return script.fsPath\n                }\n\n                return fileName\n              })\n              .filter(Boolean) as string[],\n          )\n        }\n      },\n\n      getCompletionsAtPosition(fileName, position, options) {\n        const document = h.getDocumentAt(fileName, position)\n        if (document != null) {\n          return choose(document).getCompletionsAtPosition(\n            document.fsPath,\n            position,\n            options,\n          )\n        } else {\n          return completionProvider.getCompletionsAtPosition(\n            fileName,\n            position,\n            options,\n          )\n        }\n      },\n\n      getCompletionEntryDetails(\n        fileName,\n        position,\n        entryName,\n        formatOptions,\n        source,\n        preferences,\n      ) {\n        const document = h.getDocumentAt(fileName, position)\n        if (document != null) {\n          return choose(document).getCompletionEntryDetails(\n            document.fsPath,\n            position,\n            entryName,\n            formatOptions,\n            source,\n            preferences,\n          )\n        } else {\n          return completionProvider.getCompletionEntryDetails(\n            fileName,\n            position,\n            entryName,\n            formatOptions,\n            source,\n            preferences,\n          )\n        }\n      },\n\n      getSignatureHelpItems(fileName, position, options) {\n        const document = h.getDocumentAt(fileName, position)\n\n        if (document != null) {\n          return choose(document).getSignatureHelpItems(\n            document.fsPath,\n            position,\n            options,\n          )\n        }\n      },\n\n      getCompletionEntrySymbol(fileName, position, name, source) {\n        const document = h.getDocumentAt(fileName, position)\n        if (document != null) {\n          return choose(document).getCompletionEntrySymbol(\n            document.fsPath,\n            position,\n            name,\n            source,\n          )\n        }\n\n        return completionProvider.getCompletionEntrySymbol(\n          fileName,\n          position,\n          name,\n          source,\n        )\n      },\n\n      getDefinitionAtPosition(\n        fileName: string,\n        position: number,\n      ): readonly TS.DefinitionInfo[] | undefined {\n        const document = h.getDocumentAt(fileName, position)\n\n        if (document != null) {\n          return choose(document).getDefinitionAtPosition(\n            document.fsPath,\n            position,\n          )\n        }\n      },\n\n      getDefinitionAndBoundSpan(\n        fileName: string,\n        position: number,\n      ): TS.DefinitionInfoAndBoundSpan | undefined {\n        if (!h.isFeatureEnabled('goto')) return\n\n        const document = h.getDocumentAt(fileName, position)\n\n        if (document != null) {\n          return choose(document).getDefinitionAndBoundSpan(\n            document.fsPath,\n            position,\n          )\n        }\n      },\n\n      getCodeFixesAtPosition(\n        fileName,\n        start,\n        end,\n        errorCodes,\n        formatOptions,\n        preferences,\n      ) {\n        const document = h.getDocumentAt(fileName, start)\n\n        if (document != null) {\n          return choose(document).getCodeFixesAtPosition(\n            document.fsPath,\n            start,\n            end,\n            errorCodes,\n            formatOptions,\n            preferences,\n          )\n        }\n        return []\n      },\n\n      getJsxClosingTagAtPosition(fileName, position) {\n        const document = h.getDocumentAt(fileName, position)\n\n        if (document != null) {\n          return choose(document, true).getJsxClosingTagAtPosition(\n            document.fsPath,\n            position,\n          )\n        }\n      },\n    }),\n  })\n}\n","import {\n  getComponentName as baseGetComponentName,\n  isNotNull,\n  pascalCase,\n} from '@vuedx/shared'\nimport {\n  getContainingFile,\n  INTERNAL_MODULE_SELECTOR,\n  isVirtualFile,\n  isVirtualFileOfType,\n  isVueFile,\n  MODULE_SELECTOR,\n  parseVirtualFileName,\n  RENDER_SELECTOR,\n  VirtualTextDocument,\n  VIRTUAL_FILENAME_SEPARATOR,\n} from '@vuedx/vue-virtual-textdocument'\nimport { ORIGINAL_LANGUAGE_SERVER } from '../constants'\nimport { PluginContext } from '../context'\nimport { wrapObject } from '../helpers/logger'\nimport { createServerHelper } from '../helpers/utils'\nimport { TS } from '../interfaces'\nimport {\n  registerComponentAPI,\n  registerLocalComponentWithSource,\n} from '../transforms/registerLocalComponent'\nimport { LanguageServiceOptions } from '../types'\nimport { createVirtualLanguageServer } from './virtual'\nimport { createVueLanguageServer } from './vue'\nexport class RoutingLanguageServer {\n  constructor(private readonly context: PluginContext) {}\n\n  decorate(languageService: TS.LanguageService): TS.LanguageService {\n    if (ORIGINAL_LANGUAGE_SERVER in languageService) {\n      return languageService\n    }\n\n    const proxy = createLanguageServiceRouter({\n      context: this.context,\n      service: wrapObject('TypeScriptLanguageService', languageService),\n      helpers: createServerHelper(this.context, languageService),\n    })\n\n    // @ts-expect-error 7053\n    proxy[ORIGINAL_LANGUAGE_SERVER] = languageService\n\n    return proxy\n  }\n}\n\nfunction createLanguageServiceRouter(\n  config: LanguageServiceOptions,\n): TS.LanguageService {\n  const vue = createVueLanguageServer(config)\n  const virtual = createVirtualLanguageServer(config)\n  const ts = config.service\n\n  function choose(fileName: string | undefined): TS.LanguageService {\n    if (fileName == null) return ts\n\n    return fileName.startsWith('^vue:')\n      ? virtual\n      : isVueFile(fileName) || isVirtualFile(fileName)\n      ? vue\n      : ts\n  }\n\n  function getTextSpan(\n    document: VirtualTextDocument,\n    span: TS.TextSpan,\n  ): TS.TextSpan | null {\n    if (config.helpers.isRenderFunctionDocument(document)) {\n      const result = document.getOriginalOffsetAt(span.start)\n      if (result != null) {\n        return {\n          start: result.offset,\n          length: Math.min(span.length, result.length),\n        }\n      }\n\n      return null\n    }\n\n    return span\n  }\n\n  const VIRTUAL_FILE_SUFFIX_RE = new RegExp(\n    `(?<=\\\\.vue)${VIRTUAL_FILENAME_SEPARATOR}([A-Za-z_][A-Za-z0-9_-]*)(\\\\.[jt]sx?)?`,\n    'g',\n  )\n\n  function getComponentName(fileName?: string): string | undefined {\n    if (fileName == null || !isVueFile(fileName)) return\n    return baseGetComponentName(fileName)\n  }\n\n  const COMPONENT_TYPE_RE = /'ComponentPublicInstance<.*?ComponentOptionsBase<...>>'/g\n  const REPLACE = {\n    virtualFile: (messageText: string) =>\n      messageText.replace(VIRTUAL_FILE_SUFFIX_RE, ''),\n    componentType: (fileName: string | undefined, messageText: string) => {\n      const component = getComponentName(fileName)\n      return component != null\n        ? messageText.replace(COMPONENT_TYPE_RE, `vue component '${component}'`)\n        : messageText\n    },\n  }\n  function applyReplacements(\n    fileName: string | undefined,\n    messageText: string,\n  ): string\n  function applyReplacements(\n    fileName: string | undefined,\n    messageText: TS.DiagnosticMessageChain,\n  ): TS.DiagnosticMessageChain\n  function applyReplacements(\n    fileName: string | undefined,\n    messageText: string | TS.DiagnosticMessageChain,\n  ): string | TS.DiagnosticMessageChain\n  function applyReplacements(\n    fileName: string | undefined,\n    messageText: string | TS.DiagnosticMessageChain,\n  ): string | TS.DiagnosticMessageChain {\n    if (typeof messageText === 'string') {\n      return REPLACE.componentType(fileName, REPLACE.virtualFile(messageText))\n    } else {\n      messageText.messageText = applyReplacements(\n        fileName,\n        messageText.messageText,\n      )\n\n      return messageText\n    }\n  }\n\n  function isVirtualSourceFile(file?: TS.SourceFile): file is TS.SourceFile {\n    return file != null && isVirtualFile(file.fileName)\n  }\n\n  const proxy = wrapObject<TS.LanguageService>('LanguageRoutingService', {\n    ...config.service,\n\n    getSyntacticDiagnostics(fileName) {\n      config.context.disposeUnusedProjects()\n\n      return choose(fileName)\n        .getSyntacticDiagnostics(fileName)\n        .map(createDiagnosticProcessor(fileName))\n        .filter(isNotNull)\n    },\n\n    getSemanticDiagnostics(fileName) {\n      config.context.disposeUnusedProjects()\n\n      return choose(fileName)\n        .getSemanticDiagnostics(fileName)\n        .map(createDiagnosticProcessor(fileName))\n        .filter(isNotNull)\n    },\n\n    getSuggestionDiagnostics(fileName) {\n      config.context.disposeUnusedProjects()\n\n      return choose(fileName)\n        .getSuggestionDiagnostics(fileName)\n        .map(createDiagnosticProcessor(fileName))\n        .filter(isNotNull)\n    },\n\n    getCompilerOptionsDiagnostics() {\n      return ts.getCompilerOptionsDiagnostics()\n    },\n\n    getEncodedSemanticClassifications(fileName, span) {\n      return ts.getEncodedSemanticClassifications(fileName, span)\n    },\n\n    getEncodedSyntacticClassifications(fileName, span) {\n      return ts.getEncodedSyntacticClassifications(fileName, span)\n    },\n\n    getCompletionsAtPosition(fileName, position, options) {\n      const completions = choose(fileName).getCompletionsAtPosition(\n        fileName,\n        position,\n        options,\n      )\n\n      if (completions?.entries != null) {\n        completions.entries = completions.entries.filter(\n          /**\n           * Remove all virtual entries expect completions originating\n           * from \"_module\" virtual file.\n           *\n           * Rewrite `source` with the containing `.vue` file of the\n           * \"_module\" virtual file.\n           *\n           * @see https://github.com/znck/vue-developer-experience/wiki/Virtual-File-System#module-virtual-file\n           */\n          (entry) => {\n            if (entry.source != null && isVirtualFile(entry.source)) {\n              if (isVirtualFileOfType(entry.source, '_module')) {\n                entry.source = getContainingFile(entry.source)\n                return true\n              } else {\n                return false\n              }\n            }\n\n            return true\n          },\n        )\n      }\n\n      return completions\n    },\n\n    getCompletionEntryDetails(\n      fileName,\n      position,\n      entryName,\n      formatOptions,\n      source,\n      preferences,\n    ) {\n      let details: TS.CompletionEntryDetails | undefined\n\n      /**\n       * If source is a `.vue` file then the completion is:\n       *\n       * 1. default export or component\n       * 2. named export\n       *\n       * A `.vue` file is always referenced with the \"_module\"\n       * virtual file in TypeScript language service. So we\n       * rewrite source to correct value.\n       *\n       * @see https://github.com/znck/vue-developer-experience/wiki/Virtual-File-System#module-virtual-file\n       */\n      if (source != null && isVueFile(source)) {\n        let newSource = source\n\n        // -> Rewrite source to _module virtual file.\n        newSource = `${source}${VIRTUAL_FILENAME_SEPARATOR}${MODULE_SELECTOR}`\n\n        details = choose(fileName).getCompletionEntryDetails(\n          fileName,\n          position,\n          entryName,\n          formatOptions,\n          newSource,\n          preferences,\n        )\n      } else {\n        details = choose(fileName).getCompletionEntryDetails(\n          fileName,\n          position,\n          entryName,\n          formatOptions,\n          source,\n          preferences,\n        )\n      }\n\n      if (isVueFile(fileName)) {\n        const project = config.context.getVueProjectForFile(fileName, true)\n        details?.codeActions?.forEach((codeAction) => {\n          codeAction.changes.forEach((change) => {\n            if (isVirtualFileOfType(change.fileName, RENDER_SELECTOR)) {\n              const document = config.helpers.getVueDocument(change.fileName)\n              if (change.textChanges.length > 0 && document != null) {\n                const block =\n                  document.descriptor.scriptSetup ?? document.descriptor.script\n\n                if (block == null) {\n                  const project = config.context.getVueProjectForFile(\n                    fileName,\n                    true,\n                  )\n                  change.textChanges = registerLocalComponentWithSource(\n                    document,\n                    config.helpers.getComponentInfo(document),\n                    { localName: pascalCase(entryName) },\n                    project.config.preferences.script,\n                    project.version,\n                    change.textChanges[0].newText,\n                  )\n                } else {\n                  change.textChanges.forEach((textChange) => {\n                    // We need to rewrite import statement to start of script block of .vue file\n                    if (block != null) {\n                      // Add import statement to start of <script> or <script setup> block\n                      textChange.span.start = block.loc.start.offset + 1\n                    }\n                  })\n\n                  change.textChanges = [\n                    ...change.textChanges,\n                    ...registerComponentAPI(\n                      document,\n                      config.helpers.getComponentInfo(document),\n                      'components',\n                      pascalCase(entryName),\n                      pascalCase(entryName),\n                      project.version,\n                      project.config.preferences.script,\n                    ).changes,\n                  ]\n                }\n              }\n            } else if (isVirtualFile(change.fileName)) {\n              // rewrite position to start of the block.\n              if (change.textChanges.length > 0) {\n                const document = config.helpers.getDocument(change.fileName)\n                if (document instanceof VirtualTextDocument) {\n                  const block = document.container.getBlock(\n                    document.selector as any,\n                  )\n\n                  if (block != null) {\n                    const start = Math.min(\n                      block.loc.start.offset + 1,\n                      block.loc.end.offset,\n                    )\n                    const end = block.loc.end.offset\n\n                    change.textChanges.forEach((textChange) => {\n                      textChange.span.start = Math.min(\n                        Math.max(start, textChange.span.start),\n                        end,\n                      )\n                    })\n                  }\n                }\n              }\n            }\n          })\n        })\n      }\n\n      details?.codeActions?.forEach((codeAction) => {\n        codeAction.description = codeAction.description.replace(\n          VIRTUAL_FILENAME_SEPARATOR + MODULE_SELECTOR,\n          '',\n        )\n\n        codeAction.changes.forEach((change) => {\n          change.textChanges.forEach((textChange) => {\n            textChange.newText = textChange.newText.replace(\n              VIRTUAL_FILENAME_SEPARATOR + MODULE_SELECTOR,\n              '',\n            )\n          })\n\n          if (isVirtualFile(change.fileName)) {\n            change.fileName = getContainingFile(change.fileName)\n          }\n        })\n      })\n\n      details?.source?.forEach((item) => {\n        if (isVirtualFile(item.text)) {\n          item.text = getContainingFile(item.text)\n        }\n      })\n\n      return details\n    },\n\n    getCompletionEntrySymbol(fileName, position, name, source) {\n      return choose(fileName).getCompletionEntrySymbol(\n        fileName,\n        position,\n        name,\n        source,\n      )\n    },\n\n    getQuickInfoAtPosition(fileName, position) {\n      const info = choose(fileName).getQuickInfoAtPosition(fileName, position)\n\n      if (info?.displayParts != null) {\n        info.displayParts = info.displayParts\n          .map((part) => {\n            part.text = applyReplacements(fileName, part.text)\n\n            return part\n          })\n          .filter(isNotNull)\n      }\n\n      if (info?.documentation != null) {\n        info.documentation = info.documentation\n          .map((part) => {\n            part.text = applyReplacements(fileName, part.text)\n\n            return part\n          })\n          .filter(isNotNull)\n      }\n\n      return info\n    },\n\n    getNameOrDottedNameSpan(fileName, startPos, endPos) {\n      return choose(fileName).getNameOrDottedNameSpan(\n        fileName,\n        startPos,\n        endPos,\n      )\n    },\n\n    getBreakpointStatementAtPosition(fileName, position) {\n      return choose(fileName).getBreakpointStatementAtPosition(\n        fileName,\n        position,\n      )\n    },\n\n    getSignatureHelpItems(fileName, position, options) {\n      return choose(fileName).getSignatureHelpItems(fileName, position, options)\n    },\n\n    getRenameInfo(fileName, position, options) {\n      const result = choose(fileName).getRenameInfo(fileName, position, options)\n\n      if (result.canRename) {\n        if (result.fileToRename != null && isVirtualFile(result.fileToRename)) {\n          result.fileToRename = getContainingFile(result.fileToRename)\n        }\n\n        result.displayName = REPLACE.virtualFile(result.displayName)\n        result.fullDisplayName = REPLACE.virtualFile(result.fullDisplayName)\n\n        if (\n          result.kind ===\n            config.context.typescript.ScriptElementKind.moduleElement &&\n          result.displayName.endsWith('.vue')\n        ) {\n          result.triggerSpan.length -= 4\n        }\n      }\n\n      return result\n    },\n\n    findRenameLocations(fileName, position, findInStrings, findInComments) {\n      const result = choose(fileName)\n        .findRenameLocations(fileName, position, findInStrings, findInComments)\n        ?.map((item) => {\n          if (isVirtualFile(item.fileName)) {\n            const virtual = config.helpers.getDocument(\n              item.fileName,\n            ) as VirtualTextDocument\n\n            item.fileName = virtual.container.fsPath\n            const textSpan = getTextSpan(virtual, item.textSpan)\n            if (textSpan == null) return\n\n            item.textSpan = textSpan\n            if (item.contextSpan != null) {\n              const contextSpan = getTextSpan(virtual, item.contextSpan)\n              if (contextSpan == null) return\n\n              item.contextSpan = contextSpan\n            }\n          }\n\n          return item\n        })\n        .filter(isNotNull)\n\n      return result\n    },\n\n    getSmartSelectionRange(fileName, position) {\n      return choose(fileName).getSmartSelectionRange(fileName, position)\n    },\n\n    getDefinitionAtPosition(\n      fileName: string,\n      position: number,\n    ): readonly TS.DefinitionInfo[] | undefined {\n      const result = choose(fileName).getDefinitionAtPosition(\n        fileName,\n        position,\n      )\n\n      if (result != null) {\n        result.forEach((definitionInfo) => {\n          if (isVirtualFile(definitionInfo.fileName)) {\n            definitionInfo.fileName = getContainingFile(definitionInfo.fileName)\n            definitionInfo.name = applyReplacements(\n              definitionInfo.fileName,\n              definitionInfo.name,\n            )\n          }\n        })\n      }\n\n      return result\n    },\n\n    getDefinitionAndBoundSpan(\n      fileName: string,\n      position: number,\n    ): TS.DefinitionInfoAndBoundSpan | undefined {\n      const result = choose(fileName).getDefinitionAndBoundSpan(\n        fileName,\n        position,\n      )\n\n      if (result?.definitions != null) {\n        result.definitions.forEach((definition) => {\n          if (isVirtualFile(definition.fileName)) {\n            if (config.helpers.isVueModuleFileName(definition.fileName)) {\n              const document = config.helpers.getVueDocument(\n                definition.fileName,\n              )\n              if (document?.descriptor != null) {\n                const script =\n                  document.descriptor.scriptSetup ?? document.descriptor.script\n\n                if (script != null) {\n                  // TODO: resolve to export default in <script> or <script setup>\n                  definition.name = baseGetComponentName(document.fsPath)\n\n                  const info = config.helpers.getComponentInfo(document)\n\n                  definition.textSpan = definition.contextSpan = {\n                    start: script.loc.start.offset,\n                    length: script.loc.end.offset - script.loc.start.offset,\n                  }\n\n                  if (info.options?.loc != null) {\n                    definition.textSpan = {\n                      start: info.options.loc.start.offset,\n                      length:\n                        info.options.loc.end.offset -\n                        info.options.loc.start.offset +\n                        1,\n                    }\n                  }\n                }\n              }\n            }\n\n            definition.fileName = getContainingFile(definition.fileName)\n          }\n        })\n      }\n\n      return result\n    },\n\n    getTypeDefinitionAtPosition(fileName, position) {\n      return choose(fileName).getTypeDefinitionAtPosition(fileName, position)\n    },\n\n    getImplementationAtPosition(fileName, position) {\n      return choose(fileName).getImplementationAtPosition(fileName, position)\n    },\n\n    getReferencesAtPosition(fileName, position) {\n      return choose(fileName).getReferencesAtPosition(fileName, position)\n    },\n\n    findReferences(fileName, position) {\n      return choose(fileName).findReferences(fileName, position)\n    },\n\n    getDocumentHighlights(\n      fileName: string,\n      position: number,\n      filesToSearch: string[],\n    ): TS.DocumentHighlights[] {\n      const result = choose(fileName).getDocumentHighlights(\n        fileName,\n        position,\n        filesToSearch,\n      )\n\n      if (result != null) {\n        result.forEach((highlights) => {\n          if (isVirtualFile(fileName)) {\n            highlights.fileName = getContainingFile(highlights.fileName)\n            highlights.highlightSpans.forEach((span) => {\n              if (span.fileName != null && isVirtualFile(span.fileName)) {\n                span.fileName = getContainingFile(span.fileName)\n              }\n            })\n          }\n        })\n      }\n\n      return result ?? []\n    },\n\n    getNavigateToItems(searchValue, maxResultCount, fileName, excludeDtsFiles) {\n      return choose(fileName).getNavigateToItems(\n        searchValue,\n        maxResultCount,\n        fileName,\n        excludeDtsFiles,\n      )\n    },\n\n    getNavigationBarItems(fileName) {\n      return choose(fileName).getNavigationBarItems(fileName)\n    },\n\n    getNavigationTree(fileName) {\n      return choose(fileName).getNavigationTree(fileName)\n    },\n\n    prepareCallHierarchy(fileName, position) {\n      return choose(fileName).prepareCallHierarchy(fileName, position)\n    },\n\n    provideCallHierarchyIncomingCalls(fileName, position) {\n      return choose(fileName).provideCallHierarchyIncomingCalls(\n        fileName,\n        position,\n      )\n    },\n\n    provideCallHierarchyOutgoingCalls(fileName, position) {\n      return choose(fileName).provideCallHierarchyOutgoingCalls(\n        fileName,\n        position,\n      )\n    },\n\n    getOutliningSpans(fileName) {\n      return choose(fileName).getOutliningSpans(fileName)\n    },\n\n    getTodoComments(fileName, descriptors) {\n      return choose(fileName).getTodoComments(fileName, descriptors)\n    },\n\n    getBraceMatchingAtPosition(fileName, position) {\n      return choose(fileName).getBraceMatchingAtPosition(fileName, position)\n    },\n\n    getIndentationAtPosition(fileName, position, options) {\n      return choose(fileName).getIndentationAtPosition(\n        fileName,\n        position,\n        options,\n      )\n    },\n\n    getFormattingEditsForRange(fileName, start, end, options) {\n      return choose(fileName).getFormattingEditsForRange(\n        fileName,\n        start,\n        end,\n        options,\n      )\n    },\n\n    getFormattingEditsForDocument(fileName, options) {\n      return choose(fileName).getFormattingEditsForDocument(fileName, options)\n    },\n\n    getFormattingEditsAfterKeystroke(fileName, position, key, options) {\n      return choose(fileName).getFormattingEditsAfterKeystroke(\n        fileName,\n        position,\n        key,\n        options,\n      )\n    },\n\n    getDocCommentTemplateAtPosition(fileName, position) {\n      return choose(fileName).getDocCommentTemplateAtPosition(\n        fileName,\n        position,\n      )\n    },\n\n    isValidBraceCompletionAtPosition(fileName, position, openingBrace) {\n      return choose(fileName).isValidBraceCompletionAtPosition(\n        fileName,\n        position,\n        openingBrace,\n      )\n    },\n\n    getJsxClosingTagAtPosition(fileName, position) {\n      return choose(fileName).getJsxClosingTagAtPosition(fileName, position)\n    },\n\n    getSpanOfEnclosingComment(fileName, position, onlyMultiLine) {\n      return choose(fileName).getSpanOfEnclosingComment(\n        fileName,\n        position,\n        onlyMultiLine,\n      )\n    },\n\n    toLineColumnOffset(fileName, position) {\n      return config.service.toLineColumnOffset != null\n        ? config.service.toLineColumnOffset(fileName, position)\n        : { line: 0, character: 0 }\n    },\n\n    getCodeFixesAtPosition(\n      fileName: string,\n      start: number,\n      end: number,\n      errorCodes: number[],\n      formatOptions: TS.FormatCodeOptions,\n      preferences: TS.UserPreferences,\n    ): readonly TS.CodeFixAction[] {\n      return choose(fileName)\n        .getCodeFixesAtPosition(\n          fileName,\n          start,\n          end,\n          errorCodes,\n          formatOptions,\n          preferences,\n        )\n        .filter((fix) => {\n          if (\n            fix.fixName === 'import' &&\n            fix.description.includes(VIRTUAL_FILENAME_SEPARATOR)\n          ) {\n            return fix.description.includes(\n              VIRTUAL_FILENAME_SEPARATOR + MODULE_SELECTOR,\n            )\n          }\n          return true\n        })\n        .map((fix) => {\n          if (fix.fixName === 'import') {\n            fix.description = fix.description.replace(\n              VIRTUAL_FILENAME_SEPARATOR + MODULE_SELECTOR,\n              '',\n            )\n\n            fix.changes.forEach((change) => {\n              change.textChanges.forEach((textChange) => {\n                textChange.newText = textChange.newText.replace(\n                  VIRTUAL_FILENAME_SEPARATOR + MODULE_SELECTOR,\n                  '',\n                )\n              })\n            })\n          }\n\n          fix.changes.forEach((change) => {\n            if (isVirtualFile(change.fileName)) {\n              const document = config.helpers.getVueDocument(change.fileName)\n              const fileNameInfo = parseVirtualFileName(change.fileName)\n              change.fileName = getContainingFile(change.fileName)\n              if (document != null && fileNameInfo != null) {\n                const block = document.getBlock(fileNameInfo.selector as any)\n                if (block != null) {\n                  change.textChanges.forEach((textChange) => {\n                    if (textChange.span.start < block.loc.start.offset) {\n                      // Put at beginning of the block.\n                      textChange.span.start = block.loc.start.offset + 1\n                    }\n                  })\n                }\n              }\n            }\n          })\n\n          return fix\n        })\n    },\n\n    getCombinedCodeFix(scope, fixId, formatOptions, preferences) {\n      return config.service.getCombinedCodeFix(\n        scope,\n        fixId,\n        formatOptions,\n        preferences,\n      )\n    },\n\n    getApplicableRefactors(fileName, positionOrRange, preferences) {\n      return choose(fileName).getApplicableRefactors(\n        fileName,\n        positionOrRange,\n        preferences,\n      )\n    },\n\n    getEditsForRefactor(\n      fileName,\n      formatOptions,\n      positionOrRange,\n      refactorName,\n      actionName,\n      preferences,\n    ) {\n      const result = choose(fileName).getEditsForRefactor(\n        fileName,\n        formatOptions,\n        positionOrRange,\n        refactorName,\n        actionName,\n        preferences,\n      )\n\n      if (result != null) {\n        result.edits = result.edits.filter((edit) => {\n          if (isVirtualFile(edit.fileName)) {\n            const info = parseVirtualFileName(edit.fileName)\n            edit.fileName = getContainingFile(edit.fileName)\n\n            return ['script', 'scriptSetup'].includes(info?.selector.type ?? '')\n          } else {\n            return true\n          }\n        })\n\n        result.edits = mergeFileTextChanges(result.edits)\n      }\n\n      return result\n    },\n\n    organizeImports(scope, formatOptions, preferences) {\n      return choose(scope.fileName)\n        .organizeImports(scope, formatOptions, preferences)\n        .map((change) => {\n          if (isVirtualFile(change.fileName))\n            change.fileName = getContainingFile(change.fileName)\n\n          return change\n        })\n    },\n\n    getEditsForFileRename(\n      oldFilePath: string,\n      newFilePath: string,\n      formatOptions: TS.FormatCodeOptions,\n      preferences: TS.UserPreferences,\n    ): readonly TS.FileTextChanges[] {\n      const suffix = '.vue' + VIRTUAL_FILENAME_SEPARATOR + '_module'\n      const edits = choose(oldFilePath)\n        .getEditsForFileRename(\n          oldFilePath,\n          newFilePath,\n          formatOptions,\n          preferences,\n        )\n        .map((edit) => {\n          if (isVirtualFile(edit.fileName)) {\n            const result = parseVirtualFileName(edit.fileName)\n            if (result == null) return\n            if (!['script', 'scriptSetup'].includes(result.selector.type))\n              return\n\n            edit.fileName = getContainingFile(edit.fileName)\n          }\n\n          edit.textChanges = edit.textChanges\n            .map((change) => {\n              const index = change.newText.indexOf(suffix)\n\n              if (index >= 0) {\n                change.newText =\n                  change.newText.substr(0, index + 4) +\n                  change.newText.substr(index + suffix.length)\n              }\n\n              return change\n            })\n            .filter(isNotNull)\n\n          if (edit.textChanges.length === 0) return\n\n          return edit\n        })\n        .filter(isNotNull)\n\n      return mergeFileTextChanges(edits)\n    },\n\n    toggleLineComment(fileName, textRange) {\n      return choose(fileName).toggleLineComment(fileName, textRange)\n    },\n\n    toggleMultilineComment(fileName, textRange) {\n      return choose(fileName).toggleMultilineComment(fileName, textRange)\n    },\n\n    commentSelection(fileName, textRange) {\n      return choose(fileName).commentSelection(fileName, textRange)\n    },\n\n    uncommentSelection(fileName, textRange) {\n      return choose(fileName).uncommentSelection(fileName, textRange)\n    },\n\n    dispose() {\n      config.context.disposeUnusedProjects(true)\n      ts.dispose()\n    },\n  })\n\n  return proxy\n\n  function createDiagnosticProcessor<T extends TS.Diagnostic>(\n    fileName: string,\n  ): (diagnostic: T) => T {\n    return (item) => {\n      const diagnostic: T = { ...item } // TS service reuses diagnostics so avoid mutating\n\n      if (\n        isVirtualSourceFile(diagnostic.file) &&\n        diagnostic.file.fileName !== fileName\n      ) {\n        diagnostic.file =\n          config.helpers.getSourceFile(fileName, ts) ??\n          Object.assign(\n            Object.create(Object.getPrototypeOf(diagnostic.file)),\n            diagnostic.file,\n            { fileName },\n          )\n      }\n\n      diagnostic.messageText = applyReplacements(\n        fileName,\n        diagnostic.messageText,\n      )\n\n      if (diagnostic.relatedInformation != null) {\n        diagnostic.relatedInformation = diagnostic.relatedInformation\n          .map((info) => {\n            const relatedInformation = { ...info }\n\n            relatedInformation.messageText = applyReplacements(\n              fileName,\n              relatedInformation.messageText,\n            )\n            if (\n              relatedInformation.file != null &&\n              isVirtualFile(relatedInformation.file.fileName)\n            ) {\n              if (\n                isVirtualFileOfType(\n                  relatedInformation.file.fileName,\n                  MODULE_SELECTOR,\n                ) ||\n                isVirtualFileOfType(\n                  relatedInformation.file.fileName,\n                  INTERNAL_MODULE_SELECTOR,\n                )\n              ) {\n                return null\n              }\n\n              relatedInformation.file =\n                config.helpers.getSourceFile(\n                  getContainingFile(relatedInformation.file.fileName),\n                  ts,\n                ) ??\n                Object.assign(\n                  Object.create(Object.getPrototypeOf(diagnostic.file)),\n                  diagnostic.file,\n                  {\n                    fileName: getContainingFile(\n                      relatedInformation.file.fileName,\n                    ),\n                  },\n                )\n            }\n\n            return relatedInformation\n          })\n          .filter(isNotNull)\n      }\n\n      return diagnostic\n    }\n  }\n}\n\nfunction mergeFileTextChanges(\n  edits: TS.FileTextChanges[],\n): TS.FileTextChanges[] {\n  const editsByFileName: Record<string, TS.FileTextChanges> = {}\n\n  edits.forEach((edit) => {\n    if (!(edit.fileName in editsByFileName)) {\n      editsByFileName[edit.fileName] = {\n        fileName: edit.fileName,\n        textChanges: [],\n      }\n    }\n    const currentEdit = editsByFileName[edit.fileName]\n\n    currentEdit.textChanges = combineTextChanges(\n      currentEdit.textChanges,\n      edit.textChanges,\n    )\n    if (edit.isNewFile != null) {\n      const value = currentEdit.isNewFile\n      currentEdit.isNewFile =\n        value == null ? edit.isNewFile : value || edit.isNewFile\n    }\n  })\n\n  return Array.from(Object.values(editsByFileName))\n}\n\nfunction combineTextChanges(\n  changes: readonly TS.TextChange[],\n  newChanges: readonly TS.TextChange[],\n): TS.TextChange[] {\n  const finalChanges = changes.slice()\n  const ids = new Set(changes.map(serializeTextChange))\n\n  newChanges.forEach((change) => {\n    const id = serializeTextChange(change)\n\n    if (!ids.has(id)) {\n      ids.add(id)\n      finalChanges.push(change)\n    }\n  })\n\n  finalChanges.sort((a, b) => a.span.start - b.span.start)\n\n  return finalChanges\n}\n\nfunction serializeTextChange(change: TS.TextChange): string {\n  return JSON.stringify([change.span.start, change.span.length, change.newText])\n}\n","import { collect, Telemetry } from '@vuedx/shared'\nimport { version } from '../package.json'\nimport { PluginContext } from './context'\nimport { traceFn } from './helpers/logger'\nimport { Modules, PluginConfig, TS } from './interfaces'\nimport { RoutingLanguageServer } from './servers/routing'\n\nlet context: PluginContext\nlet server: RoutingLanguageServer\n\nexport type { Modules, PluginConfig } from './interfaces'\nexport type PluginModule = TS.server.PluginModule\n\nexport default function init({ typescript }: Modules): TS.server.PluginModule {\n  context = context ?? new PluginContext(typescript)\n  server = server ?? new RoutingLanguageServer(context)\n\n  Telemetry.setup(\n    'https://a1461052e1d94c7a9ee7c3f7add71b24@o237831.ingest.sentry.io/5595721',\n    'typescript-plugin-vue',\n    version,\n    0.25,\n    { typescriptVersion: typescript.versionMajorMinor },\n  )\n\n  return {\n    create(\n      info: Omit<TS.server.PluginCreateInfo, 'config'> & {\n        config: PluginConfig\n      },\n    ) {\n      if (info.config.telemetry === false) Telemetry.optOut()\n\n      collect('typescript project', {\n        kind: info.project.projectKind,\n        language: info.project.projectName.endsWith('jsconfig.json')\n          ? 'js'\n          : 'ts',\n        config: info.config,\n      })\n\n      if (__DEV__) context.debug`Plugin Config: ${info.config}`\n\n      return traceFn('Plugin.create', () => {\n        context.load(info)\n        return server.decorate(info.languageService)\n      })()\n    },\n    getExternalFiles(project) {\n      return context.getExternalFiles(project) ?? []\n    },\n    onConfigurationChanged(config: PluginConfig) {\n      if (config.telemetry === false) Telemetry.optOut()\n      traceFn('Plugin.onConfigurationChanged', () => {\n        if (__DEV__) context.debug`Plugin Config (changed): ${config}`\n        context.setConfig(config)\n      })()\n    },\n  }\n}\n"],"names":["findParentNode","isPositionInTagName","getComponentName","baseGetComponentName","context"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}