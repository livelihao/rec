import{e as P,d as h}from"./index.d9bc3fe2.js";import{_ as F}from"./index.2caa597a.js";import{l as i,W as R,q as c,t as g,x as e,C as _,X as v,y as l,F as n,G as a,A as m,P as y,Q as f,H as U,N as A,O as E}from"./element-plus.98b962cc.js";const b={props:{id:Number},components:{Page:F},data(){return{item_recommend:[],detail:null,score:1,comment:""}},created(){this.get_movie(),this.get_item_recommend()},methods:{formatDateTime:P,async makeComment(){await h.post(`comment/${this.detail.id}/`,{comment:this.comment}),this.comment="",this.$message.success("\u8BC4\u8BBA\u6210\u529F"),this.get_movie()},async collect(){await h.get(`collect/${this.detail.id}/`),this.$message.success("\u6536\u85CF\u6210\u529F"),this.get_movie()},async decollect(){await h.get(`decollect/${this.detail.id}/`),this.$message.success("\u53D6\u6D88\u6536\u85CF\u6210\u529F"),this.get_movie()},async addScore(){await h.post(`score/${this.detail.id}/`,{score:this.score}),this.$message.success("\u8BC4\u5206\u6210\u529F"),this.get_movie()},async get_item_recommend(){let{data:{Data:o}}=await h.get("item_recommend/");this.item_recommend=o},async get_movie(){let{data:{Data:o}}=await h.get(`movie/${this.id}`);this.detail=o},wrapText(o,u=50){return o.length>u?o.substring(0,u)+"...":o},toRoute(o){this.$router.replace({name:"Index",query:{tag:o}})},toDetail(o){this.$router.push({name:"Detail",params:{id:o}})}}},G=o=>(A("data-v-fe831d7c"),o=o(),E(),o),H={class:"info"},L=n("\u524D\u5F80\u89C2\u770B"),O=n("\u63D0\u4EA4"),Q={key:1},W=n("\u70B9\u51FB\u6536\u85CF"),X=n("\u53D6\u6D88\u6536\u85CF"),j={class:"desc"},J={class:"card-header"},K=G(()=>_("span",null,"\u57FA\u4E8E\u7269\u54C1\u63A8\u8350\u7535\u5F71",-1)),M=n("\u6362\u4E00\u6279"),Y=["onClick"],Z={class:"cover"},$={class:"desc2"},ee={class:"comment-part"},te={style:{display:"flex"}},le=n("\u63D0\u4EA4\u8BC4\u8BBA"),se={class:"wrap"},oe={key:1,style:{"font-weight":"bold",color:"#888,font-size:25px","text-align":"center"}};function ae(o,u,ne,ie,s,d){const r=i("el-descriptions-item"),x=i("el-tag"),C=i("el-link"),w=i("el-option"),D=i("el-select"),p=i("el-button"),V=i("el-descriptions"),z=i("el-card"),N=i("el-input"),q=i("el-avatar"),S=i("el-tab-pane"),I=i("el-tabs"),T=i("Page"),k=R("src");return s.detail?(c(),g(T,{key:0},{default:e(()=>[_("div",H,[v(_("img",null,null,512),[[k,s.detail.image_link]]),l(V,{column:2},{default:e(()=>[l(r,{label:"\u7535\u5F71\u540D:"},{default:e(()=>[n(a(s.detail.name),1)]),_:1}),l(r,{label:"\u4E0A\u6620\u65E5\u671F:"},{default:e(()=>[n(a(s.detail.years),1)]),_:1}),l(r,{label:"\u5BFC\u6F14:"},{default:e(()=>[n(a(s.detail.director),1)]),_:1}),l(r,{label:"\u4E3B\u6F14:"},{default:e(()=>[n(a(d.wrapText(s.detail.leader,20)),1)]),_:1}),l(r,{label:"\u8C46\u74E3\u8BC4\u5206:"},{default:e(()=>[n(a(s.detail.d_rate),1)]),_:1}),l(r,{label:"\u6536\u85CF\u4EBA\u6570:"},{default:e(()=>[n(a(s.detail.collect_count),1)]),_:1}),l(r,{label:"\u6807\u7B7E:"},{default:e(()=>[(c(!0),m(f,null,y(s.detail.all_tags,t=>(c(),g(x,{style:{"margin-right":"5px",cursor:"pointer"},key:t.id,type:"info",effect:"plain",onClick:B=>d.toRoute(t.id)},{default:e(()=>[n(a(t.name),1)]),_:2},1032,["onClick"]))),128))]),_:1}),l(r,null,{default:e(()=>[l(C,{href:`https://v.qq.com/x/search/?q=${s.detail.name}&stag=0&smartbox_ab=`,target:"_blank",type:"success",style:{"font-size":"25px"}},{default:e(()=>[L]),_:1},8,["href"])]),_:1}),l(r,{label:"\u6DFB\u52A0\u8BC4\u5206"},{default:e(()=>[s.detail.user_rate==null?(c(),m(f,{key:0},[l(D,{size:"mini",modelValue:s.score,"onUpdate:modelValue":u[0]||(u[0]=t=>s.score=t)},{default:e(()=>[(c(),m(f,null,y(5,t=>l(w,{label:t,key:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),l(p,{type:"primary",size:"mini",style:{"margin-left":"10px"},onClick:d.addScore},{default:e(()=>[O]),_:1},8,["onClick"])],64)):(c(),m("span",Q,"\u60A8\u5DF2\u8FDB\u884C\u6253\u5206: "+a(s.detail.user_rate.mark),1))]),_:1}),l(r,null,{default:e(()=>[s.detail.is_collect==null?(c(),g(p,{key:0,size:"large",type:"primary",onClick:d.collect},{default:e(()=>[W]),_:1},8,["onClick"])):(c(),g(p,{key:1,size:"large",type:"warning",onClick:d.decollect},{default:e(()=>[X]),_:1},8,["onClick"]))]),_:1})]),_:1})]),_("div",j,a(s.detail.intro),1),l(z,{class:"item-recommand",shadow:"always"},{header:e(()=>[_("div",J,[K,l(p,{class:"button",type:"primary",size:"mini",onClick:d.get_item_recommend},{default:e(()=>[M]),_:1},8,["onClick"])])]),default:e(()=>[(c(!0),m(f,null,y(s.item_recommend,t=>(c(),m("div",{key:t.id,class:"movie-card-simple",onClick:B=>d.toDetail(t.id),style:{cursor:"pointer"}},[v(_("img",Z,null,512),[[k,t.image_link]]),_("div",$,[l(p,{type:"text",style:{"margin-bottom":"10px",display:"block","text-align":"left"}},{default:e(()=>[n(a(t.name),1)]),_:2},1024),_("p",null,a(t.years),1)])],8,Y))),128))]),_:1}),_("div",ee,[_("div",te,[l(N,{placeholder:"\u5FEB\u6765\u8BF4\u70B9\u4EC0\u4E48\u5427~",style:{flex:"1"},modelValue:s.comment,"onUpdate:modelValue":u[1]||(u[1]=t=>s.comment=t)},null,8,["modelValue"]),l(p,{disabled:s.comment.length===0,type:"success",size:"large",style:{"margin-left":"10px"},onClick:d.makeComment},{default:e(()=>[le]),_:1},8,["disabled","onClick"])]),l(I,{type:"card",style:{"margin-top":"10px"}},{default:e(()=>[l(S,{label:"\u8BC4\u8BBA"},{default:e(()=>[s.detail.comments.length!=0?(c(!0),m(f,{key:0},y(s.detail.comments,t=>(c(),m("div",{class:"comment-card",key:t.id},[l(q,{shape:"square",size:50},{default:e(()=>[n(a(t.userName),1)]),_:2},1024),_("div",se,[_("p",null,a(t.content),1),_("p",null,a(t.userName)+" \u53D1\u8868\u4E8E"+a(d.formatDateTime(new Date(t.create_time))),1)])]))),128)):(c(),m("h1",oe,"\u6682\u65E0\u8BC4\u8BBA"))]),_:1})]),_:1})])]),_:1})):U("",!0)}b.render=ae;b.__scopeId="data-v-fe831d7c";export{b as default};
